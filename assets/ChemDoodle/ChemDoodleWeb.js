//
// ChemDoodle Web Components 11.0.0
//
// https://web.chemdoodle.com
//
// Copyright 2009-2025 iChemLabs, LLC.  All rights reserved.
//
// The ChemDoodle Web Components library is licensed under version 3
// of the GNU GENERAL PUBLIC LICENSE.
//
// You may redistribute it and/or modify it under the terms of the
// GNU General Public License as published by the Free Software Foundation,
// either version 3 of the License, or (at your option) any later version.
//
// As an exception to the GPL, you may distribute this packed form of
// the code without the copy of the GPL license normally required,
// provided you include this license notice and a URL through which
// recipients can access the corresponding unpacked source code. 
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// ChemDoodle Web Components employs 3rd party libraries under the MIT
// license. For a full list with links to the original source, go to:
// https://web.chemdoodle.com/installation/download/#libraries
//
// Please contact iChemLabs <https://www.ichemlabs.com/contact-us> for
// alternate licensing options.
//
'use strict';let ChemDoodle=function(){let q={iChemLabs:{},informatics:{},io:{},lib:{},notations:{},structures:{PID:0}};q.structures.d2={};q.structures.d3={};q.getVersion=function(){return"11.0.0"};return q}();
(function(q,B){typeof exports==="object"?module.exports=B(global):typeof define==="function"&&define.amd?define([],function(){return B(q)}):B(q)})(ChemDoodle.lib,function(q){function B(a){return l=a}function w(){return l=typeof Float32Array!=="undefined"?Float32Array:Array}var u={};(function(){if(typeof Float32Array!="undefined"){var a=new Float32Array(1),h=new Int32Array(a.buffer);u.invsqrt=function(p){a[0]=p;h[0]=1597463007-(h[0]>>1);var z=a[0];return z*(1.5-p*.5*z*z)}}else u.invsqrt=function(p){return 1/
Math.sqrt(p)}})();var l=null;w();var n={create:function(a){var h=new l(3);a?(h[0]=a[0],h[1]=a[1],h[2]=a[2]):h[0]=h[1]=h[2]=0;return h},createFrom:function(a,h,p){var z=new l(3);z[0]=a;z[1]=h;z[2]=p;return z},set:function(a,h){h[0]=a[0];h[1]=a[1];h[2]=a[2];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6},add:function(a,h,p){if(!p||a===p)return a[0]+=h[0],a[1]+=h[1],a[2]+=h[2],a;p[0]=a[0]+h[0];p[1]=a[1]+h[1];p[2]=a[2]+h[2];return p},
subtract:function(a,h,p){if(!p||a===p)return a[0]-=h[0],a[1]-=h[1],a[2]-=h[2],a;p[0]=a[0]-h[0];p[1]=a[1]-h[1];p[2]=a[2]-h[2];return p},multiply:function(a,h,p){if(!p||a===p)return a[0]*=h[0],a[1]*=h[1],a[2]*=h[2],a;p[0]=a[0]*h[0];p[1]=a[1]*h[1];p[2]=a[2]*h[2];return p},negate:function(a,h){h||=a;h[0]=-a[0];h[1]=-a[1];h[2]=-a[2];return h},scale:function(a,h,p){if(!p||a===p)return a[0]*=h,a[1]*=h,a[2]*=h,a;p[0]=a[0]*h;p[1]=a[1]*h;p[2]=a[2]*h;return p},normalize:function(a,h){h||=a;var p=a[0],z=a[1];
a=a[2];var A=Math.sqrt(p*p+z*z+a*a);if(!A)return h[0]=0,h[1]=0,h[2]=0,h;if(A===1)return h[0]=p,h[1]=z,h[2]=a,h;A=1/A;h[0]=p*A;h[1]=z*A;h[2]=a*A;return h},cross:function(a,h,p){p||=a;var z=a[0],A=a[1];a=a[2];var C=h[0],D=h[1];h=h[2];p[0]=A*h-a*D;p[1]=a*C-z*h;p[2]=z*D-A*C;return p},length:function(a){var h=a[0],p=a[1];a=a[2];return Math.sqrt(h*h+p*p+a*a)},squaredLength:function(a){var h=a[0],p=a[1];a=a[2];return h*h+p*p+a*a},dot:function(a,h){return a[0]*h[0]+a[1]*h[1]+a[2]*h[2]},direction:function(a,
h,p){p||=a;var z=a[0]-h[0],A=a[1]-h[1];a=a[2]-h[2];h=Math.sqrt(z*z+A*A+a*a);if(!h)return p[0]=0,p[1]=0,p[2]=0,p;h=1/h;p[0]=z*h;p[1]=A*h;p[2]=a*h;return p},lerp:function(a,h,p,z){z||=a;z[0]=a[0]+p*(h[0]-a[0]);z[1]=a[1]+p*(h[1]-a[1]);z[2]=a[2]+p*(h[2]-a[2]);return z},dist:function(a,h){var p=h[0]-a[0],z=h[1]-a[1];a=h[2]-a[2];return Math.sqrt(p*p+z*z+a*a)}},d=null,e=new l(4);n.unproject=function(a,h,p,z,A){A||=a;d||=m.create();var C=d;e[0]=(a[0]-z[0])*2/z[2]-1;e[1]=(a[1]-z[1])*2/z[3]-1;e[2]=2*a[2]-1;
e[3]=1;m.multiply(p,h,C);if(!m.inverse(C))return null;m.multiplyVec4(C,e);if(e[3]===0)return null;A[0]=e[0]/e[3];A[1]=e[1]/e[3];A[2]=e[2]/e[3];return A};var c=n.createFrom(1,0,0),b=n.createFrom(0,1,0),f=n.createFrom(0,0,1),g=n.create();n.rotationTo=function(a,h,p){p||=r.create();var z=n.dot(a,h);if(z>=1)r.set(t,p);else if(z<-.999999)n.cross(c,a,g),n.length(g)<1E-6&&n.cross(b,a,g),n.length(g)<1E-6&&n.cross(f,a,g),n.normalize(g),r.fromAngleAxis(Math.PI,g,p);else{z=Math.sqrt((1+z)*2);var A=1/z;n.cross(a,
h,g);p[0]=g[0]*A;p[1]=g[1]*A;p[2]=g[2]*A;p[3]=z*.5;r.normalize(p)}p[3]>1?p[3]=1:p[3]<-1&&(p[3]=-1);return p};n.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};var k={create:function(a){var h=new l(9);a?(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[8]=a[8]):h[0]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=0;return h},createFrom:function(a,h,p,z,A,C,D,E,F){var G=new l(9);G[0]=a;G[1]=h;G[2]=p;G[3]=z;G[4]=A;G[5]=C;G[6]=D;G[7]=E;G[8]=F;return G},determinant:function(a){var h=
a[3],p=a[4],z=a[5],A=a[6],C=a[7],D=a[8];return a[0]*(D*p-z*C)+a[1]*(-D*h+z*A)+a[2]*(C*h-p*A)},inverse:function(a,h){var p=a[0],z=a[1],A=a[2],C=a[3],D=a[4],E=a[5],F=a[6],G=a[7];a=a[8];var I=a*D-E*G,J=-a*C+E*F,M=G*C-D*F,H=p*I+z*J+A*M;if(!H)return null;H=1/H;h||=k.create();h[0]=I*H;h[1]=(-a*z+A*G)*H;h[2]=(E*z-A*D)*H;h[3]=J*H;h[4]=(a*p-A*F)*H;h[5]=(-E*p+A*C)*H;h[6]=M*H;h[7]=(-G*p+z*F)*H;h[8]=(D*p-z*C)*H;return h},multiply:function(a,h,p){p||=a;var z=a[0],A=a[1],C=a[2],D=a[3],E=a[4],F=a[5],G=a[6],I=a[7];
a=a[8];var J=h[0],M=h[1],H=h[2],R=h[3],K=h[4],L=h[5],N=h[6],Q=h[7];h=h[8];p[0]=J*z+M*D+H*G;p[1]=J*A+M*E+H*I;p[2]=J*C+M*F+H*a;p[3]=R*z+K*D+L*G;p[4]=R*A+K*E+L*I;p[5]=R*C+K*F+L*a;p[6]=N*z+Q*D+h*G;p[7]=N*A+Q*E+h*I;p[8]=N*C+Q*F+h*a;return p},multiplyVec2:function(a,h,p){p||=h;var z=h[0];h=h[1];p[0]=z*a[0]+h*a[3]+a[6];p[1]=z*a[1]+h*a[4]+a[7];return p},multiplyVec3:function(a,h,p){p||=h;var z=h[0],A=h[1];h=h[2];p[0]=z*a[0]+A*a[3]+h*a[6];p[1]=z*a[1]+A*a[4]+h*a[7];p[2]=z*a[2]+A*a[5]+h*a[8];return p},set:function(a,
h){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];h[4]=a[4];h[5]=a[5];h[6]=a[6];h[7]=a[7];h[8]=a[8];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6&&Math.abs(a[3]-h[3])<1E-6&&Math.abs(a[4]-h[4])<1E-6&&Math.abs(a[5]-h[5])<1E-6&&Math.abs(a[6]-h[6])<1E-6&&Math.abs(a[7]-h[7])<1E-6&&Math.abs(a[8]-h[8])<1E-6},identity:function(a){a||=k.create();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,
h){if(!h||a===h){h=a[1];var p=a[2],z=a[5];a[1]=a[3];a[2]=a[6];a[3]=h;a[5]=a[7];a[6]=p;a[7]=z;return a}h[0]=a[0];h[1]=a[3];h[2]=a[6];h[3]=a[1];h[4]=a[4];h[5]=a[7];h[6]=a[2];h[7]=a[5];h[8]=a[8];return h},toMat4:function(a,h){h||=m.create();h[15]=1;h[14]=0;h[13]=0;h[12]=0;h[11]=0;h[10]=a[8];h[9]=a[7];h[8]=a[6];h[7]=0;h[6]=a[5];h[5]=a[4];h[4]=a[3];h[3]=0;h[2]=a[2];h[1]=a[1];h[0]=a[0];return h},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+
"]"}},m={create:function(a){var h=new l(16);a&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]);return h},createFrom:function(a,h,p,z,A,C,D,E,F,G,I,J,M,H,R,K){var L=new l(16);L[0]=a;L[1]=h;L[2]=p;L[3]=z;L[4]=A;L[5]=C;L[6]=D;L[7]=E;L[8]=F;L[9]=G;L[10]=I;L[11]=J;L[12]=M;L[13]=H;L[14]=R;L[15]=K;return L},set:function(a,h){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];h[4]=a[4];h[5]=
a[5];h[6]=a[6];h[7]=a[7];h[8]=a[8];h[9]=a[9];h[10]=a[10];h[11]=a[11];h[12]=a[12];h[13]=a[13];h[14]=a[14];h[15]=a[15];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6&&Math.abs(a[3]-h[3])<1E-6&&Math.abs(a[4]-h[4])<1E-6&&Math.abs(a[5]-h[5])<1E-6&&Math.abs(a[6]-h[6])<1E-6&&Math.abs(a[7]-h[7])<1E-6&&Math.abs(a[8]-h[8])<1E-6&&Math.abs(a[9]-h[9])<1E-6&&Math.abs(a[10]-h[10])<1E-6&&Math.abs(a[11]-h[11])<1E-6&&Math.abs(a[12]-h[12])<1E-6&&
Math.abs(a[13]-h[13])<1E-6&&Math.abs(a[14]-h[14])<1E-6&&Math.abs(a[15]-h[15])<1E-6},identity:function(a){a||=m.create();a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,h){if(!h||a===h){h=a[1];var p=a[2],z=a[3],A=a[6],C=a[7],D=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=h;a[6]=a[9];a[7]=a[13];a[8]=p;a[9]=A;a[11]=a[14];a[12]=z;a[13]=C;a[14]=D;return a}h[0]=a[0];h[1]=a[4];h[2]=a[8];h[3]=a[12];h[4]=a[1];
h[5]=a[5];h[6]=a[9];h[7]=a[13];h[8]=a[2];h[9]=a[6];h[10]=a[10];h[11]=a[14];h[12]=a[3];h[13]=a[7];h[14]=a[11];h[15]=a[15];return h},determinant:function(a){var h=a[0],p=a[1],z=a[2],A=a[3],C=a[4],D=a[5],E=a[6],F=a[7],G=a[8],I=a[9],J=a[10],M=a[11],H=a[12],R=a[13],K=a[14];a=a[15];return H*I*E*A-G*R*E*A-H*D*J*A+C*R*J*A+G*D*K*A-C*I*K*A-H*I*z*F+G*R*z*F+H*p*J*F-h*R*J*F-G*p*K*F+h*I*K*F+H*D*z*M-C*R*z*M-H*p*E*M+h*R*E*M+C*p*K*M-h*D*K*M-G*D*z*a+C*I*z*a+G*p*E*a-h*I*E*a-C*p*J*a+h*D*J*a},inverse:function(a,h){h||=
a;var p=a[0],z=a[1],A=a[2],C=a[3],D=a[4],E=a[5],F=a[6],G=a[7],I=a[8],J=a[9],M=a[10],H=a[11],R=a[12],K=a[13],L=a[14];a=a[15];var N=p*E-z*D,Q=p*F-A*D,O=p*G-C*D,S=z*F-A*E,T=z*G-C*E,V=A*G-C*F,P=I*K-J*R,U=I*L-M*R,W=I*a-H*R,X=J*L-M*K,aa=J*a-H*K,Z=M*a-H*L,Y=N*Z-Q*aa+O*X+S*W-T*U+V*P;if(!Y)return null;Y=1/Y;h[0]=(E*Z-F*aa+G*X)*Y;h[1]=(-z*Z+A*aa-C*X)*Y;h[2]=(K*V-L*T+a*S)*Y;h[3]=(-J*V+M*T-H*S)*Y;h[4]=(-D*Z+F*W-G*U)*Y;h[5]=(p*Z-A*W+C*U)*Y;h[6]=(-R*V+L*O-a*Q)*Y;h[7]=(I*V-M*O+H*Q)*Y;h[8]=(D*aa-E*W+G*P)*Y;h[9]=
(-p*aa+z*W-C*P)*Y;h[10]=(R*T-K*O+a*N)*Y;h[11]=(-I*T+J*O-H*N)*Y;h[12]=(-D*X+E*U-F*P)*Y;h[13]=(p*X-z*U+A*P)*Y;h[14]=(-R*S+K*Q-L*N)*Y;h[15]=(I*S-J*Q+M*N)*Y;return h},toRotationMat:function(a,h){h||=m.create();h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];h[4]=a[4];h[5]=a[5];h[6]=a[6];h[7]=a[7];h[8]=a[8];h[9]=a[9];h[10]=a[10];h[11]=a[11];h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h},toMat3:function(a,h){h||=k.create();h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[4];h[4]=a[5];h[5]=a[6];h[6]=a[8];h[7]=a[9];h[8]=a[10];return h},
toInverseMat3:function(a,h){var p=a[0],z=a[1],A=a[2],C=a[4],D=a[5],E=a[6],F=a[8],G=a[9];a=a[10];var I=a*D-E*G,J=-a*C+E*F,M=G*C-D*F,H=p*I+z*J+A*M;if(!H)return null;H=1/H;h||=k.create();h[0]=I*H;h[1]=(-a*z+A*G)*H;h[2]=(E*z-A*D)*H;h[3]=J*H;h[4]=(a*p-A*F)*H;h[5]=(-E*p+A*C)*H;h[6]=M*H;h[7]=(-G*p+z*F)*H;h[8]=(D*p-z*C)*H;return h},multiply:function(a,h,p){p||=a;var z=a[0],A=a[1],C=a[2],D=a[3],E=a[4],F=a[5],G=a[6],I=a[7],J=a[8],M=a[9],H=a[10],R=a[11],K=a[12],L=a[13],N=a[14];a=a[15];var Q=h[0],O=h[1],S=h[2],
T=h[3];p[0]=Q*z+O*E+S*J+T*K;p[1]=Q*A+O*F+S*M+T*L;p[2]=Q*C+O*G+S*H+T*N;p[3]=Q*D+O*I+S*R+T*a;Q=h[4];O=h[5];S=h[6];T=h[7];p[4]=Q*z+O*E+S*J+T*K;p[5]=Q*A+O*F+S*M+T*L;p[6]=Q*C+O*G+S*H+T*N;p[7]=Q*D+O*I+S*R+T*a;Q=h[8];O=h[9];S=h[10];T=h[11];p[8]=Q*z+O*E+S*J+T*K;p[9]=Q*A+O*F+S*M+T*L;p[10]=Q*C+O*G+S*H+T*N;p[11]=Q*D+O*I+S*R+T*a;Q=h[12];O=h[13];S=h[14];T=h[15];p[12]=Q*z+O*E+S*J+T*K;p[13]=Q*A+O*F+S*M+T*L;p[14]=Q*C+O*G+S*H+T*N;p[15]=Q*D+O*I+S*R+T*a;return p},multiplyVec3:function(a,h,p){p||=h;var z=h[0],A=h[1];
h=h[2];p[0]=a[0]*z+a[4]*A+a[8]*h+a[12];p[1]=a[1]*z+a[5]*A+a[9]*h+a[13];p[2]=a[2]*z+a[6]*A+a[10]*h+a[14];return p},multiplyVec4:function(a,h,p){p||=h;var z=h[0],A=h[1],C=h[2];h=h[3];p[0]=a[0]*z+a[4]*A+a[8]*C+a[12]*h;p[1]=a[1]*z+a[5]*A+a[9]*C+a[13]*h;p[2]=a[2]*z+a[6]*A+a[10]*C+a[14]*h;p[3]=a[3]*z+a[7]*A+a[11]*C+a[15]*h;return p},translate:function(a,h,p){var z=h[0],A=h[1];h=h[2];if(!p||a===p)return a[12]=a[0]*z+a[4]*A+a[8]*h+a[12],a[13]=a[1]*z+a[5]*A+a[9]*h+a[13],a[14]=a[2]*z+a[6]*A+a[10]*h+a[14],a[15]=
a[3]*z+a[7]*A+a[11]*h+a[15],a;var C=a[0];var D=a[1];var E=a[2];var F=a[3];var G=a[4];var I=a[5];var J=a[6];var M=a[7];var H=a[8];var R=a[9];var K=a[10];var L=a[11];p[0]=C;p[1]=D;p[2]=E;p[3]=F;p[4]=G;p[5]=I;p[6]=J;p[7]=M;p[8]=H;p[9]=R;p[10]=K;p[11]=L;p[12]=C*z+G*A+H*h+a[12];p[13]=D*z+I*A+R*h+a[13];p[14]=E*z+J*A+K*h+a[14];p[15]=F*z+M*A+L*h+a[15];return p},scale:function(a,h,p){var z=h[0],A=h[1];h=h[2];if(!p||a===p)return a[0]*=z,a[1]*=z,a[2]*=z,a[3]*=z,a[4]*=A,a[5]*=A,a[6]*=A,a[7]*=A,a[8]*=h,a[9]*=
h,a[10]*=h,a[11]*=h,a;p[0]=a[0]*z;p[1]=a[1]*z;p[2]=a[2]*z;p[3]=a[3]*z;p[4]=a[4]*A;p[5]=a[5]*A;p[6]=a[6]*A;p[7]=a[7]*A;p[8]=a[8]*h;p[9]=a[9]*h;p[10]=a[10]*h;p[11]=a[11]*h;p[12]=a[12];p[13]=a[13];p[14]=a[14];p[15]=a[15];return p},rotate:function(a,h,p,z){var A=p[0],C=p[1];p=p[2];var D=Math.sqrt(A*A+C*C+p*p);if(!D)return null;D!==1&&(D=1/D,A*=D,C*=D,p*=D);var E=Math.sin(h);var F=Math.cos(h);var G=1-F;h=a[0];D=a[1];var I=a[2];var J=a[3];var M=a[4];var H=a[5];var R=a[6];var K=a[7];var L=a[8];var N=a[9];
var Q=a[10];var O=a[11];var S=A*A*G+F;var T=C*A*G+p*E;var V=p*A*G-C*E;var P=A*C*G-p*E;var U=C*C*G+F;var W=p*C*G+A*E;var X=A*p*G+C*E;A=C*p*G-A*E;C=p*p*G+F;z?a!==z&&(z[12]=a[12],z[13]=a[13],z[14]=a[14],z[15]=a[15]):z=a;z[0]=h*S+M*T+L*V;z[1]=D*S+H*T+N*V;z[2]=I*S+R*T+Q*V;z[3]=J*S+K*T+O*V;z[4]=h*P+M*U+L*W;z[5]=D*P+H*U+N*W;z[6]=I*P+R*U+Q*W;z[7]=J*P+K*U+O*W;z[8]=h*X+M*A+L*C;z[9]=D*X+H*A+N*C;z[10]=I*X+R*A+Q*C;z[11]=J*X+K*A+O*C;return z},rotateX:function(a,h,p){var z=Math.sin(h);h=Math.cos(h);var A=a[4],C=
a[5],D=a[6],E=a[7],F=a[8],G=a[9],I=a[10],J=a[11];p?a!==p&&(p[0]=a[0],p[1]=a[1],p[2]=a[2],p[3]=a[3],p[12]=a[12],p[13]=a[13],p[14]=a[14],p[15]=a[15]):p=a;p[4]=A*h+F*z;p[5]=C*h+G*z;p[6]=D*h+I*z;p[7]=E*h+J*z;p[8]=A*-z+F*h;p[9]=C*-z+G*h;p[10]=D*-z+I*h;p[11]=E*-z+J*h;return p},rotateY:function(a,h,p){var z=Math.sin(h);h=Math.cos(h);var A=a[0],C=a[1],D=a[2],E=a[3],F=a[8],G=a[9],I=a[10],J=a[11];p?a!==p&&(p[4]=a[4],p[5]=a[5],p[6]=a[6],p[7]=a[7],p[12]=a[12],p[13]=a[13],p[14]=a[14],p[15]=a[15]):p=a;p[0]=A*h+
F*-z;p[1]=C*h+G*-z;p[2]=D*h+I*-z;p[3]=E*h+J*-z;p[8]=A*z+F*h;p[9]=C*z+G*h;p[10]=D*z+I*h;p[11]=E*z+J*h;return p},rotateZ:function(a,h,p){var z=Math.sin(h);h=Math.cos(h);var A=a[0],C=a[1],D=a[2],E=a[3],F=a[4],G=a[5],I=a[6],J=a[7];p?a!==p&&(p[8]=a[8],p[9]=a[9],p[10]=a[10],p[11]=a[11],p[12]=a[12],p[13]=a[13],p[14]=a[14],p[15]=a[15]):p=a;p[0]=A*h+F*z;p[1]=C*h+G*z;p[2]=D*h+I*z;p[3]=E*h+J*z;p[4]=A*-z+F*h;p[5]=C*-z+G*h;p[6]=D*-z+I*h;p[7]=E*-z+J*h;return p},frustum:function(a,h,p,z,A,C,D){D||=m.create();var E=
h-a,F=z-p,G=C-A;D[0]=A*2/E;D[1]=0;D[2]=0;D[3]=0;D[4]=0;D[5]=A*2/F;D[6]=0;D[7]=0;D[8]=(h+a)/E;D[9]=(z+p)/F;D[10]=-(C+A)/G;D[11]=-1;D[12]=0;D[13]=0;D[14]=-(C*A*2)/G;D[15]=0;return D},perspective:function(a,h,p,z,A){a=p*Math.tan(a*Math.PI/360);h*=a;return m.frustum(-h,h,-a,a,p,z,A)},ortho:function(a,h,p,z,A,C,D){D||=m.create();var E=h-a,F=z-p,G=C-A;D[0]=2/E;D[1]=0;D[2]=0;D[3]=0;D[4]=0;D[5]=2/F;D[6]=0;D[7]=0;D[8]=0;D[9]=0;D[10]=-2/G;D[11]=0;D[12]=-(a+h)/E;D[13]=-(z+p)/F;D[14]=-(C+A)/G;D[15]=1;return D},
lookAt:function(a,h,p,z){z||=m.create();var A=a[0],C=a[1];a=a[2];var D=p[0];var E=p[1];var F=p[2];var G=h[0];p=h[1];var I=h[2];if(A===G&&C===p&&a===I)return m.identity(z);h=A-G;p=C-p;G=a-I;var J=1/Math.sqrt(h*h+p*p+G*G);h*=J;p*=J;G*=J;I=E*G-F*p;F=F*h-D*G;D=D*p-E*h;(J=Math.sqrt(I*I+F*F+D*D))?(J=1/J,I*=J,F*=J,D*=J):D=F=I=0;E=p*D-G*F;var M=G*I-h*D;var H=h*F-p*I;(J=Math.sqrt(E*E+M*M+H*H))?(J=1/J,E*=J,M*=J,H*=J):H=M=E=0;z[0]=I;z[1]=E;z[2]=h;z[3]=0;z[4]=F;z[5]=M;z[6]=p;z[7]=0;z[8]=D;z[9]=H;z[10]=G;z[11]=
0;z[12]=-(I*A+F*C+D*a);z[13]=-(E*A+M*C+H*a);z[14]=-(h*A+p*C+G*a);z[15]=1;return z},fromRotationTranslation:function(a,h,p){p||=m.create();var z=a[0],A=a[1],C=a[2],D=a[3],E=z+z,F=A+A,G=C+C;a=z*E;var I=z*F;z*=G;var J=A*F;A*=G;C*=G;E*=D;F*=D;D*=G;p[0]=1-(J+C);p[1]=I+D;p[2]=z-F;p[3]=0;p[4]=I-D;p[5]=1-(a+C);p[6]=A+E;p[7]=0;p[8]=z+F;p[9]=A-E;p[10]=1-(a+J);p[11]=0;p[12]=h[0];p[13]=h[1];p[14]=h[2];p[15]=1;return p},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+
", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}},r={create:function(a){var h=new l(4);a?(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3]):h[0]=h[1]=h[2]=h[3]=0;return h},createFrom:function(a,h,p,z){var A=new l(4);A[0]=a;A[1]=h;A[2]=p;A[3]=z;return A},set:function(a,h){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6&&Math.abs(a[3]-h[3])<1E-6},
identity:function(a){a||=r.create();a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a}},t=r.identity();r.calculateW=function(a,h){var p=a[0],z=a[1],A=a[2];if(!h||a===h)return a[3]=-Math.sqrt(Math.abs(1-p*p-z*z-A*A)),a;h[0]=p;h[1]=z;h[2]=A;h[3]=-Math.sqrt(Math.abs(1-p*p-z*z-A*A));return h};r.dot=function(a,h){return a[0]*h[0]+a[1]*h[1]+a[2]*h[2]+a[3]*h[3]};r.inverse=function(a,h){var p=a[0],z=a[1],A=a[2],C=a[3];p=(p=p*p+z*z+A*A+C*C)?1/p:0;if(!h||a===h)return a[0]*=-p,a[1]*=-p,a[2]*=-p,a[3]*=p,a;h[0]=-a[0]*p;h[1]=
-a[1]*p;h[2]=-a[2]*p;h[3]=a[3]*p;return h};r.conjugate=function(a,h){if(!h||a===h)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;h[0]=-a[0];h[1]=-a[1];h[2]=-a[2];h[3]=a[3];return h};r.length=function(a){var h=a[0],p=a[1],z=a[2];a=a[3];return Math.sqrt(h*h+p*p+z*z+a*a)};r.normalize=function(a,h){h||=a;var p=a[0],z=a[1],A=a[2];a=a[3];var C=Math.sqrt(p*p+z*z+A*A+a*a);if(C===0)return h[0]=0,h[1]=0,h[2]=0,h[3]=0,h;C=1/C;h[0]=p*C;h[1]=z*C;h[2]=A*C;h[3]=a*C;return h};r.add=function(a,h,p){if(!p||a===p)return a[0]+=
h[0],a[1]+=h[1],a[2]+=h[2],a[3]+=h[3],a;p[0]=a[0]+h[0];p[1]=a[1]+h[1];p[2]=a[2]+h[2];p[3]=a[3]+h[3];return p};r.multiply=function(a,h,p){p||=a;var z=a[0],A=a[1],C=a[2];a=a[3];var D=h[0],E=h[1],F=h[2];h=h[3];p[0]=z*h+a*D+A*F-C*E;p[1]=A*h+a*E+C*D-z*F;p[2]=C*h+a*F+z*E-A*D;p[3]=a*h-z*D-A*E-C*F;return p};r.multiplyVec3=function(a,h,p){p||=h;var z=h[0],A=h[1],C=h[2];h=a[0];var D=a[1],E=a[2];a=a[3];var F=a*z+D*C-E*A,G=a*A+E*z-h*C,I=a*C+h*A-D*z;z=-h*z-D*A-E*C;p[0]=F*a+z*-h+G*-E-I*-D;p[1]=G*a+z*-D+I*-h-F*
-E;p[2]=I*a+z*-E+F*-D-G*-h;return p};r.scale=function(a,h,p){if(!p||a===p)return a[0]*=h,a[1]*=h,a[2]*=h,a[3]*=h,a;p[0]=a[0]*h;p[1]=a[1]*h;p[2]=a[2]*h;p[3]=a[3]*h;return p};r.toMat3=function(a,h){h||=k.create();var p=a[0],z=a[1],A=a[2],C=a[3],D=p+p,E=z+z,F=A+A;a=p*D;var G=p*E;p*=F;var I=z*E;z*=F;A*=F;D*=C;E*=C;C*=F;h[0]=1-(I+A);h[1]=G+C;h[2]=p-E;h[3]=G-C;h[4]=1-(a+A);h[5]=z+D;h[6]=p+E;h[7]=z-D;h[8]=1-(a+I);return h};r.toMat4=function(a,h){h||=m.create();var p=a[0],z=a[1],A=a[2],C=a[3],D=p+p,E=z+z,
F=A+A;a=p*D;var G=p*E;p*=F;var I=z*E;z*=F;A*=F;D*=C;E*=C;C*=F;h[0]=1-(I+A);h[1]=G+C;h[2]=p-E;h[3]=0;h[4]=G-C;h[5]=1-(a+A);h[6]=z+D;h[7]=0;h[8]=p+E;h[9]=z-D;h[10]=1-(a+I);h[11]=0;h[12]=0;h[13]=0;h[14]=0;h[15]=1;return h};r.slerp=function(a,h,p,z){z||=a;var A=a[0]*h[0]+a[1]*h[1]+a[2]*h[2]+a[3]*h[3];if(Math.abs(A)>=1)return z!==a&&(z[0]=a[0],z[1]=a[1],z[2]=a[2],z[3]=a[3]),z;var C=Math.acos(A);var D=Math.sqrt(1-A*A);if(Math.abs(D)<.001)return z[0]=a[0]*.5+h[0]*.5,z[1]=a[1]*.5+h[1]*.5,z[2]=a[2]*.5+h[2]*
.5,z[3]=a[3]*.5+h[3]*.5,z;A=Math.sin((1-p)*C)/D;p=Math.sin(p*C)/D;z[0]=a[0]*A+h[0]*p;z[1]=a[1]*A+h[1]*p;z[2]=a[2]*A+h[2]*p;z[3]=a[3]*A+h[3]*p;return z};r.fromRotationMatrix=function(a,h){h||=r.create();var p=a[0]+a[4]+a[8];if(p>0){var z=Math.sqrt(p+1);h[3]=.5*z;z=.5/z;h[0]=(a[7]-a[5])*z;h[1]=(a[2]-a[6])*z;h[2]=(a[3]-a[1])*z}else{z=r.fromRotationMatrix.s_iNext=r.fromRotationMatrix.s_iNext||[1,2,0];p=0;a[4]>a[0]&&(p=1);a[8]>a[p*3+p]&&(p=2);var A=z[p],C=z[A];z=Math.sqrt(a[p*3+p]-a[A*3+A]-a[C*3+C]+1);
h[p]=.5*z;z=.5/z;h[3]=(a[C*3+A]-a[A*3+C])*z;h[A]=(a[A*3+p]+a[p*3+A])*z;h[C]=(a[C*3+p]+a[p*3+C])*z}return h};k.toQuat4=r.fromRotationMatrix;(function(){var a=k.create();r.fromAxes=function(h,p,z,A){a[0]=p[0];a[3]=p[1];a[6]=p[2];a[1]=z[0];a[4]=z[1];a[7]=z[2];a[2]=h[0];a[5]=h[1];a[8]=h[2];return r.fromRotationMatrix(a,A)}})();r.identity=function(a){a||=r.create();a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};r.fromAngleAxis=function(a,h,p){p||=r.create();a*=.5;var z=Math.sin(a);p[3]=Math.cos(a);p[0]=z*h[0];
p[1]=z*h[1];p[2]=z*h[2];return p};r.toAngleAxis=function(a,h){h||=a;var p=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];p>0?(h[3]=2*Math.acos(a[3]),p=u.invsqrt(p),h[0]=a[0]*p,h[1]=a[1]*p,h[2]=a[2]*p):(h[3]=0,h[0]=1,h[1]=0,h[2]=0);return h};r.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};var v={create:function(a){var h=new l(2);a?(h[0]=a[0],h[1]=a[1]):(h[0]=0,h[1]=0);return h},createFrom:function(a,h){var p=new l(2);p[0]=a;p[1]=h;return p},add:function(a,h,p){p||=h;p[0]=a[0]+h[0];p[1]=a[1]+h[1];
return p},subtract:function(a,h,p){p||=h;p[0]=a[0]-h[0];p[1]=a[1]-h[1];return p},multiply:function(a,h,p){p||=h;p[0]=a[0]*h[0];p[1]=a[1]*h[1];return p},divide:function(a,h,p){p||=h;p[0]=a[0]/h[0];p[1]=a[1]/h[1];return p},scale:function(a,h,p){p||=a;p[0]=a[0]*h;p[1]=a[1]*h;return p},dist:function(a,h){var p=h[0]-a[0];a=h[1]-a[1];return Math.sqrt(p*p+a*a)},set:function(a,h){h[0]=a[0];h[1]=a[1];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6},negate:function(a,
h){h||=a;h[0]=-a[0];h[1]=-a[1];return h},normalize:function(a,h){h||=a;var p=a[0]*a[0]+a[1]*a[1];p>0?(p=Math.sqrt(p),h[0]=a[0]/p,h[1]=a[1]/p):h[0]=h[1]=0;return h},cross:function(a,h,p){a=a[0]*h[1]-a[1]*h[0];if(!p)return a;p[0]=p[1]=0;p[2]=a;return p},length:function(a){var h=a[0];a=a[1];return Math.sqrt(h*h+a*a)},squaredLength:function(a){var h=a[0];a=a[1];return h*h+a*a},dot:function(a,h){return a[0]*h[0]+a[1]*h[1]},direction:function(a,h,p){p||=a;var z=a[0]-h[0];a=a[1]-h[1];h=z*z+a*a;if(!h)return p[0]=
0,p[1]=0,p[2]=0,p;h=1/Math.sqrt(h);p[0]=z*h;p[1]=a*h;return p},lerp:function(a,h,p,z){z||=a;z[0]=a[0]+p*(h[0]-a[0]);z[1]=a[1]+p*(h[1]-a[1]);return z},str:function(a){return"["+a[0]+", "+a[1]+"]"}},x={create:function(a){var h=new l(4);a?(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3]):h[0]=h[1]=h[2]=h[3]=0;return h},createFrom:function(a,h,p,z){var A=new l(4);A[0]=a;A[1]=h;A[2]=p;A[3]=z;return A},set:function(a,h){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];return h},equal:function(a,h){return a===h||Math.abs(a[0]-
h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6&&Math.abs(a[3]-h[3])<1E-6},identity:function(a){a||=x.create();a[0]=1;a[1]=0;a[2]=0;a[3]=1;return a},transpose:function(a,h){if(!h||a===h)return h=a[1],a[1]=a[2],a[2]=h,a;h[0]=a[0];h[1]=a[2];h[2]=a[1];h[3]=a[3];return h},determinant:function(a){return a[0]*a[3]-a[2]*a[1]},inverse:function(a,h){h||=a;var p=a[0],z=a[1],A=a[2];a=a[3];var C=p*a-A*z;if(!C)return null;C=1/C;h[0]=a*C;h[1]=-z*C;h[2]=-A*C;h[3]=p*C;return h},multiply:function(a,
h,p){p||=a;var z=a[0],A=a[1],C=a[2];a=a[3];p[0]=z*h[0]+A*h[2];p[1]=z*h[1]+A*h[3];p[2]=C*h[0]+a*h[2];p[3]=C*h[1]+a*h[3];return p},rotate:function(a,h,p){p||=a;var z=a[0],A=a[1],C=a[2];a=a[3];var D=Math.sin(h);h=Math.cos(h);p[0]=z*h+A*D;p[1]=z*-D+A*h;p[2]=C*h+a*D;p[3]=C*-D+a*h;return p},multiplyVec2:function(a,h,p){p||=h;var z=h[0];h=h[1];p[0]=z*a[0]+h*a[1];p[1]=z*a[2]+h*a[3];return p},scale:function(a,h,p){p||=a;var z=a[1],A=a[2],C=a[3],D=h[0];h=h[1];p[0]=a[0]*D;p[1]=z*h;p[2]=A*D;p[3]=C*h;return p},
str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}},y={create:function(a){var h=new l(4);a?(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3]):(h[0]=0,h[1]=0,h[2]=0,h[3]=0);return h},createFrom:function(a,h,p,z){var A=new l(4);A[0]=a;A[1]=h;A[2]=p;A[3]=z;return A},add:function(a,h,p){p||=h;p[0]=a[0]+h[0];p[1]=a[1]+h[1];p[2]=a[2]+h[2];p[3]=a[3]+h[3];return p},subtract:function(a,h,p){p||=h;p[0]=a[0]-h[0];p[1]=a[1]-h[1];p[2]=a[2]-h[2];p[3]=a[3]-h[3];return p},multiply:function(a,h,p){p||=h;p[0]=
a[0]*h[0];p[1]=a[1]*h[1];p[2]=a[2]*h[2];p[3]=a[3]*h[3];return p},divide:function(a,h,p){p||=h;p[0]=a[0]/h[0];p[1]=a[1]/h[1];p[2]=a[2]/h[2];p[3]=a[3]/h[3];return p},scale:function(a,h,p){p||=a;p[0]=a[0]*h;p[1]=a[1]*h;p[2]=a[2]*h;p[3]=a[3]*h;return p},set:function(a,h){h[0]=a[0];h[1]=a[1];h[2]=a[2];h[3]=a[3];return h},equal:function(a,h){return a===h||Math.abs(a[0]-h[0])<1E-6&&Math.abs(a[1]-h[1])<1E-6&&Math.abs(a[2]-h[2])<1E-6&&Math.abs(a[3]-h[3])<1E-6},negate:function(a,h){h||=a;h[0]=-a[0];h[1]=-a[1];
h[2]=-a[2];h[3]=-a[3];return h},length:function(a){var h=a[0],p=a[1],z=a[2];a=a[3];return Math.sqrt(h*h+p*p+z*z+a*a)},squaredLength:function(a){var h=a[0],p=a[1],z=a[2];a=a[3];return h*h+p*p+z*z+a*a},lerp:function(a,h,p,z){z||=a;z[0]=a[0]+p*(h[0]-a[0]);z[1]=a[1]+p*(h[1]-a[1]);z[2]=a[2]+p*(h[2]-a[2]);z[3]=a[3]+p*(h[3]-a[3]);return z},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};q&&(q.glMatrixArrayType=l,q.MatrixArray=l,q.setMatrixArrayType=B,q.determineMatrixArrayType=w,q.glMath=
u,q.vec2=v,q.vec3=n,q.vec4=y,q.mat2=x,q.mat3=k,q.mat4=m,q.quat4=r);return{glMatrixArrayType:l,MatrixArray:l,setMatrixArrayType:B,determineMatrixArrayType:w,glMath:u,vec2:v,vec3:n,vec4:y,mat2:x,mat3:k,mat4:m,quat4:r}});
(function(q){function B(k){return k==0?0:k>0?1:-1}var w={subtract:function(k,m){return{x:k.x-m.x,y:k.y-m.y}},dotProduct:function(k,m){return k.x*m.x+k.y*m.y},square:function(k){return Math.sqrt(k.x*k.x+k.y*k.y)},scale:function(k,m){return{x:k.x*m,y:k.y*m}}},u=function(k,m){for(var r=[],t=m.length-1,v=2*t-1,x=[],y=[],a=[],h=[],p=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],z=0;z<=t;z++)x[z]=w.subtract(m[z],k);for(z=0;z<=t-1;z++)y[z]=w.subtract(m[z+1],m[z]),y[z]=w.scale(y[z],3);for(z=0;z<=t-1;z++)for(var A=
0;A<=t;A++)a[z]||(a[z]=[]),a[z][A]=w.dotProduct(y[z],x[A]);for(z=0;z<=v;z++)h[z]||(h[z]=[]),h[z].y=0,h[z].x=parseFloat(z)/v;v=t-1;for(x=0;x<=t+v;x++)for(y=Math.min(x,t),z=Math.max(0,x-v);z<=y;z++)A=x-z,h[z+A].y+=a[A][z]*p[A][z];t=m.length-1;h=l(h,2*t-1,r,0);v=w.subtract(k,m[0]);a=w.square(v);for(z=p=0;z<h;z++)v=w.subtract(k,n(m,t,r[z],null,null)),v=w.square(v),v<a&&(a=v,p=r[z]);v=w.subtract(k,m[t]);v=w.square(v);v<a&&(a=v,p=1);return{location:p,distance:a}},l=function(k,m,r,t){var v=[],x=[],y=[],
a=[],h=0;var p=B(k[0].y);for(var z=1;z<=m;z++){var A=B(k[z].y);A!=p&&h++;p=A}switch(h){case 0:return 0;case 1:if(t>=64)return r[0]=(k[0].x+k[m].x)/2,1;var C,D;h=k[0].y-k[m].y;A=k[m].x-k[0].x;p=k[0].x*k[m].y-k[m].x*k[0].y;z=C=0;for(D=1;D<m;D++){var E=h*k[D].x+A*k[D].y+p;E>C?C=E:E<z&&(z=E)}D=A;C=1/(0*D-h*1)*(p-C-D*0);D=A;h=1/(0*D-h*1)*(p-z-D*0);if(Math.max(C,h)-Math.min(C,h)<2.710505431213761E-20)return y=k[m].x-k[0].x,a=k[m].y-k[0].y,r[0]=1/(y*0-a*1)*(y*(k[0].y-0)-a*(k[0].x-0)),1}n(k,m,.5,v,x);k=l(v,
m,y,t+1);m=l(x,m,a,t+1);for(t=0;t<k;t++)r[t]=y[t];for(t=0;t<m;t++)r[t+k]=a[t];return k+m},n=function(k,m,r,t,v){for(var x=[[]],y=0;y<=m;y++)x[0][y]=k[y];for(k=1;k<=m;k++)for(y=0;y<=m-k;y++)x[k]||(x[k]=[]),x[k][y]||(x[k][y]={}),x[k][y].x=(1-r)*x[k-1][y].x+r*x[k-1][y+1].x,x[k][y].y=(1-r)*x[k-1][y].y+r*x[k-1][y+1].y;if(t!=null)for(y=0;y<=m;y++)t[y]=x[y][0];if(v!=null)for(y=0;y<=m;y++)v[y]=x[m-y][y];return x[m][0]},d={},e=function(k){var m=d[k];if(!m){m=[];var r=function(p){return function(z){return p}},
t=function(){return function(p){return p}},v=function(){return function(p){return 1-p}},x=function(p){return function(z){for(var A=1,C=0;C<p.length;C++)A*=p[C](z);return A}};m.push(new function(){return function(p){return Math.pow(p,k)}});for(var y=1;y<k;y++){for(var a=[new r(k)],h=0;h<k-y;h++)a.push(new t);for(h=0;h<y;h++)a.push(new v);m.push(new x(a))}m.push(new function(){return function(p){return Math.pow(1-p,k)}});d[k]=m}return m},c=function(k,m){for(var r=e(k.length-1),t=0,v=0,x=0;x<k.length;x++)t+=
k[x].x*r[x](m),v+=k[x].y*r[x](m);return{x:t,y:v}},b=function(k,m){return Math.sqrt(Math.pow(k.x-m.x,2)+Math.pow(k.y-m.y,2))},f=function(k,m,r){for(var t=c(k,m),v=0,x=r>0?1:-1,y=null;v<Math.abs(r);)m+=.005*x,y=c(k,m),v+=b(y,t),t=y;return{point:y,location:m}},g=function(k,m){var r=c(k,m);m=c(k.slice(0,k.length-1),m);k=m.y-r.y;r=m.x-r.x;return k==0?Infinity:Math.atan(k/r)};ChemDoodle.lib.jsBezier={distanceFromCurve:u,gradientAtPoint:g,gradientAtPointAlongCurveFrom:function(k,m,r){m=f(k,m,r);m.location>
1&&(m.location=1);m.location<0&&(m.location=0);return g(k,m.location)},nearestPointOnCurve:function(k,m){k=u(k,m);return{point:n(m,m.length-1,k.location,null,null),location:k.location}},pointOnCurve:c,pointAlongCurveFrom:function(k,m,r){return f(k,m,r).point},perpendicularToCurveAt:function(k,m,r,t){m=f(k,m,t==null?0:t);k=g(k,m.location);t=Math.atan(-1/k);k=r/2*Math.sin(t);r=r/2*Math.cos(t);return[{x:m.point.x+r,y:m.point.y+k},{x:m.point.x-r,y:m.point.y-k}]},locationAlongCurveFrom:function(k,m,r){return f(k,
m,r).location},getLength:function(k){for(var m=c(k,0),r=0,t=0,v;t<1;)t+=.005,v=c(k,t),r+=b(v,m),m=v;return r}}})(ChemDoodle.lib);
ChemDoodle.lib.MarchingCubes=function(){var q=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,
2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,
2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),B=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,
8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,
2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,
0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,
7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,
11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,
9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,
8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,
5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,
8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,
8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,
1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,
2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],w=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],u=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];return function(l,n){var d=[],e=[],c=0,b=new Float32Array(8),f=new Int32Array(12),g=new Int32Array(3);for(g[2]=0;g[2]<n[2]-1;++g[2],c+=n[0])for(g[1]=0;g[1]<n[1]-1;++g[1],++c)for(g[0]=0;g[0]<n[0]-1;++g[0],++c){for(var k=0,m=0;m<8;++m){var r=w[m];r=l[c+r[0]+n[0]*(r[1]+n[1]*r[2])];
b[m]=r;k|=r>0?1<<m:0}r=q[k];if(r!==0){for(m=0;m<12;++m)if((r&1<<m)!==0){f[m]=d.length;var t=[0,0,0],v=u[m],x=w[v[0]],y=w[v[1]],a=b[v[0]],h=a-b[v[1]];v=0;Math.abs(h)>1E-6&&(v=a/h);for(a=0;a<3;++a)t[a]=g[a]+x[a]+v*(y[a]-x[a]);d.push(t)}k=B[k];for(m=0;m<k.length;m+=3)e.push([f[k[m]],f[k[m+1]],f[k[m+2]]])}}return{vertices:d,faces:e}}}();
ChemDoodle.animations=function(q,B){B={};q.requestAnimFrame=function(){return q.requestAnimationFrame||q.webkitRequestAnimationFrame||q.mozRequestAnimationFrame||q.oRequestAnimationFrame||q.msRequestAnimationFrame||function(w,u){q.setTimeout(w,1E3/60)}}();B.requestInterval=function(w,u){function l(){(new Date).getTime()-n>=u&&(w.call(),n=(new Date).getTime());d.value=q.requestAnimFrame(l)}if(!(q.requestAnimationFrame||q.webkitRequestAnimationFrame||q.mozRequestAnimationFrame&&q.mozCancelRequestAnimationFrame||
q.oRequestAnimationFrame||q.msRequestAnimationFrame))return q.setInterval(w,u);let n=(new Date).getTime(),d={};d.value=q.requestAnimFrame(l);return d};B.clearRequestInterval=function(w){q.cancelAnimationFrame?q.cancelAnimationFrame(w.value):q.webkitCancelAnimationFrame?q.webkitCancelAnimationFrame(w.value):q.webkitCancelRequestAnimationFrame?q.webkitCancelRequestAnimationFrame(w.value):q.mozCancelRequestAnimationFrame?q.mozCancelRequestAnimationFrame(w.value):q.oCancelRequestAnimationFrame?q.oCancelRequestAnimationFrame(w.value):
q.msCancelRequestAnimationFrame?q.msCancelRequestAnimationFrame(w.value):clearInterval(w)};B.requestTimeout=function(w,u){function l(){(new Date).getTime()-n>=u?w.call():d.value=q.requestAnimFrame(l)}if(!(q.requestAnimationFrame||q.webkitRequestAnimationFrame||q.mozRequestAnimationFrame&&q.mozCancelRequestAnimationFrame||q.oRequestAnimationFrame||q.msRequestAnimationFrame))return q.setTimeout(w,u);let n=(new Date).getTime(),d={};d.value=q.requestAnimFrame(l);return d};B.clearRequestTimeout=function(w){q.cancelAnimationFrame?
q.cancelAnimationFrame(w.value):q.webkitCancelAnimationFrame?q.webkitCancelAnimationFrame(w.value):q.webkitCancelRequestAnimationFrame?q.webkitCancelRequestAnimationFrame(w.value):q.mozCancelRequestAnimationFrame?q.mozCancelRequestAnimationFrame(w.value):q.oCancelRequestAnimationFrame?q.oCancelRequestAnimationFrame(w.value):q.msCancelRequestAnimationFrame?q.msCancelRequestAnimationFrame(w.value):clearTimeout(w)};return B}(window);
ChemDoodle.extensions=function(q,B,w,u){return{vec3AngleFrom:function(l,n){let d=B.length(l),e=B.length(n);l=B.dot(l,n);return w.acos(l/d/e)},contextRoundRect:function(l,n,d,e,c,b){l.beginPath();l.moveTo(n+b,d);l.lineTo(n+e-b,d);l.quadraticCurveTo(n+e,d,n+e,d+b);l.lineTo(n+e,d+c-b);l.quadraticCurveTo(n+e,d+c,n+e-b,d+c);l.lineTo(n+b,d+c);l.quadraticCurveTo(n,d+c,n,d+c-b);l.lineTo(n,d+b);l.quadraticCurveTo(n,d,n+b,d);l.closePath()},contextEllipse:function(l,n,d,e,c){let b=e/2*.5522848,f=c/2*.5522848,
g=n+e,k=d+c;e=n+e/2;c=d+c/2;l.beginPath();l.moveTo(n,c);l.bezierCurveTo(n,c-f,e-b,d,e,d);l.bezierCurveTo(e+b,d,g,c-f,g,c);l.bezierCurveTo(g,c+f,e+b,k,e,k);l.bezierCurveTo(e-b,k,n,c+f,n,c);l.closePath()},getFontString:function(l,n,d,e){let c=[];d&&c.push("bold ");e&&c.push("italic ");c.push(l+"px ");for(let b=0,f=n.length;b<f;b++)l=n[b],l.indexOf(" ")!==-1&&(l='"'+l+'"'),c.push((b!==0?",":"")+l);return c.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math);
(function(q,B,w){B.sign||(B.sign=function(u){return(u>0)-(u<0)||+u});typeof q.assign!="function"&&(q.assign=function(u,l){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=q(u),d=1;d<arguments.length;d++){var e=arguments[d];if(e!=null)for(var c in e)q.prototype.hasOwnProperty.call(e,c)&&(n[c]=e[c])}return n});String.prototype.startsWith||(String.prototype.startsWith=function(u,l){return this.substr(l||0,u.length)===u})})(Object,Math);
ChemDoodle.math=function(q,B,w,u,l){let n={},d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};n.angleBetweenLargest=function(e){if(e.length===0)return{angle:0,largest:w.PI*2};if(e.length===1)return{angle:e[0]+w.PI,largest:w.PI*2};let c=0,b=0;for(let g=0,k=e.length-1;g<k;g++){var f=e[g+
1]-e[g];f>c&&(c=f,b=(e[g+1]+e[g])/2)}f=e[0]+w.PI*2-e[e.length-1];f>c&&(b=e[0]-f/2,c=f,b<0&&(b+=w.PI*2));return{angle:b,largest:c}};n.isBetween=function(e,c,b){if(c>b){let f=c;c=b;b=f}return e>=c&&e<=b};u.addEventListener("DOMContentLoaded",function(e){q&&q.iChemLabs&&q.iChemLabs.checkForUpdates&&q.iChemLabs.checkForUpdates({})});n.getRGB=function(e,c){let b=[0,0,0];d[e.toLowerCase()]&&(e=d[e.toLowerCase()]);return e.charAt(0)==="#"?(e.length===4&&(e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+
e.charAt(3)+e.charAt(3)),[parseInt(e.substring(1,3),16)/255*c,parseInt(e.substring(3,5),16)/255*c,parseInt(e.substring(5,7),16)/255*c]):e.startsWith("rgba")?(e=e.replace(/rgba\(|\)/g,"").split(","),e.length!==4?b:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c,parseInt(e[3])/255*c]):e.startsWith("rgb")?(e=e.replace(/rgb\(|\)/g,"").split(","),e.length!==3?b:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c]):b};n.hsl2rgb=function(e,c,b){let f=function(g,k,m){m<0?m+=1:
m>1&&--m;return m<1/6?g+(k-g)*6*m:m<.5?k:m<2/3?g+(k-g)*(2/3-m)*6:g};if(c===0)b=c=e=b;else{let g=b<.5?b*(1+c):b+c-b*c,k=2*b-g;b=f(k,g,e+1/3);c=f(k,g,e);e=f(k,g,e-1/3)}return[b*255,c*255,e*255]};n.idx2color=function(e){e=e.toString(16);for(let c=0,b=6-e.length;c<b;c++)e="0"+e;return"#"+e};n.distanceFromPointToLineInclusive=function(e,c,b,f){let g=c.distance(b);b=c.angle(b);b=w.PI/2-b;b=c.angle(e)+b;e=c.distance(e);e=new B.Point(e*w.cos(b),-e*w.sin(b));f=f?f:0;return n.isBetween(-e.y,f,g-f)?w.abs(e.x):
-1};n.calculateDistanceInterior=function(e,c,b){if(this.isBetween(c.x,b.x,b.x+b.w)&&this.isBetween(c.y,b.y,b.y+b.h))return e.distance(c);var f=[];f.push({x1:b.x,y1:b.y,x2:b.x+b.w,y2:b.y});f.push({x1:b.x,y1:b.y+b.h,x2:b.x+b.w,y2:b.y+b.h});f.push({x1:b.x,y1:b.y,x2:b.x,y2:b.y+b.h});f.push({x1:b.x+b.w,y1:b.y,x2:b.x+b.w,y2:b.y+b.h});b=[];for(var g=0;g<4;g++){var k=f[g];(k=this.intersectLines(c.x,c.y,e.x,e.y,k.x1,k.y1,k.x2,k.y2))&&b.push(k)}if(b.length===0)return 0;c=0;for(let m=0,r=b.length;m<r;m++)g=
b[m],f=e.x-g.x,g=e.y-g.y,c=w.max(c,w.sqrt(f*f+g*g));return c};n.intersectLines=function(e,c,b,f,g,k,m,r){b-=e;f-=c;m-=g;r-=k;let t=f*m-b*r;if(t===0)return!1;m=(r*(e-g)-m*(c-k))/t;g=(f*(e-g)-b*(c-k))/t;return g>=0&&g<=1&&m>=0&&m<=1?{x:e+m*b,y:c+m*f}:!1};n.getParameterizedIntersectionPt=function(e,c,b,f,g,k,m,r){b-=e;f-=c;m-=g;r-=k;e=g-e;c=k-c;k=f*m-b*r;return Math.abs(k)<1E-6?[Infinity,Infinity]:[(c*m-e*r)/k,(b*c-f*e)/k]};n.clamp=function(e,c,b){return e<c?c:e>b?b:e};n.rainbowAt=function(e,c,b){b.length<
1?b.push("#000000","#FFFFFF"):b.length<2&&b.push("#FFFFFF");var f=c/(b.length-1);c=w.floor(e/f);e=(e-c*f)/f;f=n.getRGB(b[c],1);b=n.getRGB(b[c+1],1);return"rgb("+[(f[0]+(b[0]-f[0])*e)*255,(f[1]+(b[1]-f[1])*e)*255,(f[2]+(b[2]-f[2])*e)*255].join()+")"};n.angleBounds=function(e,c,b){let f=w.PI*2;for(;e<0;)e+=f;for(;e>f;)e-=f;b&&e>w.PI&&(e=2*w.PI-e);c&&(e=180*e/w.PI);return e};n.isPointInPoly=function(e,c){for(var b=!1,f=-1,g=e.length,k=g-1;++f<g;k=f)(e[f].y<=c.y&&c.y<e[k].y||e[k].y<=c.y&&c.y<e[f].y)&&
c.x<(e[k].x-e[f].x)*(c.y-e[f].y)/(e[k].y-e[f].y)+e[f].x&&(b=!b);return b};return n}(ChemDoodle,ChemDoodle.structures,Math,document);
(function(q,B,w){q.Bounds=function(){};let u=q.Bounds.prototype;u.minX=u.minY=u.minZ=Infinity;u.maxX=u.maxY=u.maxZ=-Infinity;u.expand=function(l,n,d,e){l instanceof q.Bounds?(this.minX=B.min(this.minX,l.minX),this.minY=B.min(this.minY,l.minY),this.maxX=B.max(this.maxX,l.maxX),this.maxY=B.max(this.maxY,l.maxY),l.maxZ!==Infinity&&(this.minZ=B.min(this.minZ,l.minZ),this.maxZ=B.max(this.maxZ,l.maxZ))):(this.minX=B.min(this.minX,l),this.maxX=B.max(this.maxX,l),this.minY=B.min(this.minY,n),this.maxY=B.max(this.maxY,
n),d!==w&&e!==w&&(this.minX=B.min(this.minX,d),this.maxX=B.max(this.maxX,d),this.minY=B.min(this.minY,e),this.maxY=B.max(this.maxY,e)))};u.expand3D=function(l,n,d,e,c,b){this.minX=B.min(this.minX,l);this.maxX=B.max(this.maxX,l);this.minY=B.min(this.minY,n);this.maxY=B.max(this.maxY,n);this.minZ=B.min(this.minZ,d);this.maxZ=B.max(this.maxZ,d);e!==w&&c!==w&&b!==w&&(this.minX=B.min(this.minX,e),this.maxX=B.max(this.maxX,e),this.minY=B.min(this.minY,c),this.maxY=B.max(this.maxY,c),this.minZ=B.min(this.minZ,
b),this.maxZ=B.max(this.maxZ,b))}})(ChemDoodle.math,Math);
ChemDoodle.featureDetection=function(q,B,w,u){let l={supports_canvas:function(){return!!B.createElement("canvas").getContext},supports_canvas_text:function(){return l.supports_canvas()?typeof B.createElement("canvas").getContext("2d").fillText==="function":!1},supports_webgl:function(){let n=B.createElement("canvas");try{if(n.getContext("webgl")||n.getContext("experimental-webgl"))return!0}catch(d){}return!1},supports_xhr2:function(){return"withCredentials"in new XMLHttpRequest},supports_touch:function(){let n=
(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!w.MSStream;return"ontouchstart"in w&&n},supports_gesture:function(){return"ongesturestart"in w}};return l}(ChemDoodle.iChemLabs,document,window);ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Nh Fl Mc Lv Ts Og".split(" ");
ChemDoodle.ELEMENT=function(q,B){function w(u,l,n,d,e,c,b,f,g){this.symbol=u;this.name=l;this.atomicNumber=n;this.addH=d;this.jmolColor=this.pymolColor=e;this.covalentRadius=c;this.vdWRadius=b;this.valency=f;this.mass=g}q=[];q.H=new w("H","Hydrogen",1,!1,"#FFFFFF",.31,1.1,1,1);q.He=new w("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4);q.Li=new w("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7);q.Be=new w("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9);q.B=new w("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11);q.C=new w("C",
"Carbon",6,!0,"#909090",.76,1.7,4,12);q.N=new w("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14);q.O=new w("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16);q.F=new w("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19);q.Ne=new w("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20);q.Na=new w("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23);q.Mg=new w("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24);q.Al=new w("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27);q.Si=new w("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28);q.P=new w("P",
"Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31);q.S=new w("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32);q.Cl=new w("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35);q.Ar=new w("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40);q.K=new w("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39);q.Ca=new w("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40);q.Sc=new w("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45);q.Ti=new w("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48);q.V=new w("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51);q.Cr=new w("Cr",
"Chromium",24,!1,"#8A99C7",1.39,0,2,52);q.Mn=new w("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55);q.Fe=new w("Fe","Iron",26,!1,"#E06633",1.32,0,2,56);q.Co=new w("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59);q.Ni=new w("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58);q.Cu=new w("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63);q.Zn=new w("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64);q.Ga=new w("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69);q.Ge=new w("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74);q.As=new w("As",
"Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75);q.Se=new w("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80);q.Br=new w("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79);q.Kr=new w("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84);q.Rb=new w("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85);q.Sr=new w("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88);q.Y=new w("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89);q.Zr=new w("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90);q.Nb=new w("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93);q.Mo=
new w("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98);q.Tc=new w("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0);q.Ru=new w("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102);q.Rh=new w("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103);q.Pd=new w("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106);q.Ag=new w("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107);q.Cd=new w("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114);q.In=new w("In","Indium",49,!1,"#A67573",1.42,1.93,0,115);q.Sn=new w("Sn","Tin",50,!1,"#668080",1.39,
2.17,4,120);q.Sb=new w("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121);q.Te=new w("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130);q.I=new w("I","Iodine",53,!0,"#940094",1.39,1.98,1,127);q.Xe=new w("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132);q.Cs=new w("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133);q.Ba=new w("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138);q.La=new w("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139);q.Ce=new w("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140);q.Pr=new w("Pr","Praseodymium",
59,!1,"#D9FFC7",2.03,0,0,141);q.Nd=new w("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142);q.Pm=new w("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0);q.Sm=new w("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152);q.Eu=new w("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153);q.Gd=new w("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158);q.Tb=new w("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159);q.Dy=new w("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164);q.Ho=new w("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165);q.Er=new w("Er",
"Erbium",68,!1,"#00E675",1.89,0,0,166);q.Tm=new w("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169);q.Yb=new w("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174);q.Lu=new w("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175);q.Hf=new w("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180);q.Ta=new w("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181);q.W=new w("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184);q.Re=new w("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187);q.Os=new w("Os","Osmium",76,!1,"#266696",1.44,0,2,192);q.Ir=new w("Ir",
"Iridium",77,!1,"#175487",1.41,0,3,193);q.Pt=new w("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195);q.Au=new w("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197);q.Hg=new w("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202);q.Tl=new w("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205);q.Pb=new w("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208);q.Bi=new w("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209);q.Po=new w("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0);q.At=new w("At","Astatine",85,!0,"#754F45",1.5,2.02,1,
0);q.Rn=new w("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0);q.Fr=new w("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0);q.Ra=new w("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0);q.Ac=new w("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0);q.Th=new w("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232);q.Pa=new w("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231);q.U=new w("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238);q.Np=new w("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0);q.Pu=new w("Pu","Plutonium",94,!1,"#006BFF",1.87,0,
0,0);q.Am=new w("Am","Americium",95,!1,"#545CF2",1.8,0,0,0);q.Cm=new w("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0);q.Bk=new w("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0);q.Cf=new w("Cf","Californium",98,!1,"#A136D4",0,0,0,0);q.Es=new w("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0);q.Fm=new w("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0);q.Md=new w("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0);q.No=new w("No","Nobelium",102,!1,"#BD0D87",0,0,0,0);q.Lr=new w("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0);q.Rf=new w("Rf",
"Rutherfordium",104,!1,"#CC0059",0,0,0,0);q.Db=new w("Db","Dubnium",105,!1,"#D1004F",0,0,0,0);q.Sg=new w("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0);q.Bh=new w("Bh","Bohrium",107,!1,"#E00038",0,0,0,0);q.Hs=new w("Hs","Hassium",108,!1,"#E6002E",0,0,0,0);q.Mt=new w("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0);q.Ds=new w("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0);q.Rg=new w("Rg","Roentgenium",111,!1,"#000000",0,0,0,0);q.Cn=new w("Cn","Copernicium",112,!1,"#000000",0,0,0,0);q.Nh=new w("Nh","Nihonium",
113,!1,"#000000",0,0,0,0);q.Fl=new w("Fl","Flerovium",114,!1,"#000000",0,0,0,0);q.Mc=new w("Mc","Moscovium",115,!1,"#000000",0,0,0,0);q.Lv=new w("Lv","Livermorium",116,!1,"#000000",0,0,0,0);q.Ts=new w("Ts","Tennessine",117,!1,"#000000",0,0,0,0);q.Og=new w("Og","Oganesson",118,!1,"#000000",0,0,0,0);q.H.pymolColor="#E6E6E6";q.C.pymolColor="#33FF33";q.N.pymolColor="#3333FF";q.O.pymolColor="#FF4D4D";q.F.pymolColor="#B3FFFF";q.S.pymolColor="#E6C640";return q}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(q){function B(w,u,l,n,d,e){this.symbol=w;this.name=u;this.polar=l;this.aminoColor=n;this.shapelyColor=d;this.acidity=e}q=[];q.Ala=new B("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0);q.Arg=new B("Arg","Arginine",!0,"#145AFF","#00007C",1);q.Asn=new B("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0);q.Asp=new B("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1);q.Cys=new B("Cys","Cysteine",!0,"#E6E600","#FFFF70",0);q.Gln=new B("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0);q.Glu=new B("Glu",
"Glutamic Acid",!0,"#E60A0A","#660000",-1);q.Gly=new B("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0);q.His=new B("His","Histidine",!0,"#8282D2","#7070FF",1);q.Ile=new B("Ile","Isoleucine",!1,"#0F820F","#004C00",0);q.Leu=new B("Leu","Leucine",!1,"#0F820F","#455E45",0);q.Lys=new B("Lys","Lysine",!0,"#145AFF","#4747B8",1);q.Met=new B("Met","Methionine",!1,"#E6E600","#B8A042",0);q.Phe=new B("Phe","Phenylalanine",!1,"#3232AA","#534C52",0);q.Pro=new B("Pro","Proline",!1,"#DC9682","#525252",0);q.Ser=new B("Ser",
"Serine",!0,"#FA9600","#FF7042",0);q.Thr=new B("Thr","Threonine",!0,"#FA9600","#B84C00",0);q.Trp=new B("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0);q.Tyr=new B("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0);q.Val=new B("Val","Valine",!1,"#0F820F","#FF8CFF",0);q.Asx=new B("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0);q.Glx=new B("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0);q["*"]=new B("*","Other",!1,"#BEA06E","#FF00FF",0);q.A=new B("A","Adenine",!1,"#BEA06E","#A0A0FF",0);q.G=
new B("G","Guanine",!1,"#BEA06E","#FF7070",0);q.I=new B("I","",!1,"#BEA06E","#80FFFF",0);q.C=new B("C","Cytosine",!1,"#BEA06E","#FF8C4B",0);q.T=new B("T","Thymine",!1,"#BEA06E","#A0FFA0",0);q.U=new B("U","Uracil",!1,"#BEA06E","#FF8080",0);return q}();
(function(q,B){q.Queue=function(){this.queue=[]};q=q.Queue.prototype;q.queueSpace=0;q.getSize=function(){return this.queue.length-this.queueSpace};q.isEmpty=function(){return this.queue.length===0};q.enqueue=function(w){this.queue.push(w)};q.dequeue=function(){let w;this.queue.length&&(w=this.queue[this.queueSpace],++this.queueSpace*2>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0));return w};q.getOldestElement=function(){let w;this.queue.length&&(w=this.queue[this.queueSpace]);
return w}})(ChemDoodle.structures);
(function(q,B,w){q.Point=function(u,l){this.x=u?u:0;this.y=l?l:0};q=q.Point.prototype;q.sub=function(u){this.x-=u.x;this.y-=u.y};q.add=function(u){this.x+=u.x;this.y+=u.y};q.distance=function(u){let l=u.x-this.x;u=u.y-this.y;return B.sqrt(l*l+u*u)};q.angleForStupidCanvasArcs=function(u){var l=u.x-this.x;u=u.y-this.y;for(l=l===0?u===0?0:u>0?B.PI/2:3*B.PI/2:u===0?l>0?0:B.PI:l<0?B.atan(u/l)+B.PI:u<0?B.atan(u/l)+2*B.PI:B.atan(u/l);l<0;)l+=B.PI*2;return l%=B.PI*2};q.angle=function(u){var l=u.x-this.x;
u=this.y-u.y;for(l=l===0?u===0?0:u>0?B.PI/2:3*B.PI/2:u===0?l>0?0:B.PI:l<0?B.atan(u/l)+B.PI:u<0?B.atan(u/l)+2*B.PI:B.atan(u/l);l<0;)l+=B.PI*2;return l%=B.PI*2}})(ChemDoodle.structures,Math);
(function(q,B,w,u){let l=/[ ,]+/,n=/\-+/,d=["Helvetica","Arial","Dialog"];B.Query=function(e){this.type=e;this.elements={v:[],not:!1};this.saturation=this.hydrogens=this.connectivityNoH=this.connectivity=this.chirality=this.charge=u;this.orders={v:[],not:!1};this.cache=this.ringCount=this.aromatic=this.stereo=u};B.Query.TYPE_ATOM=0;B.Query.TYPE_BOND=1;w=B.Query.prototype;w.parseRange=function(e){let c=[];e=e.split(l);for(let k=0,m=e.length;k<m;k++){var b=e[k],f=!1,g=!1;b.charAt(0)==="-"&&(f=!0,b=
b.substring(1));b.indexOf("--")!=-1&&(g=!0);b.indexOf("-")!=-1?(b=b.split(n),f={x:parseInt(b[0])*(f?-1:1),y:parseInt(b[1])*(g?-1:1)},f.y<f.x&&(g=f.y,f.y=f.x,f.x=g),c.push(f)):c.push({x:parseInt(b)*(f?-1:1)})}return c};w.draw=function(e,c,b){this.cache||(this.cache=this.toString());let f=this.cache,g=u;var k=f.indexOf("(");k!=-1&&(f=this.cache.substring(0,k),g=this.cache.substring(k,this.cache.length));e.textAlign="center";e.textBaseline="middle";e.font=q.getFontString(12,d,!0,!1);k=e.measureText(f).width;
e.fillStyle=c.backgroundColor;e.fillRect(b.x-k/2,b.y-6,k,12);e.fillStyle="black";e.fillText(f,b.x,b.y);g&&(e.font=q.getFontString(10,d,!1,!0),k=e.measureText(g).width,e.fillStyle=c.backgroundColor,e.fillRect(b.x-k/2,b.y+6,k,11),e.fillStyle="black",e.fillText(g,b.x,b.y+11))};w.outputRange=function(e){let c=!1,b=[];for(let f=0,g=e.length;f<g;f++){c&&b.push(",");c=!0;let k=e[f];k.y?(b.push(k.x),b.push("-"),b.push(k.y)):b.push(k.x)}return b.join("")};w.toString=function(){let e=[],c=[];this.type===B.Query.TYPE_ATOM?
(this.elements&&this.elements.v.length!==0?(this.elements.not&&e.push("!"),e.push("["),e.push(this.elements.v.join(",")),e.push("]")):e.push("[a]"),this.chirality&&c.push((this.chirality.not?"!":"")+"@\x3d"+this.chirality.v),this.aromatic&&c.push((this.aromatic.not?"!":"")+"A"),this.charge&&c.push((this.charge.not?"!":"")+"C\x3d"+this.outputRange(this.charge.v)),this.hydrogens&&c.push((this.hydrogens.not?"!":"")+"H\x3d"+this.outputRange(this.hydrogens.v)),this.ringCount&&c.push((this.ringCount.not?
"!":"")+"R\x3d"+this.outputRange(this.ringCount.v)),this.saturation&&c.push((this.saturation.not?"!":"")+"S"),this.connectivity&&c.push((this.connectivity.not?"!":"")+"X\x3d"+this.outputRange(this.connectivity.v)),this.connectivityNoH&&c.push((this.connectivityNoH.not?"!":"")+"x\x3d"+this.outputRange(this.connectivityNoH.v))):this.type===B.Query.TYPE_BOND&&(this.orders&&this.orders.v.length!==0?(this.orders.not&&e.push("!"),e.push("["),e.push(this.orders.v.join(",")),e.push("]")):e.push("[a]"),this.stereo&&
c.push((this.stereo.not?"!":"")+"@\x3d"+this.stereo.v),this.aromatic&&c.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&c.push((this.ringCount.not?"!":"")+"R\x3d"+this.outputRange(this.ringCount.v)));c.length>0&&(e.push("("),e.push(c.join(",")),e.push(")"));return e.join("")}})(ChemDoodle.extensions,ChemDoodle.structures,Math);
(function(q,B,w,u,l,n,d){let e=/\s+/g;u.Atom=function(b,f,g,k){this.label=b?b.trim():"C";u.Point.call(this,f,g);this.z=k?k:0;this.enhancedStereo={type:u.Atom.ESTEREO_ABSOLUTE,group:1};this.pid=u.PID++};u.Atom.ESTEREO_ABSOLUTE="abs";u.Atom.ESTEREO_OR="or";u.Atom.ESTEREO_AND="\x26";let c=u.Atom.prototype=new u.Point;c.charge=0;c.numLonePair=0;c.numRadical=0;c.mass=-1;c.implicitH=-1;c.coordinationNumber=0;c.bondNumber=0;c.angleOfLeastInterference=0;c.isHidden=!1;c.altLabel=d;c.isLone=!1;c.isHover=!1;
c.isSelected=!1;c.add3D=function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z};c.sub3D=function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z};c.distance3D=function(b){let f=b.x-this.x,g=b.y-this.y;b=b.z-this.z;return l.sqrt(f*f+g*g+b*b)};c.draw=function(b,f){if(!this.dontDraw){if(this.isLassoed){var g=b.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);g.addColorStop(0,"rgba(212, 99, 0, 0)");g.addColorStop(.7,"rgba(212, 99, 0, 0.8)");b.fillStyle=g;b.beginPath();b.arc(this.x,this.y,5,0,l.PI*2,!1);b.fill()}if(!this.query){this.textBounds=
[];this.styles&&(f=this.styles);var k=B.getFontString(f.atoms_font_size_2D,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D);b.font=k;b.fillStyle=this.getElementColor(f.atoms_useJMOLColors,f.atoms_usePYMOLColors,f.atoms_color,2);this.label==="H"&&f.atoms_HBlack_2D&&(b.fillStyle="black");this.error&&(b.fillStyle=f.colorError);g=this.isLabelVisible(f);if(this.isLone&&!g||f.atoms_circles_2D)this.isLone&&(b.fillStyle="#909090"),b.beginPath(),b.arc(this.x,this.y,f.atoms_circleDiameter_2D/
2,0,l.PI*2,!1),b.fill(),f.atoms_circleBorderWidth_2D>0&&(b.lineWidth=f.atoms_circleBorderWidth_2D,b.strokeStyle="black",b.stroke());else if(g)if(b.textAlign="center",b.textBaseline="middle",this.altLabel!==d){b.fillText(this.altLabel,this.x,this.y);var m=b.measureText(this.altLabel).width;this.textBounds.push({x:this.x-m/2,y:this.y-f.atoms_font_size_2D/2+1,w:m,h:f.atoms_font_size_2D-2})}else if(q[this.label]){b.fillText(this.label,this.x,this.y);var r=b.measureText(this.label).width;this.textBounds.push({x:this.x-
r/2,y:this.y-f.atoms_font_size_2D/2+1,w:r,h:f.atoms_font_size_2D-2});var t=0;this.mass!==-1&&(m=b.font,b.font=B.getFontString(f.atoms_font_size_2D*.7,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D),t=b.measureText(this.mass).width,b.textAlign="right",b.fillText(this.mass,this.x-r/2-1,this.y-f.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-r/2-t-.5,y:this.y-f.atoms_font_size_2D*1.7/2+1,w:t,h:f.atoms_font_size_2D/2-1}),b.font=m,b.textAlign="center");m=r/2;var v=this.getImplicitHydrogenCount();
if(f.atoms_implicitHydrogens_2D&&v>0){var x=0;let y=b.measureText("H").width,a=!0;if(v>1){let h=r/2+y/2,p=0,z=B.getFontString(f.atoms_font_size_2D*.8,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D);b.font=z;let A=b.measureText(v).width;this.bondNumber===1?this.angleOfLeastInterference>l.PI/2&&this.angleOfLeastInterference<3*l.PI/2&&(h=-r/2-A-y/2-t/2,a=!1,x=l.PI):this.angleOfLeastInterference<=l.PI/4||(this.angleOfLeastInterference<3*l.PI/4?(h=0,p=-f.atoms_font_size_2D*.9,this.charge!==
0&&(p-=f.atoms_font_size_2D*.3),a=!1,x=l.PI/2):this.angleOfLeastInterference<=5*l.PI/4?(h=-r/2-A-y/2-t/2,a=!1,x=l.PI):this.angleOfLeastInterference<7*l.PI/4&&(h=0,p=f.atoms_font_size_2D*.9,a=!1,x=3*l.PI/2));b.font=k;b.fillText("H",this.x+h,this.y+p);b.font=z;b.fillText(v,this.x+h+y/2+A/2,this.y+p+f.atoms_font_size_2D*.3);this.textBounds.push({x:this.x+h-y/2,y:this.y+p-f.atoms_font_size_2D/2+1,w:y,h:f.atoms_font_size_2D-2});this.textBounds.push({x:this.x+h+y/2,y:this.y+p+f.atoms_font_size_2D*.3-f.atoms_font_size_2D/
2+1,w:A,h:f.atoms_font_size_2D*.8-2})}else k=r/2+y/2,v=0,this.bondNumber===1?this.angleOfLeastInterference>l.PI/2&&this.angleOfLeastInterference<3*l.PI/2&&(k=-r/2-y/2-t/2,a=!1,x=l.PI):this.angleOfLeastInterference<=l.PI/4||(this.angleOfLeastInterference<3*l.PI/4?(k=0,v=-f.atoms_font_size_2D*.9,a=!1,x=l.PI/2):this.angleOfLeastInterference<=5*l.PI/4?(k=-r/2-y/2-t/2,a=!1,x=l.PI):this.angleOfLeastInterference<7*l.PI/4&&(k=0,v=f.atoms_font_size_2D*.9,a=!1,x=3*l.PI/2)),b.fillText("H",this.x+k,this.y+v),
this.textBounds.push({x:this.x+k-y/2,y:this.y+v-f.atoms_font_size_2D/2+1,w:y,h:f.atoms_font_size_2D-2});a&&(m+=y)}this.charge!==0&&(r=this.charge.toFixed(0),r=r==="1"?"+":r==="-1"?"\u2013":r.startsWith("-")?r.substring(1)+"\u2013":r+"+",t=b.measureText(r).width,m+=t/2,b.textAlign="center",b.textBaseline="middle",b.font=B.getFontString(l.floor(f.atoms_font_size_2D*.8),f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D),b.fillText(r,this.x+m-1,this.y-f.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x+
m-t/2-1,y:this.y-f.atoms_font_size_2D*1.8/2+5,w:t,h:f.atoms_font_size_2D/2-1}))}else u.CondensedLabel?this.label.match(e)?(b.textAlign="left",this.error&&(b.fillStyle=f.colorError),b.fillText(this.label,this.x,this.y),m=b.measureText(this.label).width,this.textBounds.push({x:this.x+1,y:this.y-f.atoms_font_size_2D/2+1,w:m,h:f.atoms_font_size_2D-2})):(this.condensed&&this.condensed.text===this.label||(this.condensed=new u.CondensedLabel(this,this.label)),this.condensed.draw(b,f)):(b.fillText(this.label,
this.x,this.y),m=b.measureText(this.label).width,this.textBounds.push({x:this.x-m/2,y:this.y-f.atoms_font_size_2D/2+1,w:m,h:f.atoms_font_size_2D-2}));this.attributes=[];for(m=0;m<this.numLonePair;m++)this.attributes.push({t:2});for(m=0;m<this.numRadical;m++)this.attributes.push({t:1});this.enhancedStereo.type!==u.Atom.ESTEREO_ABSOLUTE&&this.attributes.push(this.enhancedStereo);if(this.attributes.length>0)if(b.fillStyle="black",b.font=B.getFontString(f.atoms_font_size_2D*.8,f.atoms_font_families_2D,
f.atoms_font_bold_2D,f.atoms_font_italic_2D),b.textAlign="center",b.textBaseline="middle",r=this.angles.slice(0),m=this.angleOfLeastInterference,t=this.largestAngle,x!==d&&(r.push(x),r.sort(function(y,a){return y-a}),t=w.angleBetweenLargest(r),m=t.angle%(l.PI*2),t=t.largest),x===d&&l.abs(t-2*l.PI/r.length)<l.PI/60){r=l.ceil(this.attributes.length/r.length);for(let y=0,a=this.attributes.length;y<a;y+=r,m+=t)this.drawAttribute(b,f,this.attributes.slice(y,l.min(this.attributes.length,y+r)),m,t,x,g)}else this.drawAttribute(b,
f,this.attributes,m,t,x,g)}}};c.drawAttribute=function(b,f,g,k,m,r,t){r=m/(g.length+(this.bonds.length===0&&r===d?0:1));k=k-m/2+r;for(let a=0,h=g.length;a<h;a++){m=g[a];var v=k+a*r,x=f.atoms_lonePairDistance_2D;t&&m.type!==d&&(x+=4);let p=this.x+Math.cos(v)*x;x=this.y-Math.sin(v)*x;if(m.type!==d)b.fillText(m.type+m.group,p,x);else if(m.t===2){var y=v+Math.PI/2;v=Math.cos(y)*f.atoms_lonePairSpread_2D/2;y=-Math.sin(y)*f.atoms_lonePairSpread_2D/2;b.beginPath();b.arc(p+v,x+y,f.atoms_lonePairDiameter_2D,
0,l.PI*2,!1);b.fill();b.beginPath();b.arc(p-v,x-y,f.atoms_lonePairDiameter_2D,0,l.PI*2,!1);b.fill();m.bounds={x:Math.min(p+v,p-v)-f.atoms_lonePairDiameter_2D/2,y:Math.min(x+y,x-y)-f.atoms_lonePairDiameter_2D/2,w:Math.abs(v)*2+f.atoms_lonePairDiameter_2D,h:Math.abs(y)*2+f.atoms_lonePairDiameter_2D}}else m.t===1&&(b.beginPath(),b.arc(p,x,f.atoms_lonePairDiameter_2D,0,l.PI*2,!1),b.fill(),m.bounds={x:p-f.atoms_lonePairDiameter_2D/2,y:x-f.atoms_lonePairDiameter_2D/2,w:f.atoms_lonePairDiameter_2D,h:f.atoms_lonePairDiameter_2D})}};
c.drawDecorations=function(b,f){if(this.isHover||this.isSelected)b.strokeStyle=this.isHover?f.colorHover:f.colorSelect,b.lineWidth=1.2,b.beginPath(),b.arc(this.x,this.y,this.isHover?7:15,0,l.PI*2,!1),b.stroke();this.isOverlap&&(b.strokeStyle=f.colorError,b.lineWidth=1.2,b.beginPath(),b.arc(this.x,this.y,7,0,l.PI*2,!1),b.stroke())};c.render=function(b,f,g){this.styles&&(f=this.styles);let k=n.translate(n.identity(),[this.x,this.y,this.z]),m=f.atoms_useVDWDiameters_3D?q[this.label].vdWRadius*f.atoms_vdwMultiplier_3D:
f.atoms_sphereDiameter_3D/2;m===0&&(m=1);n.scale(k,[m,m,m]);g||(g=f.atoms_color,f.atoms_useJMOLColors?g=q[this.label].jmolColor:f.atoms_usePYMOLColors&&(g=q[this.label].pymolColor),b.material.setDiffuseColor(b,g));b.shader.setMatrixUniforms(b,k);b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)};c.renderHighlight=function(b,f){if(this.isSelected||this.isHover){this.styles&&(f=this.styles);let g=n.translate(n.identity(),[this.x,
this.y,this.z]),k=f.atoms_useVDWDiameters_3D?q[this.label].vdWRadius*f.atoms_vdwMultiplier_3D:f.atoms_sphereDiameter_3D/2;k===0&&(k=1);k*=1.3;n.scale(g,[k,k,k]);b.shader.setMatrixUniforms(b,g);b.material.setDiffuseColor(b,this.isHover?f.colorHover:f.colorSelect);b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)}};c.isLabelVisible=function(b){return b.atoms_displayAllCarbonLabels_2D||this.label!=="C"||this.altLabel||!q[this.label]||
this.mass!==-1||this.implicitH!==-1||this.charge!==0||b.atoms_showAttributedCarbons_2D&&(this.numRadical!==0||this.numLonePair!==0)||this.isHidden&&b.atoms_showHiddenCarbons_2D||b.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber===1?!0:!1};c.getImplicitHydrogenCount=function(){if(!q[this.label])return 0;if(this.implicitH!==-1)return this.implicitH;if(!q[this.label].addH||this.label==="H")return 0;var b=q[this.label].valency;let f=b-this.coordinationNumber;this.numRadical>0&&(f=l.max(0,f-this.numRadical));
this.charge>0?(b=4-b,f=this.charge<=b?f+this.charge:4-this.coordinationNumber-this.charge+b):f+=this.charge;return f<0?0:l.floor(f)};c.getBounds=function(){let b=new w.Bounds;b.expand(this.x,this.y);if(this.textBounds)for(let f=0,g=this.textBounds.length;f<g;f++){let k=this.textBounds[f];b.expand(k.x,k.y,k.x+k.w,k.y+k.h)}return b};c.getBounds3D=function(){let b=new w.Bounds;b.expand3D(this.x,this.y,this.z);return b};c.getElementColor=function(b,f,g){if(!q[this.label])return"#000";b?g=q[this.label].jmolColor:
f&&(g=q[this.label].pymolColor);return g}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);
(function(q,B,w,u,l,n,d,e){w.Bond=function(c,b,f){this.a1=c;this.a2=b;this.bondOrder=f!==e?f:1;this.pid=w.PID++};w.Bond.STEREO_NONE="none";w.Bond.STEREO_PROTRUDING="protruding";w.Bond.STEREO_RECESSED="recessed";w.Bond.STEREO_AMBIGUOUS="ambiguous";q=w.Bond.prototype;q.stereo=w.Bond.STEREO_NONE;q.isHover=!1;q.ring=e;q.getCenter=function(){return new w.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};q.getLength=function(){return this.a1.distance(this.a2)};q.getLength3D=function(){return this.a1.distance3D(this.a2)};
q.contains=function(c){return c===this.a1||c===this.a2};q.getNeighbor=function(c){return c===this.a1?this.a2:c===this.a2?this.a1:e};q.draw=function(c,b){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.styles&&(b=this.styles);var f=this.a1.x,g=this.a2.x,k=this.a1.y,m=this.a2.y,r=this.a1.distance(this.a2),t=g-f,v=m-k;if(this.a1.isLassoed&&this.a2.isLassoed){let x=c.createLinearGradient(f,k,g,m);x.addColorStop(0,"rgba(212, 99, 0, 0)");x.addColorStop(.5,"rgba(212, 99, 0, 0.8)");x.addColorStop(1,
"rgba(212, 99, 0, 0)");let y=this.a1.angle(this.a2)+l.PI/2,a=l.cos(y),h=l.sin(y),p=f-a*2.5,z=k+h*2.5,A=f+a*2.5,C=k-h*2.5,D=g+a*2.5,E=m-h*2.5,F=g-a*2.5,G=m+h*2.5;c.fillStyle=x;c.beginPath();c.moveTo(p,z);c.lineTo(A,C);c.lineTo(D,E);c.lineTo(F,G);c.closePath();c.fill()}if(b.atoms_display&&!b.atoms_circles_2D&&this.a1.isLabelVisible(b)&&this.a1.textBounds){let x=0;for(let a=0,h=this.a1.textBounds.length;a<h;a++)x=Math.max(x,u.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[a]));x+=b.bonds_atomLabelBuffer_2D;
let y=x/r;f+=t*y;k+=v*y}if(b.atoms_display&&!b.atoms_circles_2D&&this.a2.isLabelVisible(b)&&this.a2.textBounds){let x=0;for(let a=0,h=this.a2.textBounds.length;a<h;a++)x=Math.max(x,u.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[a]));x+=b.bonds_atomLabelBuffer_2D;let y=x/r;g-=t*y;m-=v*y}if(b.bonds_clearOverlaps_2D){let x=f+t*.15,y=k+v*.15,a=g-t*.15,h=m-v*.15;c.strokeStyle=b.backgroundColor;c.lineWidth=b.bonds_width_2D+b.bonds_overlapClearWidth_2D*2;c.lineCap="round";c.beginPath();c.moveTo(x,
y);c.lineTo(a,h);c.stroke()}c.strokeStyle=this.error?b.colorError:b.bonds_color;c.fillStyle=this.error?b.colorError:b.bonds_color;c.lineWidth=b.bonds_width_2D;c.lineCap=b.bonds_ends_2D;if(b.bonds_splitColor){let x=c.createLinearGradient(f,k,g,m),y=this.a1.styles?this.a1.styles:b,a=this.a2.styles?this.a2.styles:b,h=this.a1.getElementColor(y.atoms_useJMOLColors,y.atoms_usePYMOLColors,y.atoms_color,2),p=this.a2.getElementColor(a.atoms_useJMOLColors,a.atoms_usePYMOLColors,a.atoms_color,2);x.addColorStop(0,
h);b.bonds_colorGradient||(x.addColorStop(.5,h),x.addColorStop(.51,p));x.addColorStop(1,p);c.strokeStyle=x;c.fillStyle=x}if(b.bonds_lewisStyle_2D&&this.bondOrder%1===0)this.drawLewisStyle(c,b,f,k,g,m);else switch(this.query?1:this.bondOrder){case 0:if(this.stereo===w.Bond.STEREO_PROTRUDING){let L=b.bonds_wedgeThickness_2D/2,N=this.a1.angle(this.a2),Q=N+l.PI/2,O=b.shapes_arrowLength_2D*2/l.sqrt(3),S=l.cos(N),T=l.sin(N),V=l.cos(Q),P=l.sin(Q),U=g-S*O*.8,W=m+T*O*.8,X=U+V*L,aa=W-P*L,Z=U-V*L,Y=W+P*L;c.beginPath();
c.moveTo(g,m);c.lineTo(X,aa);c.lineTo(Z,Y);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(f,k);c.lineTo(U,W);c.stroke()}else{let L=g-f,N=m-k,Q=l.sqrt(L*L+N*N),O=l.floor(Q/b.bonds_dotSize_2D),S=(Q-(O-1)*b.bonds_dotSize_2D)/2;O%2===1?S+=b.bonds_dotSize_2D/4:(S-=b.bonds_dotSize_2D/4,O+=2);O/=2;let T=this.a1.angle(this.a2),V=f+S*Math.cos(T),P=k-S*Math.sin(T);c.beginPath();for(let U=0;U<O;U++)c.arc(V,P,b.bonds_dotSize_2D/2,0,l.PI*2,!1),V+=2*b.bonds_dotSize_2D*Math.cos(T),P-=2*b.bonds_dotSize_2D*
Math.sin(T);c.fill();break}case .5:c.beginPath();c.moveTo(f,k);c.lineTo(g,m);c.setLineDash([b.bonds_hashSpacing_2D,b.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([]);break;case 1:if(this.query||this.stereo!==w.Bond.STEREO_PROTRUDING&&this.stereo!==w.Bond.STEREO_RECESSED)if(this.query||this.stereo!==w.Bond.STEREO_AMBIGUOUS)c.beginPath(),c.moveTo(f,k),c.lineTo(g,m),c.stroke(),this.query&&this.query.draw(c,b,this.getCenter());else{let L=g-f,N=m-k;c.beginPath();c.moveTo(f,k);let Q=l.floor(l.sqrt(L*
L+N*N)/b.bonds_wavyLength_2D),O=f,S=k,T=this.a1.angle(this.a2)+l.PI/2,V=l.cos(T),P=l.sin(T),U=L/Q,W=N/Q,X,aa;for(let Z=0;Z<Q;Z++){O+=U;S+=W;let Y=Z%2===0?1:-1;X=b.bonds_wavyLength_2D*V*Y+O-U*.5;aa=b.bonds_wavyLength_2D*-P*Y+S-W*.5;c.quadraticCurveTo(X,aa,O,S)}c.stroke()}else{let L=b.bonds_width_2D/2,N=b.bonds_wedgeThickness_2D/2,Q=this.a1.angle(this.a2)+l.PI/2,O=l.cos(Q),S=l.sin(Q),T=f-O*L,V=k+S*L,P=f+O*L,U=k-S*L,W=g+O*N,X=m-S*N,aa=g-O*N,Z=m+S*N;c.save();c.beginPath();c.moveTo(T,V);c.lineTo(P,U);
c.lineTo(W,X);c.lineTo(aa,Z);c.closePath();this.stereo===w.Bond.STEREO_PROTRUDING?c.fill():(c.clip(),c.lineWidth=N*2,c.lineCap="butt",c.beginPath(),c.moveTo(f,k),c.lineTo(g+5*(g-f),m+5*(m-k)),c.setLineDash([b.bonds_hashWidth_2D,b.bonds_hashSpacing_2D]),c.stroke());c.restore()}break;case 1.5:case 2:let x=this.a1.angle(this.a2),y=x+l.PI/2,a=l.cos(y),h=l.sin(y),p=this.a1.distance(this.a2),z=b.bonds_useAbsoluteSaturationWidths_2D?b.bonds_saturationWidthAbs_2D/2:p*b.bonds_saturationWidth_2D/2;if(this.stereo===
w.Bond.STEREO_AMBIGUOUS){let L=f-a*z,N=k+h*z,Q=f+a*z,O=k-h*z,S=g+a*z,T=m-h*z,V=g-a*z,P=m+h*z;c.beginPath();c.moveTo(L,N);c.lineTo(S,T);c.moveTo(Q,O);c.lineTo(V,P);c.stroke()}else if(!b.bonds_symmetrical_2D&&(this.ring||this.a1.label==="C"&&this.a2.label==="C")){c.beginPath();c.moveTo(f,k);c.lineTo(g,m);c.stroke();let L=0;z*=2;let N=b.bonds_saturationAngle_2D;N<l.PI/2&&(L=-(z/l.tan(N)));if(l.abs(L)<p/2){let Q=f-l.cos(x)*L,O=g+l.cos(x)*L,S=k+l.sin(x)*L,T=m-l.sin(x)*L,V=Q-a*z,P=S+h*z,U=Q+a*z,W=S-h*z,
X=O-a*z,aa=T+h*z,Z=O+a*z,Y=T-h*z,ba=!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>l.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-l.PI;c.beginPath();ba?(c.moveTo(V,P),c.lineTo(X,aa)):(c.moveTo(U,W),c.lineTo(Z,Y));this.bondOrder!==2&&c.setLineDash([b.bonds_hashSpacing_2D,b.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([])}}else{let L=f-a*z,N=k+h*z,Q=f+a*z,O=k-h*z,S=g+a*z,T=m-h*
z,V=g-a*z,P=m+h*z;c.beginPath();c.moveTo(L,N);c.lineTo(V,P);c.stroke();c.beginPath();c.moveTo(Q,O);c.lineTo(S,T);this.bondOrder!==2&&c.setLineDash([b.bonds_hashWidth_2D,b.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([])}break;case 3:let A=b.bonds_useAbsoluteSaturationWidths_2D?b.bonds_saturationWidthAbs_2D:this.a1.distance(this.a2)*b.bonds_saturationWidth_2D,C=this.a1.angle(this.a2)+l.PI/2,D=l.cos(C),E=l.sin(C),F=f-D*A,G=k+E*A,I=f+D*A,J=k-E*A,M=g+D*A,H=m-E*A,R=g-D*A,K=m+E*A;c.beginPath();c.moveTo(F,
G);c.lineTo(R,K);c.moveTo(I,J);c.lineTo(M,H);c.moveTo(f,k);c.lineTo(g,m);c.stroke()}}};q.drawDecorations=function(c,b){if(this.isHover||this.isSelected){let f=2*l.PI,g=(this.a1.angleForStupidCanvasArcs(this.a2)+l.PI/2)%f;c.strokeStyle=this.isHover?b.colorHover:b.colorSelect;c.lineWidth=1.2;c.beginPath();b=(g+l.PI)%f;b%=l.PI*2;c.arc(this.a1.x,this.a1.y,7,g,b,!1);c.stroke();c.beginPath();g+=l.PI;b=(g+l.PI)%f;c.arc(this.a2.x,this.a2.y,7,g,b,!1);c.stroke()}};q.drawLewisStyle=function(c,b,f,g,k,m){var r=
this.a1.angle(this.a2);let t=r+l.PI/2;k-=f;m-=g;k=l.sqrt(k*k+m*m)/(this.bondOrder+1);m=k*l.cos(r);r=-k*l.sin(r);f+=m;g+=r;for(k=0;k<this.bondOrder;k++){var v=b.atoms_lonePairSpread_2D/2;let x=f-l.cos(t)*v,y=g+l.sin(t)*v,a=f+l.cos(t)*v;v=g-l.sin(t)*v;c.beginPath();c.arc(x-b.atoms_lonePairDiameter_2D/2,y-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,l.PI*2,!1);c.fill();c.beginPath();c.arc(a-b.atoms_lonePairDiameter_2D/2,v-b.atoms_lonePairDiameter_2D/2,b.atoms_lonePairDiameter_2D,0,l.PI*
2,!1);c.fill();f+=m;g+=r}};q.render=function(c,b,f){this.styles&&(b=this.styles);var g=this.a1.distance3D(this.a2);if(g!==0){var k=b.bonds_cylinderDiameter_3D/2,m=b.bonds_color,r=n.translate(n.identity(),[this.a1.x,this.a1.y,this.a1.z]),t,v=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],x=[0,1,0],y=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(x=[0,0,1],this.a2.y<this.a1.y&&(y=l.PI)):(y=B.vec3AngleFrom(x,v),x=d.cross(x,v,[]));if(b.bonds_splitColor){m=this.a1.styles?this.a1.styles:
b;var a=this.a2.styles?this.a2.styles:b;m=this.a1.getElementColor(m.atoms_useJMOLColors,m.atoms_usePYMOLColors,m.atoms_color);a=this.a2.getElementColor(a.atoms_useJMOLColors,a.atoms_usePYMOLColors,a.atoms_color);m!=a&&(t=n.translate(n.identity(),[this.a2.x,this.a2.y,this.a2.z]))}var h=[0];if(f){if(b.bonds_showBondOrders_3D&&this.bondOrder>1){h=[b.bonds_cylinderDiameter_3D];var p=[0,0,1];k=n.inverse(c.rotationMatrix,[]);n.multiplyVec3(k,p);p=d.cross(v,p,[]);d.normalize(p)}v=1;var z=b.bonds_pillSpacing_3D;
k=b.bonds_pillHeight_3D;this.bondOrder==0&&(b.bonds_renderAsLines_3D?k=z:(k=b.bonds_pillDiameter_3D,k<b.bonds_cylinderDiameter_3D&&(k/=2),v=k/2,g/=v,z/=v/2));f=k+z;let C=l.floor(g/f);g=(z+b.bonds_pillDiameter_3D+(g-f*C))/2;z=C;t&&(z=l.floor(C/2));for(let D=0,E=h.length;D<E;D++){let F=n.set(r,[]);h[D]!==0&&n.translate(F,d.scale(p,h[D],[]));y!==0&&n.rotate(F,y,x);v!=1&&n.scale(F,[v,v,v]);m&&c.material.setDiffuseColor(c,m);n.translate(F,[0,g,0]);for(var A=0;A<z;A++)b.bonds_renderAsLines_3D?this.bondOrder==
0?(c.shader.setMatrixUniforms(c,F),c.drawArrays(c.POINTS,0,1)):(n.scale(F,[1,k,1]),c.shader.setMatrixUniforms(c,F),c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems),n.scale(F,[1,1/k,1])):(c.shader.setMatrixUniforms(c,F),this.bondOrder==0?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)),n.translate(F,[0,f,0]);if(t){let G;b.bonds_renderAsLines_3D?(A=k,A/=2,
G=0):(A=2/3,G=(1-A)/2);C%2!=0&&(n.scale(F,[1,A,1]),c.shader.setMatrixUniforms(c,F),b.bonds_renderAsLines_3D?this.bondOrder==0?c.drawArrays(c.POINTS,0,1):c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):this.bondOrder==0?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0),n.translate(F,[0,f*(1+G),0]),n.scale(F,[1,1/A,1]));n.set(t,F);h[D]!==0&&n.translate(F,d.scale(p,
h[D],[]));n.rotate(F,y+l.PI,x);v!=1&&n.scale(F,[v,v,v]);a&&c.material.setDiffuseColor(c,a);n.translate(F,[0,g,0]);for(let I=0;I<z;I++)b.bonds_renderAsLines_3D?this.bondOrder==0?(c.shader.setMatrixUniforms(c,F),c.drawArrays(c.POINTS,0,1)):(n.scale(F,[1,k,1]),c.shader.setMatrixUniforms(c,F),c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems),n.scale(F,[1,1/k,1])):(c.shader.setMatrixUniforms(c,F),this.bondOrder==0?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,
0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)),n.translate(F,[0,f,0]);C%2!=0&&(n.scale(F,[1,A,1]),c.shader.setMatrixUniforms(c,F),b.bonds_renderAsLines_3D?this.bondOrder==0?c.drawArrays(c.POINTS,0,1):c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):this.bondOrder==0?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,
0),n.translate(F,[0,f*(1+G),0]),n.scale(F,[1,1/A,1]))}}}else{if(b.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:h=[-b.bonds_cylinderDiameter_3D];break;case 2:h=[-b.bonds_cylinderDiameter_3D,b.bonds_cylinderDiameter_3D];break;case 3:h=[-1.2*b.bonds_cylinderDiameter_3D,0,1.2*b.bonds_cylinderDiameter_3D]}this.bondOrder>1&&(p=[0,0,1],f=n.inverse(c.rotationMatrix,[]),n.multiplyVec3(f,p),p=d.cross(v,p,[]),d.normalize(p))}else switch(this.bondOrder){case 0:k*=.25;break;case .5:case 1.5:k*=.5}t&&
(g/=2);g=[k,g,k];for(let C=0,D=h.length;C<D;C++)v=n.set(r,[]),h[C]!==0&&n.translate(v,d.scale(p,h[C],[])),y!==0&&n.rotate(v,y,x),n.scale(v,g),m&&c.material.setDiffuseColor(c,m),c.shader.setMatrixUniforms(c,v),b.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems),t&&(n.set(t,v),h[C]!==0&&n.translate(v,d.scale(p,h[C],[])),n.rotate(v,y+l.PI,x),n.scale(v,g),a&&c.material.setDiffuseColor(c,
a),c.shader.setMatrixUniforms(c,v),b.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems))}}};q.renderHighlight=function(c,b){if(this.isSelected||this.isHover){this.styles&&(b=this.styles);this.styles&&(b=this.styles);let t=this.a1.distance3D(this.a2);if(t!==0){var f=b.bonds_cylinderDiameter_3D/1.2,g=n.translate(n.identity(),[this.a1.x,this.a1.y,this.a1.z]),k=[this.a2.x-this.a1.x,this.a2.y-
this.a1.y,this.a2.z-this.a1.z],m=[0,1,0],r=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(k=[0,0,1],this.a2.y<this.a1.y&&(r=l.PI)):(r=B.vec3AngleFrom(m,k),k=d.cross(m,k,[]));f=[f,t,f];r!==0&&n.rotate(g,r,k);n.scale(g,f);c.shader.setMatrixUniforms(c,g);c.material.setDiffuseColor(c,this.isHover?b.colorHover:b.colorSelect);c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems)}}};q.renderPicker=function(c,b){this.styles&&(b=this.styles);var f=this.a1.distance3D(this.a2);if(f!==
0){var g=b.bonds_cylinderDiameter_3D/2,k=n.translate(n.identity(),[this.a1.x,this.a1.y,this.a1.z]),m=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[0,1,0],t=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(r=[0,0,1],this.a2.y<this.a1.y&&(t=l.PI)):(t=B.vec3AngleFrom(r,m),r=d.cross(r,m,[]));var v=[0];if(b.bonds_showBondOrders_3D)if(b.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:v=[-b.bonds_cylinderDiameter_3D,b.bonds_cylinderDiameter_3D];break;case 3:v=[-1.2*b.bonds_cylinderDiameter_3D,
0,1.2*b.bonds_cylinderDiameter_3D]}if(this.bondOrder>1){var x=[0,0,1];let y=n.inverse(c.rotationMatrix,[]);n.multiplyVec3(y,x);x=d.cross(m,x,[]);d.normalize(x)}}else switch(this.bondOrder){case 1.5:case 2:g*=3;break;case 3:g*=3.4}else switch(this.bondOrder){case 0:g*=.25;break;case .5:case 1.5:g*=.5}f=[g,f,g];for(let y=0,a=v.length;y<a;y++)g=n.set(k,[]),v[y]!==0&&n.translate(g,d.scale(x,v[y],[])),t!==0&&n.rotate(g,t,r),n.scale(g,f),c.shader.setMatrixUniforms(c,g),b.bonds_renderAsLines_3D?c.drawArrays(c.LINES,
0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems)}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w){q.Ring=function(){this.atoms=[];this.bonds=[]};let u=q.Ring.prototype;u.center=w;u.setupBonds=function(){for(let l=0,n=this.bonds.length;l<n;l++)this.bonds[l].ring=this;this.center=this.getCenter()};u.getCenter=function(){let l=Infinity,n=Infinity,d=-Infinity,e=-Infinity;for(let c=0,b=this.atoms.length;c<b;c++)l=B.min(this.atoms[c].x,l),n=B.min(this.atoms[c].y,n),d=B.max(this.atoms[c].x,d),e=B.max(this.atoms[c].y,e);return new q.Point((d+l)/2,(e+n)/2)}})(ChemDoodle.structures,Math);
(function(q,B,w,u,l,n){w.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[]};let d=w.Molecule.prototype;d.findRings=!0;d.draw=function(e,c){this.styles&&(c=this.styles);if(c.atoms_display&&!c.atoms_circles_2D)for(let b=0,f=this.atoms.length;b<f;b++)this.atoms[b].draw(e,c);if(c.bonds_display)for(let b=0,f=this.bonds.length;b<f;b++)this.bonds[b].draw(e,c);if(c.atoms_display)for(let b=0,f=this.atoms.length;b<f;b++){let g=this.atoms[b];c.atoms_circles_2D&&g.draw(e,c);g.query&&g.query.draw(e,
c,g)}};d.render=function(e,c){this.styles&&(c=this.styles);var b=this.atoms.length>0&&this.atoms[0].hetatm!==n;if(b){if(c.macro_displayBonds){this.bonds.length>0&&(c.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(e.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(e,c.bonds_materialAmbientColor_3D,n,c.bonds_materialSpecularColor_3D,
c.bonds_materialShininess_3D));for(let m=0,r=this.bonds.length;m<r;m++){var f=this.bonds[m];!f.a1.hetatm&&(c.macro_atomToLigandDistance===-1||f.a1.closestDistance!==n&&c.macro_atomToLigandDistance>=f.a1.closestDistance&&c.macro_atomToLigandDistance>=f.a2.closestDistance)&&f.render(e,this.residueSpecs?this.residueSpecs:c)}}if(c.macro_displayAtoms){this.atoms.length>0&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,n,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));
for(let m=0,r=this.atoms.length;m<r;m++)f=this.atoms[m],!f.hetatm&&(c.macro_atomToLigandDistance===-1||f.closestDistance!==n&&c.macro_atomToLigandDistance>=f.closestDistance)&&f.render(e,this.residueSpecs?this.residueSpecs:c)}}if(c.bonds_display){f=[];var g=[];this.bonds.length>0&&(c.bonds_renderAsLines_3D?(e.lineWidth(c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(e,c.bonds_materialAmbientColor_3D,n,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));
for(let m=0,r=this.bonds.length;m<r;m++){let t=this.bonds[m];if(!b||t.a1.hetatm)c.bonds_showBondOrders_3D?t.bondOrder==0?g.push(t):t.bondOrder==.5?f.push(t):(t.bondOrder==1.5&&f.push(t),t.render(e,c)):t.render(e,c)}if(f.length>0){c.bonds_renderAsLines_3D||e.pillBuffer.bindBuffers(e);for(let m=0,r=f.length;m<r;m++)f[m].render(e,c,!0)}if(g.length>0){c.bonds_renderAsLines_3D||e.sphereBuffer.bindBuffers(e);for(let m=0,r=g.length;m<r;m++)g[m].render(e,c,!0)}}if(c.atoms_display){for(let m=0,r=this.atoms.length;m<
r;m++)f=this.atoms[m],f.bondNumber=0,f.renderAsStar=!1;for(let m=0,r=this.bonds.length;m<r;m++)f=this.bonds[m],f.a1.bondNumber++,f.a2.bondNumber++;this.atoms.length>0&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,n,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));f=[];for(let m=0,r=this.atoms.length;m<r;m++)if(g=this.atoms[m],!b||g.hetatm&&(c.macro_showWater||!g.isWater))c.atoms_nonBondedAsStars_3D&&g.bondNumber===0?(g.renderAsStar=!0,f.push(g)):
g.render(e,c);if(f.length>0){e.starBuffer.bindBuffers(e);for(let m=0,r=f.length;m<r;m++)f[m].render(e,c)}}if(this.chains){e.shader.setMatrixUniforms(e);if(c.proteins_displayRibbon){e.material.setTempColors(e,c.proteins_materialAmbientColor_3D,n,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);b=c.proteins_ribbonCartoonize?this.cartoons:this.ribbons;for(let m=0,r=b.length;m<r;m++)if(f=b[m],c.proteins_residueColor!=="none"){f.front.bindBuffers(e);g=c.proteins_residueColor==="rainbow";
for(let t=0,v=f.front.segments.length;t<v;t++)g&&e.material.setDiffuseColor(e,B.rainbowAt(t,v,c.macro_rainbowColors)),f.front.segments[t].render(e,c);f.back.bindBuffers(e);for(let t=0,v=f.back.segments.length;t<v;t++)g&&e.material.setDiffuseColor(e,B.rainbowAt(t,v,c.macro_rainbowColors)),f.back.segments[t].render(e,c)}else f.front.render(e,c),f.back.render(e,c)}if(c.proteins_displayPipePlank)for(let m=0,r=this.pipePlanks.length;m<r;m++)this.pipePlanks[m].render(e,c);if(c.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace=
{nodes:[],edges:[]};for(let m=0,r=this.chains.length;m<r;m++)if(b=this.chains[m],!(b.length>2&&u[b[2].name]&&u[b[2].name].aminoColor==="#BEA06E")&&b.length>0)for(let t=0,v=b.length-2;t<v;t++)f=b[t].cp1,f.chainColor=b.chainColor,this.alphaCarbonTrace.nodes.push(f),f=new w.Bond(b[t].cp1,b[t+1].cp1),f.residueName=b[t].name,f.chainColor=b.chainColor,this.alphaCarbonTrace.edges.push(f),t===b.length-3&&(f=b[t+1].cp1,f.chainColor=b.chainColor,this.alphaCarbonTrace.nodes.push(f))}if(this.alphaCarbonTrace.nodes.length>
0){b=new w.Styles;b.atoms_display=!0;b.bonds_display=!0;b.atoms_sphereDiameter_3D=c.proteins_backboneThickness;b.bonds_cylinderDiameter_3D=c.proteins_backboneThickness;b.bonds_splitColor=!1;b.atoms_color=c.proteins_backboneColor;b.bonds_color=c.proteins_backboneColor;b.atoms_useVDWDiameters_3D=!1;e.material.setTempColors(e,c.proteins_materialAmbientColor_3D,n,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);e.material.setDiffuseColor(e,c.proteins_backboneColor);for(let m=0,r=this.alphaCarbonTrace.nodes.length;m<
r;m++)f=this.alphaCarbonTrace.nodes[m],c.macro_colorByChain&&(b.atoms_color=f.chainColor),e.sphereBuffer.bindBuffers(e),f.render(e,b);for(let m=0,r=this.alphaCarbonTrace.edges.length;m<r;m++){f=this.alphaCarbonTrace.edges[m];var k=void 0;g=u[f.residueName]?u[f.residueName]:u["*"];c.macro_colorByChain?k=f.chainColor:c.proteins_residueColor==="shapely"?k=g.shapelyColor:c.proteins_residueColor==="amino"?k=g.aminoColor:c.proteins_residueColor==="polarity"?k=g.polar?"#C10000":"#FFFFFF":c.proteins_residueColor===
"acidity"?k=g.acidity===1?"#0000FF":g.acidity===-1?"#FF0000":g.polar?"#FFFFFF":"#773300":c.proteins_residueColor==="rainbow"&&(k=B.rainbowAt(m,r,c.macro_rainbowColors));k&&(b.bonds_color=k);e.cylinderBuffer.bindBuffers(e);f.render(e,b)}}}if(c.nucleics_display){e.material.setTempColors(e,c.nucleics_materialAmbientColor_3D,n,c.nucleics_materialSpecularColor_3D,c.nucleics_materialShininess_3D);for(let m=0,r=this.tubes.length;m<r;m++)e.shader.setMatrixUniforms(e),this.tubes[m].render(e,c)}}if(c.atoms_display){k=
!1;for(let m=0,r=this.atoms.length;m<r;m++)if(b=this.atoms[m],b.isHover||b.isSelected){k=!0;break}if(!k)for(let m=0,r=this.bonds.length;m<r;m++)if(b=this.bonds[m],b.isHover||b.isSelected){k=!0;break}if(k){e.sphereBuffer.bindBuffers(e);e.blendFunc(e.SRC_ALPHA,e.ONE);e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,n,"#000000",0);e.enable(e.BLEND);e.depthMask(!1);e.material.setAlpha(e,.4);e.sphereBuffer.bindBuffers(e);for(let m=0,r=this.atoms.length;m<r;m++)k=this.atoms[m],(k.isHover||k.isSelected)&&
k.renderHighlight(e,c);e.cylinderBuffer.bindBuffers(e);for(let m=0,r=this.bonds.length;m<r;m++)k=this.bonds[m],(k.isHover||k.isSelected)&&k.renderHighlight(e,c);e.depthMask(!0);e.disable(e.BLEND);e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}};d.renderPickFrame=function(e,c,b,f,g){this.styles&&(c=this.styles);var k=this.atoms.length>0&&this.atoms[0].hetatm!==n;if(g&&c.bonds_display){this.bonds.length>0&&(c.bonds_renderAsLines_3D?(e.lineWidth(c.bonds_width_2D),
e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e));for(let m=0,r=this.bonds.length;m<r;m++)if(g=this.bonds[m],!k||g.a1.hetatm)e.material.setDiffuseColor(e,B.idx2color(b.length)),g.renderPicker(e,c),b.push(g)}if(f&&c.atoms_display){for(let m=0,r=this.atoms.length;m<r;m++)f=this.atoms[m],f.bondNumber=0,f.renderAsStar=!1;for(let m=0,r=this.bonds.length;m<r;m++)f=this.bonds[m],f.a1.bondNumber++,f.a2.bondNumber++;this.atoms.length>0&&e.sphereBuffer.bindBuffers(e);f=[];for(let m=0,r=this.atoms.length;m<
r;m++)if(g=this.atoms[m],!k||g.hetatm&&(c.macro_showWater||!g.isWater))c.atoms_nonBondedAsStars_3D&&g.bondNumber===0?(g.renderAsStar=!0,f.push(g)):(e.material.setDiffuseColor(e,B.idx2color(b.length)),g.render(e,c,!0),b.push(g));if(f.length>0){e.starBuffer.bindBuffers(e);for(let m=0,r=f.length;m<r;m++)k=f[m],e.material.setDiffuseColor(e,B.idx2color(b.length)),k.render(e,c,!0),b.push(k)}}};d.getCenter3D=function(){if(this.atoms.length===1)return new w.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);
let e=Infinity,c=Infinity,b=Infinity,f=-Infinity,g=-Infinity,k=-Infinity;if(this.chains)for(let m=0,r=this.chains.length;m<r;m++){let t=this.chains[m];for(let v=0,x=t.length;v<x;v++){let y=t[v];e=l.min(y.cp1.x,y.cp2.x,e);c=l.min(y.cp1.y,y.cp2.y,c);b=l.min(y.cp1.z,y.cp2.z,b);f=l.max(y.cp1.x,y.cp2.x,f);g=l.max(y.cp1.y,y.cp2.y,g);k=l.max(y.cp1.z,y.cp2.z,k)}}for(let m=0,r=this.atoms.length;m<r;m++)e=l.min(this.atoms[m].x,e),c=l.min(this.atoms[m].y,c),b=l.min(this.atoms[m].z,b),f=l.max(this.atoms[m].x,
f),g=l.max(this.atoms[m].y,g),k=l.max(this.atoms[m].z,k);return new w.Atom("C",(f+e)/2,(g+c)/2,(k+b)/2)};d.getCenter=function(){if(this.atoms.length===1)return new w.Point(this.atoms[0].x,this.atoms[0].y);let e=Infinity,c=Infinity,b=-Infinity,f=-Infinity;for(let g=0,k=this.atoms.length;g<k;g++)e=l.min(this.atoms[g].x,e),c=l.min(this.atoms[g].y,c),b=l.max(this.atoms[g].x,b),f=l.max(this.atoms[g].y,f);return new w.Point((b+e)/2,(f+c)/2)};d.getDimension=function(){if(this.atoms.length===1)return new w.Point(0,
0);let e=Infinity,c=Infinity,b=-Infinity,f=-Infinity;if(this.chains){for(let g=0,k=this.chains.length;g<k;g++){let m=this.chains[g];for(let r=0,t=m.length;r<t;r++){let v=m[r];e=l.min(v.cp1.x,v.cp2.x,e);c=l.min(v.cp1.y,v.cp2.y,c);b=l.max(v.cp1.x,v.cp2.x,b);f=l.max(v.cp1.y,v.cp2.y,f)}}e-=30;c-=30;b+=30;f+=30}for(let g=0,k=this.atoms.length;g<k;g++)e=l.min(this.atoms[g].x,e),c=l.min(this.atoms[g].y,c),b=l.max(this.atoms[g].x,b),f=l.max(this.atoms[g].y,f);return new w.Point(b-e,f-c)};d.check=function(e){if(e&&
this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!==this.fjNumCache){this.rings=(new q.informatics.SSSRFinder(this)).rings;for(let b=0,f=this.bonds.length;b<f;b++)this.bonds[b].ring=n;for(let b=0,f=this.rings.length;b<f;b++)this.rings[b].setupBonds()}else for(let b=0,f=this.rings.length;b<f;b++){var c=this.rings[b];c.center=c.getCenter()}for(let b=0,f=this.atoms.length;b<f;b++)if(this.atoms[b].isLone=!1,this.atoms[b].label==="C"){c=0;for(let g=0,k=this.bonds.length;g<k;g++)this.bonds[g].a1!==
this.atoms[b]&&this.bonds[g].a2!==this.atoms[b]||c++;c===0&&(this.atoms[b].isLone=!0)}c=!1;for(let b=0,f=this.atoms.length;b<f;b++)this.atoms[b].z!==0&&(c=!0);c&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData();this.atomNumCache=this.atoms.length;this.bondNumCache=this.bonds.length;this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!e};d.getAngles=function(e){let c=[];for(let b=0,f=this.bonds.length;b<f;b++)this.bonds[b].contains(e)&&c.push(e.angle(this.bonds[b].getNeighbor(e)));
c.sort(function(b,f){return b-f});return c};d.getCoordinationNumber=function(e){let c=0;for(let b=0,f=e.length;b<f;b++)c+=e[b].bondOrder;return c};d.getBonds=function(e){let c=[];for(let b=0,f=this.bonds.length;b<f;b++)this.bonds[b].contains(e)&&c.push(this.bonds[b]);return c};d.sortAtomsByZ=function(){for(let e=1,c=this.atoms.length;e<c;e++){let b=e;for(;b>0&&this.atoms[b].z<this.atoms[b-1].z;){let f=this.atoms[b];this.atoms[b]=this.atoms[b-1];this.atoms[b-1]=f;b--}}};d.sortBondsByZ=function(){for(let e=
1,c=this.bonds.length;e<c;e++){let b=e;for(;b>0&&this.bonds[b].a1.z+this.bonds[b].a2.z<this.bonds[b-1].a1.z+this.bonds[b-1].a2.z;){let f=this.bonds[b];this.bonds[b]=this.bonds[b-1];this.bonds[b-1]=f;b--}}};d.setupMetaData=function(){let e=this.getCenter();for(let c=0,b=this.atoms.length;c<b;c++){let f=this.atoms[c];f.bonds=this.getBonds(f);f.angles=this.getAngles(f);f.isHidden=f.bonds.length===2&&l.abs(l.abs(f.angles[1]-f.angles[0])-l.PI)<l.PI/30&&f.bonds[0].bondOrder===f.bonds[1].bondOrder;let g=
B.angleBetweenLargest(f.angles);f.angleOfLeastInterference=g.angle%(l.PI*2);f.largestAngle=g.largest;f.coordinationNumber=this.getCoordinationNumber(f.bonds);f.bondNumber=f.bonds.length;f.molCenter=e}for(let c=0,b=this.bonds.length;c<b;c++)this.bonds[c].molCenter=e};d.scaleToAverageBondLength=function(e){let c=this.getAverageBondLength();if(c!==0){e/=c;for(let b=0,f=this.atoms.length;b<f;b++)this.atoms[b].x*=e,this.atoms[b].y*=e}};d.getAverageBondLength=function(){if(this.bonds.length===0)return 0;
let e=0;for(let c=0,b=this.bonds.length;c<b;c++)e+=this.bonds[c].getLength();return e/=this.bonds.length};d.getBounds=function(){let e=new B.Bounds;for(let c=0,b=this.atoms.length;c<b;c++)e.expand(this.atoms[c].getBounds());if(this.chains){for(let c=0,b=this.chains.length;c<b;c++){let f=this.chains[c];for(let g=0,k=f.length;g<k;g++){let m=f[g];e.expand(m.cp1.x,m.cp1.y);e.expand(m.cp2.x,m.cp2.y)}}e.minX-=30;e.minY-=30;e.maxX+=30;e.maxY+=30}return e};d.getBounds3D=function(){let e=new B.Bounds;for(let c=
0,b=this.atoms.length;c<b;c++)e.expand(this.atoms[c].getBounds3D());if(this.chains)for(let c=0,b=this.chains.length;c<b;c++){let f=this.chains[c];for(let g=0,k=f.length;g<k;g++){let m=f[g];e.expand3D(m.cp1.x,m.cp1.y,m.cp1.z);e.expand3D(m.cp2.x,m.cp2.y,m.cp2.z)}}return e};d.getAtomGroup=function(e){let c=!1;for(let k=0,m=this.atoms.length;k<m;k++)this.atoms[k].visited=!1;for(let k=0,m=this.bonds.length;k<m;k++){var b=this.bonds[k];!c&&b.contains(e)&&b.ring!==n&&(c=!0)}if(!c)return n;b=[e];e.visited=
!0;let f=new w.Queue;for(f.enqueue(e);!f.isEmpty();){e=f.dequeue();for(let k=0,m=this.bonds.length;k<m;k++){var g=this.bonds[k];g.contains(e)&&c===(g.ring!==n)&&(g=g.getNeighbor(e),g.visited||(g.visited=!0,b.push(g),f.enqueue(g)))}}return b};d.getBondGroup=function(e){let c=e.ring!==n;var b=!1;for(let g=0,k=this.bonds.length;g<k;g++){var f=this.bonds[g];f===e&&(b=!0);f.visited=!1}if(!b)return n;b=[e];e.visited=!0;f=new w.Queue;for(f.enqueue(e);!f.isEmpty();){e=f.dequeue();for(let g=0,k=this.bonds.length;g<
k;g++){let m=this.bonds[g];m.visited||m.a1!==e.a1&&m.a2!==e.a1&&m.a1!==e.a2&&m.a2!==e.a2||m.ring!==n!==c||(m.visited=!0,b.push(m),f.enqueue(m))}}return b}})(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);(function(q,B){q.Reaction=function(){};q.Reaction.prototype.resolve=function(w,u){if(w&&u){var l={reactants:[],products:[]};w=w.getPoints();if(!w)return l.reactants.push(...u),l;for(let n=0,d=u.length;n<d;n++){let e=u[n];e.getCenter().x<w[1].x?l.reactants.push(e):l.products.push(e)}return l}}})(ChemDoodle.structures);
(function(q,B,w,u,l){let n,d=-1;q.Residue=function(e){this.resSeq=e};l=q.Residue.prototype;l.setup=function(e,c){this.horizontalResolution=c;let b=[e.x-this.cp1.x,e.y-this.cp1.y,e.z-this.cp1.z];var f=u.cross(b,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=u.cross(f,b,[]);u.normalize(f);u.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];e=[(e.x+this.cp1.x)/2,(e.y+this.cp1.y)/2,(e.z+this.cp1.z)/2];this.helix&&(u.scale(f,1.5),u.add(e,f));this.guidePointsSmall[0]=
new q.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<c;f++)this.guidePointsSmall[f]=new q.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/c,this.guidePointsSmall[0].y+this.D[1]*f/c,this.guidePointsSmall[0].z+this.D[2]*f/c);u.scale(this.D,4);this.guidePointsLarge[0]=new q.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<c;f++)this.guidePointsLarge[f]=new q.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/c,this.guidePointsLarge[0].y+this.D[1]*f/c,this.guidePointsLarge[0].z+
this.D[2]*f/c)};l.getGuidePointSet=function(e){if(e===0)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(e===1)return this.guidePointsSmall;if(e===2)return this.guidePointsLarge};l.computeLineSegments=function(e,c,b,f,g){this.setVerticalResolution(g);this.split=b.helix!==this.helix||b.sheet!==this.sheet;this.lineSegments=this.innerCompute(0,e,c,b,!1,g);f&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,e,c,b,!0,g))};l.innerCompute=function(e,c,b,
f,g,k){let m=[];var r=this.getGuidePointSet(e);c=c.getGuidePointSet(e);b=b.getGuidePointSet(e);e=f.getGuidePointSet(e);for(let t=0,v=r.length;t<v;t++){f=w.multiply([c[t].x,c[t].y,c[t].z,1,b[t].x,b[t].y,b[t].z,1,r[t].x,r[t].y,r[t].z,1,e[t].x,e[t].y,e[t].z,1],n,[]);let x=[];for(let y=0;y<k;y++){for(let a=3;a>0;a--)for(let h=0;h<4;h++)f[a*4+h]+=f[(a-1)*4+h];x[y]=new q.Atom("",f[12]/f[15],f[13]/f[15],f[14]/f[15])}m[t]=x}if(g&&this.arrow)for(let t=0,v=k;t<v;t++){g=1.5-1.3*t/k;r=B.floor(this.horizontalResolution/
2);c=m[r];for(let x=0,y=m.length;x<y;x++)x!==r&&(b=c[t],e=m[x][t],f=[e.x-b.x,e.y-b.y,e.z-b.z],u.scale(f,g),e.x=b.x+f[0],e.y=b.y+f[1],e.z=b.z+f[2])}return m};l.setVerticalResolution=function(e){if(e!==d){let c=e*e,b=e*e*e;n=w.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/b,0,0,0,6/b,2/c,0,0,1/b,1/c,1/e,0,0,0,0,1],[]);d=e}}})(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w,u,l){B.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}};let n=B.Spectrum.prototype;n.title=l;n.xUnit=l;n.yUnit=l;n.continuous=!0;n.integrationSensitivity=.01;n.draw=function(d,e,c,b){this.styles&&(e=this.styles);let f=5,g=0,k=0;d.fillStyle=e.text_color;d.textAlign="center";d.textBaseline="alphabetic";d.font=q.getFontString(e.text_font_size,e.text_font_families);this.xUnit&&
(k+=e.text_font_size,d.fillText(this.xUnit,c/2,b-2));this.yUnit&&e.plots_showYAxis&&(g+=e.text_font_size,d.save(),d.translate(e.text_font_size,b/2),d.rotate(-u.PI/2),d.fillText(this.yUnit,0,0),d.restore());this.title&&(f+=e.text_font_size,d.fillText(this.title,c/2,e.text_font_size));d.lineCap="square";k+=5+e.text_font_size;e.plots_showYAxis&&(g+=5+d.measureText("1000").width);e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=e.plots_gridLineWidth,d.strokeRect(g,f,c-g,b-k-f));d.textAlign=
"center";d.textBaseline="top";for(var m=this.maxX-this.minX,r=m/100,t=.001;t<r||m/t>25;)t*=10;m=0;r=e.plots_flipXAxis?c:0;for(var v=u.round(this.minX/t)*t;v<=this.maxX;v+=t/2){var x=this.getTransformedX(v,e,c,g);if(x>g)if(d.strokeStyle="black",d.lineWidth=1,m%2===0){d.beginPath();d.moveTo(x,b-k);d.lineTo(x,b-k+2);d.stroke();let y=v.toFixed(5);for(;y.charAt(y.length-1)==="0";)y=y.substring(0,y.length-1);y.charAt(y.length-1)==="."&&(y=y.substring(0,y.length-1));let a=d.measureText(y).width;e.plots_flipXAxis&&
(a*=-1);let h=x-a/2;if(e.plots_flipXAxis?h<r:h>r)d.fillText(y,x,b-k+2),r=x+a/2;e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=e.plots_gridLineWidth,d.beginPath(),d.moveTo(x,b-k),d.lineTo(x,f),d.stroke())}else d.beginPath(),d.moveTo(x,b-k),d.lineTo(x,b-k+2),d.stroke();m++}if(e.plots_showYAxis||e.plots_showGrid)for(t=1/e.scale,d.textAlign="right",d.textBaseline="middle",m=0;m<=10;m++)if(v=t/10*m,r=f+(b-k-f)*(1-v*e.scale),e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=
e.plots_gridLineWidth,d.beginPath(),d.moveTo(g,r),d.lineTo(c,r),d.stroke()),e.plots_showYAxis){d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(g,r);d.lineTo(g-3,r);d.stroke();x=v*100;v=u.max(0,3-u.floor(x).toString().length);x=x.toFixed(v);if(v>0)for(;x.charAt(x.length-1)==="0";)x=x.substring(0,x.length-1);x.charAt(x.length-1)==="."&&(x=x.substring(0,x.length-1));d.fillText(x,g-3,r)}d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(c,b-k);d.lineTo(g,b-k);e.plots_showYAxis&&d.lineTo(g,
f);d.stroke();if(this.dataDisplay.length>0){d.textAlign="left";d.textBaseline="top";t=0;for(let y=0,a=this.dataDisplay.length;y<a;y++)if(this.dataDisplay[y].value)d.fillText([this.dataDisplay[y].display,": ",this.dataDisplay[y].value].join(""),g+10,f+10+t*(e.text_font_size+5)),t++;else if(this.dataDisplay[y].tag)for(let h=0,p=this.metadata.length;h<p;h++)if(this.metadata[h].startsWith(this.dataDisplay[y].tag)){m=this.metadata[h];this.dataDisplay[y].display&&(m=this.metadata[h].indexOf("\x3d"),m=[this.dataDisplay[y].display,
": ",m>-1?this.metadata[h].substring(m+2):this.metadata[h]].join(""));d.fillText(m,g+10,f+10+t*(e.text_font_size+5));t++;break}}this.drawPlot(d,e,c,b,f,g,k);this.memory.offsetTop=f;this.memory.offsetLeft=g;this.memory.offsetBottom=k;this.memory.flipXAxis=e.plots_flipXAxis;this.memory.scale=e.scale;this.memory.width=c;this.memory.height=b};n.drawPlot=function(d,e,c,b,f,g,k){this.styles&&(e=this.styles);d.strokeStyle=e.plots_color;d.lineWidth=e.plots_width;let m=[];d.save();d.rect(g,f,c-g,b-k-f);d.clip();
d.beginPath();if(this.continuous){var r=!1,t=0,v=!1;for(let x=0,y=this.data.length;x<y;x++){let a=this.getTransformedX(this.data[x].x,e,c,g),h;x<y&&!r&&this.data[x+1]&&(h=this.getTransformedX(this.data[x+1].x,e,c,g));if(a>=g&&a<c||h!==l&&h>=g&&h<c){let p=this.getTransformedY(this.data[x].y,e,b,k,f);e.plots_showIntegration&&u.abs(this.data[x].y)>this.integrationSensitivity&&m.push(new B.Point(this.data[x].x,this.data[x].y));r||(d.moveTo(a,p),r=!0);d.lineTo(a,p);t++;t%1E3===0&&(d.stroke(),d.beginPath(),
d.moveTo(a,p));if(v)break}else r&&(v=!0)}}else for(let x=0,y=this.data.length;x<y;x++)r=this.getTransformedX(this.data[x].x,e,c,g),r>=g&&r<c&&(d.moveTo(r,b-k),d.lineTo(r,this.getTransformedY(this.data[x].y,e,b,k,f)));d.stroke();if(e.plots_showIntegration&&m.length>1){d.strokeStyle=e.plots_integrationColor;d.lineWidth=e.plots_integrationLineWidth;d.beginPath();r=m[1].x>m[0].x;if(this.flipXAxis&&!r||!this.flipXAxis&&r){for(r=m.length-2;r>=0;r--)m[r].y+=m[r+1].y;r=m[0].y}else{for(let x=1,y=m.length;x<
y;x++)m[x].y+=m[x-1].y;r=m[m.length-1].y}for(let x=0,y=m.length;x<y;x++)t=this.getTransformedX(m[x].x,e,c,g),v=this.getTransformedY(m[x].y/e.scale/r,e,b,k,f),x===0?d.moveTo(t,v):d.lineTo(t,v);d.stroke()}d.restore()};n.getTransformedY=function(d,e,c,b,f){return f+(c-b-f)*(1-d*e.scale)};n.getInverseTransformedY=function(d){return(1-(d-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100};n.getTransformedX=function(d,e,c,b){d=b+(d-this.minX)/
(this.maxX-this.minX)*(c-b);e.plots_flipXAxis&&(d=c+b-d);return d};n.getInverseTransformedX=function(d){this.memory.flipXAxis&&(d=this.memory.width+this.memory.offsetLeft-d);return(d-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX};n.setup=function(){let d=Number.MAX_VALUE,e=Number.MIN_VALUE,c=Number.MIN_VALUE;for(let b=0,f=this.data.length;b<f;b++)d=u.min(d,this.data[b].x),e=u.max(e,this.data[b].x),c=u.max(c,this.data[b].y);this.continuous?(this.minX=
d,this.maxX=e):(this.minX=d-1,this.maxX=e+1);for(let b=0,f=this.data.length;b<f;b++)this.data[b].y/=c};n.zoom=function(d,e,c,b){d=this.getInverseTransformedX(d);e=this.getInverseTransformedX(e);this.minX=u.min(d,e);this.maxX=u.max(d,e);if(b){b=Number.MIN_VALUE;for(let f=0,g=this.data.length;f<g;f++)w.isBetween(this.data[f].x,this.minX,this.maxX)&&(b=u.max(b,this.data[f].y));return 1/b}};n.translate=function(d,e){d=d/(e-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=
d;this.maxX+=d};n.alertMetadata=function(){alert(this.metadata.join("\n"))};n.getInternalCoordinates=function(d,e){return new ChemDoodle.structures.Point(this.getInverseTransformedX(d),this.getInverseTransformedY(e))};n.getClosestPlotInternalCoordinates=function(d){var e=this.getInverseTransformedX(d-1);d=this.getInverseTransformedX(d+1);if(e>d){var c=e;e=d;d=c}c=-1;let b=-Infinity,f=!1;for(let g=0,k=this.data.length;g<k;g++){let m=this.data[g];if(w.isBetween(m.x,e,d))m.y>b&&(f=!0,b=m.y,c=g);else if(f)break}if(c===
-1)return l;e=this.data[c];return new ChemDoodle.structures.Point(e.x,e.y*100)};n.getClosestPeakInternalCoordinates=function(d){var e=this.getInverseTransformedX(d);d=0;var c=Infinity;for(let g=0,k=this.data.length;g<k;g++){var b=u.abs(this.data[g].x-e);if(b<=c)c=b,d=g;else break}c=e=d;b=this.data[d].y;var f=this.data[d].y;for(let g=d+1,k=this.data.length;g<k;g++)if(this.data[g].y+.05>f)f=this.data[g].y,c=g;else break;for(f=d-1;f>=0;f--)if(this.data[f].y+.05>b)b=this.data[f].y,e=f;else break;d=this.data[e-
d>c-d?c:e];return new ChemDoodle.structures.Point(d.x,d.y*100)}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math);
(function(q,B,w,u){B._Shape=function(){};B=B._Shape.prototype;B.drawDecorations=function(l,n){if(this.isHover){let d=this.getPoints();for(let e=0,c=d.length;e<c;e++){let b=d[e];this.drawAnchor(l,n,b,b===this.hoverPoint)}}};B.getBounds=function(){let l=new q.Bounds,n=this.getPoints();for(let d=0,e=n.length;d<e;d++){let c=n[d];l.expand(c.x,c.y)}return l};B.drawAnchor=function(l,n,d,e){l.save();l.translate(d.x,d.y);l.rotate(w.PI/4);l.scale(1/n.scale,1/n.scale);l.beginPath();l.moveTo(-4,-4);l.lineTo(4,
-4);l.lineTo(4,4);l.lineTo(-4,4);l.closePath();l.fillStyle=e?n.colorHover:"white";l.fill();l.beginPath();l.moveTo(-4,-2);l.lineTo(-4,-4);l.lineTo(-2,-4);l.moveTo(2,-4);l.lineTo(4,-4);l.lineTo(4,-2);l.moveTo(4,2);l.lineTo(4,4);l.lineTo(2,4);l.moveTo(-2,4);l.lineTo(-4,4);l.lineTo(-4,2);l.moveTo(-4,-2);l.strokeStyle="rgba(0,0,0,.2)";l.lineWidth=5;l.stroke();l.strokeStyle="blue";l.lineWidth=1;l.stroke();l.restore()}})(ChemDoodle.math,ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l,n){u.AtomMapping=function(d,e){this.o1=d;this.o2=e;this.label="0";this.error=!1};B=u.AtomMapping.prototype=new u._Shape;B.drawDecorations=function(d,e){if(this.isHover||this.isSelected)d.strokeStyle=this.isHover?e.colorHover:e.colorSelect,d.lineWidth=1,d.beginPath(),d.moveTo(this.o1.x,this.o1.y),d.lineTo(this.o2.x,this.o2.y),d.setLineDash([2]),d.stroke(),d.setLineDash([])};B.draw=function(d,e){if(this.o1&&this.o2){this.x1=this.o1.x+14*l.cos(this.o1.angleOfLeastInterference);this.y1=
this.o1.y-14*l.sin(this.o1.angleOfLeastInterference);this.x2=this.o2.x+14*l.cos(this.o2.angleOfLeastInterference);this.y2=this.o2.y-14*l.sin(this.o2.angleOfLeastInterference);d.font=q.getFontString(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic);let c=this.label,b=d.measureText(c).width;this.isLassoed&&(d.fillStyle=e.colorHover,d.fillRect(this.x1-b/2-3,this.y1-e.text_font_size/2-3,b+6,e.text_font_size+6),d.fillRect(this.x2-b/2-3,this.y2-e.text_font_size/2-3,b+6,e.text_font_size+
6));let f=this.error?e.colorError:e.shapes_color;if(this.isHover||this.isSelected)f=this.isHover?e.colorHover:e.colorSelect;d.fillStyle=f;d.fillRect(this.x1-b/2-1,this.y1-e.text_font_size/2-1,b+2,e.text_font_size+2);d.fillRect(this.x2-b/2-1,this.y2-e.text_font_size/2-1,b+2,e.text_font_size+2);d.textAlign="center";d.textBaseline="middle";d.fillStyle=e.backgroundColor;d.fillText(c,this.x1,this.y1);d.fillText(c,this.x2,this.y2)}};B.getPoints=function(){return[new w.Point(this.x1,this.y1),new w.Point(this.x2,
this.y2)]};B.isOver=function(d,e){return this.x1?d.distance({x:this.x1,y:this.y1})<e||d.distance({x:this.x2,y:this.y2})<e:!1}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l,n){u.Bracket=function(d,e){this.p1=d?d:new w.Point;this.p2=e?e:new w.Point};u=u.Bracket.prototype=new u._Shape;u.charge=0;u.mult=0;u.repeat=0;u.draw=function(d,e){let c=l.min(this.p1.x,this.p2.x),b=l.max(this.p1.x,this.p2.x),f=l.min(this.p1.y,this.p2.y),g=l.max(this.p1.y,this.p2.y),k=g-f;var m=k/10;d.beginPath();d.moveTo(c+m,f);d.lineTo(c,f);d.lineTo(c,g);d.lineTo(c+m,g);d.moveTo(b-m,g);d.lineTo(b,g);d.lineTo(b,f);d.lineTo(b-m,f);this.isLassoed&&(m=d.createLinearGradient(this.p1.x,
this.p1.y,this.p2.x,this.p2.y),m.addColorStop(0,"rgba(212, 99, 0, 0)"),m.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),m.addColorStop(1,"rgba(212, 99, 0, 0)"),d.lineWidth=e.shapes_lineWidth+5,d.strokeStyle=m,d.lineJoin="miter",d.lineCap="square",d.stroke());d.strokeStyle=e.shapes_color;d.lineWidth=e.shapes_lineWidth;d.lineJoin="miter";d.lineCap="butt";d.stroke();this.charge!==0&&(d.fillStyle=e.text_color,d.textAlign="left",d.textBaseline="alphabetic",d.font=q.getFontString(e.text_font_size,e.text_font_families),
m=this.charge.toFixed(0),m=m==="1"?"+":m==="-1"?"\u2013":m.startsWith("-")?m.substring(1)+"\u2013":m+"+",d.fillText(m,b+5,f+5));this.mult!==0&&(d.fillStyle=e.text_color,d.textAlign="right",d.textBaseline="middle",d.font=q.getFontString(e.text_font_size,e.text_font_families),d.fillText(this.mult.toFixed(0),c-5,f+k/2));this.repeat!==0&&(d.fillStyle=e.text_color,d.textAlign="left",d.textBaseline="top",d.font=q.getFontString(e.text_font_size,e.text_font_families),e=this.repeat.toFixed(0),d.fillText(e,
b+5,g-5))};u.getPoints=function(){return[this.p1,this.p2]};u.isOver=function(d,e){return B.isBetween(d.x,this.p1.x,this.p2.x)&&B.isBetween(d.y,this.p1.y,this.p2.y)}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l,n,d){l.RepeatUnit=function(c,b){this.b1=c;this.b2=b;this.n1=1;this.n2=4;this.contents=[];this.ps=[]};B=l.RepeatUnit.prototype=new l._Shape;B.drawDecorations=function(c,b){if(this.isHover)for(let f=0,g=this.contents.length;f<g;f++){b=this.contents[f];let k=c.createRadialGradient(b.x-1,b.y-1,0,b.x,b.y,7);k.addColorStop(0,"rgba(212, 99, 0, 0)");k.addColorStop(.7,"rgba(212, 99, 0, 0.8)");c.fillStyle=k;c.beginPath();c.arc(b.x,b.y,5,0,n.PI*2,!1);c.fill()}};let e=function(c,b,f,g,k){b=
[];var m=k.length>0?k.indexOf(f.a1)===-1?f.a2:f.a1:f.a1.distance(g.getCenter())<f.a2.distance(g.getCenter())?f.a1:f.a2;g=m.angle(f.getNeighbor(m));var r=g+n.PI/2;f=f.getLength()/(k.length>1?4:2);k=m.x+f*n.cos(g);m=m.y-f*n.sin(g);var t=10*n.cos(r),v=10*n.sin(r);r=k+t;f=m-v;k-=t;m+=v;v=-4*n.cos(g);var x=-4*n.sin(g);g=r+v;t=f-x;v=k+v;x=m-x;c.beginPath();c.moveTo(g,t);c.lineTo(r,f);c.lineTo(k,m);c.lineTo(v,x);c.stroke();b.push(new u.Point(r,f));b.push(new u.Point(k,m));return b};B.draw=function(c,b){if(this.b1&&
this.b2){var f=this.error?b.colorError:b.shapes_color;if(this.isHover||this.isSelected)f=this.isHover?b.colorHover:b.colorSelect;c.strokeStyle=f;c.fillStyle=c.strokeStyle;c.lineWidth=b.shapes_lineWidth;c.lineJoin="miter";c.lineCap="butt";f=e(c,b,this.b1,this.b2,this.contents);let g=e(c,b,this.b2,this.b1,this.contents);this.ps=f.concat(g);this.b1.getCenter().x>this.b2.getCenter().x?this.textPos=this.ps[0].x>this.ps[1].x+5?this.ps[0]:this.ps[1]:this.textPos=this.ps[2].x>this.ps[3].x+5?this.ps[2]:this.ps[3];
!this.error&&this.contents.length>0&&(c.font=q.getFontString(b.text_font_size,b.text_font_families,b.text_font_bold,b.text_font_italic),c.fillStyle=this.isHover?b.colorHover:b.text_color,c.textAlign="left",c.textBaseline="bottom",c.fillText(this.n1+"-"+this.n2,this.textPos.x+2,this.textPos.y+2))}};B.getPoints=function(){return this.ps};B.isOver=function(c,b){return!1};B.setContents=function(c){this.contents=[];let b=c.getMoleculeByAtom(this.b1.a1);c=c.getMoleculeByAtom(this.b2.a1);if(b&&b===c){var f=
c=0;for(let m=0,r=b.rings.length;m<r;m++){var g=b.rings[m];for(let t=0,v=g.bonds.length;t<v;t++){var k=g.bonds[t];k===this.b1?c++:k===this.b2&&f++}}c=c===1&&f===1&&this.b1.ring===this.b2.ring;this.contents.flippable=c;if(this.b1.ring===d&&this.b2.ring===d||c)for(let m=0,r=b.atoms.length;m<r;m++){k=g=f=!1;for(let x=0,y=b.bonds.length;x<y;x++)b.bonds[x].visited=!1;let t=new u.Queue,v=b.atoms[m];for(t.enqueue(v);!(t.isEmpty()||f&&g);){let x=t.dequeue();c&&(!this.flip&&x===this.b1.a1||this.flip&&x===
this.b1.a2)&&(k=!0);for(let y=0,a=b.bonds.length;y<a;y++){let h=b.bonds[y];if(h.a1===x||h.a2===x)h===this.b1?f=!0:h===this.b2?g=!0:h.visited||(h.visited=!0,t.enqueue(h.getNeighbor(x)))}}f&&g&&(!c||k)&&this.contents.push(v)}}}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l,n){u.Line=function(e,c){this.p1=e?e:new w.Point;this.p2=c?c:new w.Point;this.reactants=[];this.products=[]};u.Line.ARROW_SYNTHETIC="synthetic";u.Line.ARROW_RETROSYNTHETIC="retrosynthetic";u.Line.ARROW_RESONANCE="resonance";u.Line.ARROW_EQUILIBRIUM="equilibrium";let d=u.Line.prototype=new u._Shape;d.arrowType=n;d.topText=n;d.bottomText=n;d.draw=function(e,c){if(this.isLassoed){var b=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);b.addColorStop(0,"rgba(212, 99, 0, 0)");
b.addColorStop(.5,"rgba(212, 99, 0, 0.8)");b.addColorStop(1,"rgba(212, 99, 0, 0)");var f=this.p1.angle(this.p2)+l.PI/2,g=l.cos(f),k=l.sin(f);f=this.p1.x-g*2.5;var m=this.p1.y+k*2.5,r=this.p1.x+g*2.5,t=this.p1.y-k*2.5,v=this.p2.x+g*2.5,x=this.p2.y-k*2.5;g=this.p2.x-g*2.5;k=this.p2.y+k*2.5;e.fillStyle=b;e.beginPath();e.moveTo(f,m);e.lineTo(r,t);e.lineTo(v,x);e.lineTo(g,k);e.closePath();e.fill()}e.strokeStyle=c.shapes_color;e.fillStyle=c.shapes_color;e.lineWidth=c.shapes_lineWidth;e.lineJoin="miter";
e.lineCap="butt";if(this.p1.x!==this.p2.x||this.p1.y!==this.p2.y){if(this.arrowType===u.Line.ARROW_RETROSYNTHETIC){f=l.sqrt(2)*2;b=c.shapes_arrowLength_2D/f;r=this.p1.angle(this.p2);t=r+l.PI/2;f=c.shapes_arrowLength_2D/f;m=l.cos(r);r=l.sin(r);let z=l.cos(t),A=l.sin(t);t=this.p1.x-z*b;v=this.p1.y+A*b;x=this.p1.x+z*b;g=this.p1.y-A*b;k=this.p2.x+z*b-m*f;var y=this.p2.y-A*b+r*f,a=this.p2.x-z*b-m*f,h=this.p2.y+A*b+r*f,p=this.p2.x+z*b*2-m*f*2;let C=this.p2.y-A*b*2+r*f*2;m=this.p2.x-z*b*2-m*f*2;b=this.p2.y+
A*b*2+r*f*2;e.beginPath();e.moveTo(x,g);e.lineTo(k,y);e.moveTo(p,C);e.lineTo(this.p2.x,this.p2.y);e.lineTo(m,b);e.moveTo(a,h);e.lineTo(t,v)}else this.arrowType===u.Line.ARROW_EQUILIBRIUM?(b=l.sqrt(2)*2,y=c.shapes_arrowLength_2D/b/2,m=this.p1.angle(this.p2),t=m+l.PI/2,b=c.shapes_arrowLength_2D*2/l.sqrt(3),f=l.cos(m),m=l.sin(m),r=l.cos(t),t=l.sin(t),v=this.p1.x-r*y,x=this.p1.y+t*y,a=this.p1.x+r*y,h=this.p1.y-t*y,g=this.p2.x+r*y,k=this.p2.y-t*y,p=this.p2.x-r*y,y=this.p2.y+t*y,e.beginPath(),e.moveTo(a,
h),e.lineTo(g,k),e.moveTo(p,y),e.lineTo(v,x),e.stroke(),y=g-f*b*.8,a=k+m*b*.8,h=g+r*c.shapes_arrowLength_2D/3-f*b,p=k-t*c.shapes_arrowLength_2D/3+m*b,e.beginPath(),e.moveTo(g,k),e.lineTo(h,p),e.lineTo(y,a),e.closePath(),e.fill(),e.stroke(),y=v+f*b*.8,a=x-m*b*.8,h=v-r*c.shapes_arrowLength_2D/3+f*b,p=x+t*c.shapes_arrowLength_2D/3-m*b,e.beginPath(),e.moveTo(v,x),e.lineTo(h,p),e.lineTo(y,a),e.closePath(),e.fill()):this.arrowType===u.Line.ARROW_SYNTHETIC?(m=this.p1.angle(this.p2),r=m+l.PI/2,b=c.shapes_arrowLength_2D*
2/l.sqrt(3),f=l.cos(m),m=l.sin(m),g=l.cos(r),k=l.sin(r),e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x-f*b/2,this.p2.y+m*b/2),e.stroke(),r=this.p2.x-f*b*.8,t=this.p2.y+m*b*.8,v=this.p2.x+g*c.shapes_arrowLength_2D/3-f*b,x=this.p2.y-k*c.shapes_arrowLength_2D/3+m*b,f=this.p2.x-g*c.shapes_arrowLength_2D/3-f*b,b=this.p2.y+k*c.shapes_arrowLength_2D/3+m*b,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(f,b),e.lineTo(r,t),e.lineTo(v,x),e.closePath(),e.fill()):this.arrowType===u.Line.ARROW_RESONANCE?
(m=this.p1.angle(this.p2),t=m+l.PI/2,b=c.shapes_arrowLength_2D*2/l.sqrt(3),f=l.cos(m),m=l.sin(m),r=l.cos(t),t=l.sin(t),e.beginPath(),e.moveTo(this.p1.x+f*b/2,this.p1.y-m*b/2),e.lineTo(this.p2.x-f*b/2,this.p2.y+m*b/2),e.stroke(),v=this.p2.x-f*b*.8,x=this.p2.y+m*b*.8,g=this.p2.x+r*c.shapes_arrowLength_2D/3-f*b,k=this.p2.y-t*c.shapes_arrowLength_2D/3+m*b,y=this.p2.x-r*c.shapes_arrowLength_2D/3-f*b,a=this.p2.y+t*c.shapes_arrowLength_2D/3+m*b,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(y,a),e.lineTo(v,
x),e.lineTo(g,k),e.closePath(),e.fill(),e.stroke(),v=this.p1.x+f*b*.8,x=this.p1.y-m*b*.8,g=this.p1.x-r*c.shapes_arrowLength_2D/3+f*b,k=this.p1.y+t*c.shapes_arrowLength_2D/3-m*b,y=this.p1.x+r*c.shapes_arrowLength_2D/3+f*b,a=this.p1.y-t*c.shapes_arrowLength_2D/3-m*b,e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(y,a),e.lineTo(v,x),e.lineTo(g,k),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x,this.p2.y));e.stroke();if(this.topText||this.bottomText)e.font=
q.getFontString(c.text_font_size,c.text_font_families,c.text_font_bold,c.text_font_italic),e.fillStyle=c.text_color;this.topText&&(e.textAlign="center",e.textBaseline="bottom",e.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5));this.bottomText&&(e.textAlign="center",e.textBaseline="top",e.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}};d.getPoints=function(){return[this.p1,this.p2]};d.isOver=function(e,c){e=B.distanceFromPointToLineInclusive(e,this.p1,this.p2);return e!==
-1&&e<c}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l,n){let d=function(g,k,m){let r=[];var t=g instanceof w.Atom?g:g.getCenter(),v=k instanceof w.Atom?k:k.getCenter();t=t.angle(v);for(v=0;v<2;v++){var x=v===0?g:k;let p=[];r.push(p);if(x instanceof w.Atom){if(v===0&&x.attributes!==n){var y=Infinity,a=Infinity;let z=new w.Point(Infinity,Infinity),A=new w.Point(Infinity,Infinity);for(let C=0,D=x.attributes.length;C<D;C++){var h=x.attributes[C];if(h.t!==n&&(h.t===2&&m===2||h.t!==2&&m!==2)){h=new w.Point(h.bounds.x+h.bounds.w/2,h.bounds.y+
h.bounds.h/2);let E=h.distance(x);E<y?(A=z,z=h,a=y,y=E):E<a&&(A=h,a=E)}}z.x!==Infinity&&p.push(x.angle(z));A.x!==Infinity&&p.push(x.angle(A))}if(p.length===0)if(x.bondNumber===0)v===0?(p.push(t),p.push(t+l.PI/6),p.push(t-l.PI/6)):(p.push(t+l.PI),p.push(t+l.PI+l.PI/6),p.push(t+l.PI-l.PI/6));else if(x.angles){if(x.largestAngle>l.PI+1E-4){y=x.angles.length;for(a=1;a<y;a++)p.push((x.angles[a-1]+x.angles[a])/2);p.push((x.angles[y-1]+x.angles[0])/2+l.PI);p.push(x.angleOfLeastInterference-x.largestAngle/
4);p.push(x.angleOfLeastInterference+x.largestAngle/4)}else if(x.largestAngle>l.PI-1E-4)if(x.angles.length===2)for(p.push((x.angles[0]+x.angles[1])/2),p.push(p[0]+l.PI/6),p.push(p[0]-l.PI/6),y=0;y<3;y++)p.push(p[y]+l.PI);else{y=x.angles.length;for(a=1;a<y;a++)p.push((x.angles[a-1]+x.angles[a])/2);p.push((x.angles[y-1]+x.angles[0])/2+l.PI);p.push(x.angleOfLeastInterference-x.largestAngle/6);p.push(x.angleOfLeastInterference+x.largestAngle/6)}else{y=x.angles.length;for(a=1;a<y;a++)p.push((x.angles[a-
1]+x.angles[a])/2);p.push((x.angles[y-1]+x.angles[0])/2+l.PI)}if(x.bonds&&x.bonds.length===3&&x.label==="C")for(y=0;y<3;y++)if(a=x.bonds[y],a.bondOrder===2&&(a=a.getNeighbor(x),a.label==="O")){y=0;a=x.angle(a);for(let z=0,A=x.angles.length;z<A;z++)l.abs(a-x.angles[z])>1E-4&&(y+=x.angles[z]);y/=2;l.abs(a-x.angles[1])<1E-4&&(y+=l.PI);p.length=0;p.push(y);break}}}else x=x.a1.angle(x.a2),p.push(x+l.PI/2),p.push(x+3*l.PI/2);for(let z=0,A=p.length;z<A;z++){for(;p[z]>l.PI*2;)p[z]-=l.PI*2;for(;p[z]<0;)p[z]+=
l.PI*2}}return r},e=function(g,k){let m=g instanceof w.Atom,r=k instanceof w.Atom,t=m?new w.Point(g.x,g.y):g.getCenter(),v=r?new w.Point(k.x,k.y):k.getCenter(),x=0,y=0;if(m){if(g.bonds)for(let a of g.bonds)x+=a.getLength(),y++}else x+=g.getLength(),y++;if(r){if(k.bonds)for(let a of k.bonds)x+=a.getLength(),y++}else x+=k.getLength(),y++;if(y===0)return 35;if(m||r){if(x=l.max(x/y,30,t.distance(v)/3),!m&&g.contains(k)||!r&&k.contains(g))x=l.max(30,x/2)}else return l.max(30,t.distance(v)/3);return x},
c=function(g,k,m){let r=5;if(g instanceof w.Atom){k=g.angle(k);var t=g.x,v=g.y;if(g.isLabelVisible(m)){for(let D=0,E=g.textBounds.length;D<E;D++)m=g.textBounds[D],v=k>=0&&k<=l.PI?l.min(v,m.y-2):l.max(v,m.y+m.h+2),t=k>=l.PI/2&&k<=3*l.PI/2?l.min(t,m.x-2):l.max(t,m.x+m.w+2);m=t-g.x;var x=v-g.y;m=l.sqrt(m*m+x*x)+1;x=g.x+l.cos(k)*m;var y=g.y-l.sin(k)*m,a=0;for(let D=0,E=g.textBounds.length;D<E;D++){var h=g.textBounds[D],p=h.x-2,z=h.x+h.w+2,A=h.y-2;h=h.y+h.h+2;if(k>=0&&k<=l.PI){var C=q.getParameterizedIntersectionPt(g.x,
g.y,x,y,p,A,z,A);C[1]>=0&&C[1]<=1&&C[0]<1&&C[0]>a&&(a=C[0])}else C=q.getParameterizedIntersectionPt(g.x,g.y,x,y,p,h,z,h),C[1]>=0&&C[1]<=1&&C[0]<1&&C[0]>a&&(a=C[0]);k>=l.PI/2&&k<=3*l.PI/2?(p=q.getParameterizedIntersectionPt(g.x,g.y,x,y,p,A,p,h),p[1]>=0&&p[1]<=1&&p[0]<1&&p[0]>a&&(a=p[0])):(p=q.getParameterizedIntersectionPt(g.x,g.y,x,y,z,A,z,h),p[1]>=0&&p[1]<=1&&p[0]<1&&p[0]>a&&(a=p[0]))}r=l.max(r,m*a)}if(g.attributes!==n){for(let D=0,E=g.attributes.length;D<E;D++)m=g.attributes[D],m.t!==n&&(m=m.bounds,
v=k>=0&&k<=l.PI?l.min(v,m.y-2):l.max(v,m.y+m.h+2),t=k>=l.PI/2&&k<=3*l.PI/2?l.min(t,m.x-2):l.max(t,m.x+m.w+2));t-=g.x;v-=g.y;v=l.sqrt(t*t+v*v)+1;t=g.x+l.cos(k)*v;m=g.y-l.sin(k)*v;x=0;for(let D=0,E=g.attributes.length;D<E;D++)y=g.attributes[D],y.t!==n&&(z=y.bounds,y=z.x-2,a=z.x+z.w+2,p=z.y-2,z=z.y+z.h+2,k>=0&&k<=l.PI?(A=q.getParameterizedIntersectionPt(g.x,g.y,t,m,y,p,a,p),A[1]>=0&&A[1]<=1&&A[0]<1&&A[0]>x&&(x=A[0])):(A=q.getParameterizedIntersectionPt(g.x,g.y,t,m,y,z,a,z),A[1]>=0&&A[1]<=1&&A[0]<1&&
A[0]>x&&(x=A[0])),k>=l.PI/2&&k<=3*l.PI/2?(y=q.getParameterizedIntersectionPt(g.x,g.y,t,m,y,p,y,z),y[1]>=0&&y[1]<=1&&y[0]<1&&y[0]>x&&(x=y[0])):(y=q.getParameterizedIntersectionPt(g.x,g.y,t,m,a,p,a,z),y[1]>=0&&y[1]<=1&&y[0]<1&&y[0]>x&&(x=y[0])));r=l.max(r,v*x)}}else if(g instanceof w.Point)r=0;else if(g.bondOrder>1&&(r=m.bonds_useAbsoluteSaturationWidths_2D?m.bonds_saturationWidthAbs_2D+3:g.getLength()*m.bonds_saturationWidth_2D+3,g.bondOrder===2))if(m.bonds_symmetrical_2D||!(g.ring||g.a1.label==="C"&&
g.a2.label==="C"))r=m.bonds_useAbsoluteSaturationWidths_2D?m.bonds_saturationWidthAbs_2D/2+5.5:g.getLength()*m.bonds_saturationWidth_2D/2+5.5;else if(v=g.getCenter(),k=(g.a2.x-v.x)*(k.y-v.y)-(g.a2.y-v.y)*(k.x-v.x),(g=!g.ring||g.ring.center.angle(g.a1)>g.ring.center.angle(g.a2)&&!(g.ring.center.angle(g.a1)-g.ring.center.angle(g.a2)>l.PI)||g.ring.center.angle(g.a1)-g.ring.center.angle(g.a2)<-l.PI)&&k<0||!g&&k>0)r=3;return r},b=function(g,k,m,r,t,v,x,y,a,h){var p=v.angle(t),z=x.angle(y),A=l.cos(p);p=
l.sin(p);var C=c(m,v,k);t.x-=A*C;t.y+=p*C;C=z+l.PI/2;m=k.shapes_arrowLength_2D*2/l.sqrt(3);A=l.cos(z);p=l.sin(z);z=l.cos(C);let D=l.sin(C);C=c(r,x,k);y.x-=A*C;y.y+=p*C;r=new w.Point(y.x,y.y);y.x-=m*.8*A;y.y+=m*.8*p;C=new w.Point(r.x+z*k.shapes_arrowLength_2D/3-A*m,r.y-D*k.shapes_arrowLength_2D/3+p*m);k=new w.Point(r.x-z*k.shapes_arrowLength_2D/3-A*m,r.y+D*k.shapes_arrowLength_2D/3+p*m);p=A=!0;a===1&&(C.distance(v)>k.distance(v)?p=!1:A=!1);g.beginPath();g.moveTo(r.x,r.y);p&&g.lineTo(k.x,k.y);g.lineTo(y.x,
y.y);A&&g.lineTo(C.x,C.y);g.closePath();g.fill();g.stroke();g.beginPath();g.moveTo(t.x,t.y);g.bezierCurveTo(v.x,v.y,x.x,x.y,y.x,y.y);g.stroke();h.push([t,v,x,y])};u.Pusher=function(g,k,m){this.o1=g;this.o2=k;this.numElectron=m?m:1;this.endAngle=this.startAngle=0;this.controlDistance=30};let f=u.Pusher.prototype=new u._Shape;f.drawDecorations=function(g,k){if(this.isHover){var m=this.o1 instanceof w.Atom?new w.Point(this.o1.x,this.o1.y):this.o1.getCenter(),r=this.o2 instanceof w.Atom?new w.Point(this.o2.x,
this.o2.y):this.o2.getCenter();m=[m,r];for(let t=0,v=m.length;t<v;t++)r=m[t],this.drawAnchor(g,k,r,r===this.hoverPoint)}};f.draw=function(g,k){if(this.o1&&this.o2){g.strokeStyle=k.shapes_color;g.fillStyle=k.shapes_color;g.lineWidth=k.shapes_lineWidth;g.lineJoin="miter";g.lineCap="butt";let v=this.o1 instanceof w.Atom?new w.Point(this.o1.x,this.o1.y):this.o1.getCenter(),x=this.o2 instanceof w.Atom?new w.Point(this.o2.x,this.o2.y):this.o2.getCenter(),y=new w.Point(v.x+this.controlDistance*l.cos(this.startAngle),
v.y-this.controlDistance*l.sin(this.startAngle)),a=new w.Point(x.x+this.controlDistance*l.cos(this.endAngle),x.y-this.controlDistance*l.sin(this.endAngle));if(y.distance(x)+a.distance(v)<y.distance(v)+a.distance(x)){var m=y.x;y.x=a.x;a.x=m;m=y.y;y.y=a.y;a.y=m}this.caches=[];if(this.numElectron===-1){var r=v.distance(x)/2,t=v.angle(x);m=t+l.PI/2;let h=l.cos(t),p=l.sin(t);t=new w.Point(v.x+(r-1)*h,v.y-(r-1)*p);let z=new w.Point(t.x+l.cos(m+l.PI/6)*this.controlDistance,t.y-l.sin(m+l.PI/6)*this.controlDistance);
r=new w.Point(v.x+(r+1)*h,v.y-(r+1)*p);m=new w.Point(r.x+l.cos(m-l.PI/6)*this.controlDistance,r.y-l.sin(m-l.PI/6)*this.controlDistance);b(g,k,this.o1,t,v,y,z,t,1,this.caches);b(g,k,this.o2,r,x,a,m,r,1,this.caches)}else b(g,k,this.o1,this.o2,v,y,a,x,this.numElectron,this.caches)}};f.getPoints=function(){return[]};f.isOver=function(g,k){for(let m=0,r=this.caches.length;m<r;m++)if(B.distanceFromCurve(g,this.caches[m]).distance<k)return!0;return!1};u.Pusher.setupPushers=function(g,k){var m=[];for(var r of g)if(r instanceof
u.Pusher){var t=r.o1,v=r.o2,x=g=n;for(var y of k)if(t instanceof w.Atom?y.atoms.includes(t)&&(g=y):y.bonds.includes(t)&&(g=y),v instanceof w.Atom?y.atoms.includes(v)&&(x=y):y.bonds.includes(v)&&(x=y),g&&x)break;if(g&&x){t=!1;for(var a of m)if(a[1].includes(g)){t=!0;a[0].push(r);g===x||a.includes(x)||a[1].push(x);break}else if(a[1].includes(x)){t=!0;a[0].push(r);a[1].push(g);break}t||(g===x?m.push([[r],[g]]):m.push([[r],[g,x]]))}}for(k=m.length-1;k>=0;k--){r=m[k];a:for(let G=0,I=r[1].length;G<I;G++)for(a=
m[k][1][G],y=0;y<k;y++)if(m[y][1].includes(a)){m[y][0].concat(r[0]);for(g=0;g<G;g++)m[y][1].push(r[1][g]);m[y][1].push(a);for(a=G+1;a<I;a++)g=r[1][a],m[y][1].includes(g)||m[y][1].push(g);m.splice(k,1);break a}}for(let G of m){g=[];for(let I of G[1]){for(let J of I.atoms)g.push(J);for(let J of I.bonds)g.push(J.getCenter())}m=G[0].length;k=[];r=[];a=[];x=new w.Point;t=new w.Point;y=[];for(v=0;v<m;v++){var h=G[0][v];k.push(d(h.o1,h.o2,h.numElectron));r.push(e(h.o1,h.o2));var p=[];p.push(h.o1 instanceof
w.Atom?new w.Point(h.o1.x,h.o1.y):h.o1.getCenter());p.push(h.o2 instanceof w.Atom?new w.Point(h.o2.x,h.o2.y):h.o2.getCenter());var z=p[0].distance(p[1]);a.push([]);h=[0,0,Number.POSITIVE_INFINITY];var A=[0,0,Number.POSITIVE_INFINITY],C=[0,0,Number.POSITIVE_INFINITY],D=0;for(let I=0,J=k[v][0].length;I<J;I++)for(let M=0,H=k[v][1].length;M<H;M++){x.x=p[0].x+r[v]*l.cos(k[v][0][I]);x.y=p[0].y-r[v]*l.sin(k[v][0][I]);t.x=p[1].x+r[v]*l.cos(k[v][1][M]);t.y=p[1].y-r[v]*l.sin(k[v][1][M]);if(x.distance(p[1])+
t.distance(p[0])<x.distance(p[0])+t.distance(p[1])){var E=x.x;x.x=t.x;t.x=E;E=x.y;x.y=t.y;t.y=E}E=[];E.push(new w.Point((64*p[0].x+48*x.x+12*t.x+p[1].x)/125,(64*p[0].y+48*x.y+12*t.y+p[1].y)/125));E.push(new w.Point((p[0].x+3*x.x+3*t.x+p[1].x)/8,(p[0].y+3*x.y+3*t.y+p[1].y)/8));E.push(new w.Point((p[0].x+12*x.x+48*t.x+64*p[1].x)/125,(p[0].y+12*x.y+48*t.y+64*p[1].y)/125));a[v].push(E);var F=E[2].distance(E[0])/z;F*=.5*F;for(let R of g)for(let K=0;K<3;K++){let L=E[K].x-R.x,N=E[K].y-R.y;F+=1/l.sqrt(L*
L+N*N)}F<h[2]?(C[0]=A[0],C[1]=A[1],C[2]=A[2],A[0]=h[0],A[1]=h[1],A[2]=h[2],h[0]=I,h[1]=M,h[2]=F):F<A[2]?(C[0]=A[0],C[1]=A[1],C[2]=A[2],A[0]=I,A[1]=M,A[2]=F):F<C[2]&&(C[0]=I,C[1]=M,C[2]=F);D++}p=[];h[2]<Number.POSITIVE_INFINITY&&p.push(h);A[2]<Number.POSITIVE_INFINITY&&p.push(A);C[2]<Number.POSITIVE_INFINITY&&p.push(C);y.push(p)}x=[];g=[];for(t=0;t<m;t++)x.push(0),g.push(0);if(m>1)for(t=Number.POSITIVE_INFINITY,v=m-1,p=y[0].length;x[0]<p;){h=0;for(A=0;A<m;A++)for(h+=y[A][x[A]][2],C=k[A][1].length*
y[A][x[A]][0]+y[A][x[A]][1],z=0;z<A;z++)for(D=k[z][1].length*y[z][x[z]][0]+y[z][x[z]][1],E=0;E<3;E++)for(F=0;F<3;F++)h+=1/a[z][D][F].distance(a[A][C][E]);if(h<t)for(t=h,h=0;h<m;h++)g[h]=x[h];for(x[v]++;v>0&&x[v]==y[v].length;)x[v]=0,v--,x[v]++;v=m-1}for(a=0;a<m;a++)x=G[0][a],x.startAngle=k[a][0][y[a][g[a]][0]],x.endAngle=k[a][1][y[a][g[a]][1]],x.controlDistance=r[a]}};window.TESTING&&(u.Pusher.getPossibleAngles=d,u.Pusher.getControlDistance=e)})(ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,
ChemDoodle.structures.d2,Math);
(function(q,B,w,u,l){let n=new B.Bond;w.VAP=function(d,e){this.asterisk=new B.Atom("O",d,e);this.substituent;this.bondType=1;this.attachments=[]};q=w.VAP.prototype=new w._Shape;q.drawDecorations=function(d,e){if(this.isHover||this.isSelected){d.strokeStyle=this.isHover?e.colorHover:e.colorSelect;d.lineWidth=1.2;if(this.hoverBond){let c=2*u.PI,b=(this.asterisk.angleForStupidCanvasArcs(this.hoverBond)+u.PI/2)%c;d.strokeStyle=this.isHover?e.colorHover:e.colorSelect;d.beginPath();e=(b+u.PI)%c;e%=u.PI*
2;d.arc(this.asterisk.x,this.asterisk.y,7,b,e,!1);d.stroke();d.beginPath();b+=u.PI;e=(b+u.PI)%c;d.arc(this.hoverBond.x,this.hoverBond.y,7,b,e,!1)}else d.beginPath(),d.arc(this.asterisk.x,this.asterisk.y,7,0,u.PI*2,!1);d.stroke()}};q.draw=function(d,e){d.strokeStyle=this.error?e.colorError:e.shapes_color;d.lineWidth=1;var c=u.sqrt(3)/2;d.beginPath();d.moveTo(this.asterisk.x,this.asterisk.y-4);d.lineTo(this.asterisk.x,this.asterisk.y+4);d.moveTo(this.asterisk.x-c*4,this.asterisk.y-2);d.lineTo(this.asterisk.x+
c*4,this.asterisk.y+2);d.moveTo(this.asterisk.x-c*4,this.asterisk.y+2);d.lineTo(this.asterisk.x+c*4,this.asterisk.y-2);d.stroke();this.asterisk.textBounds=[];this.asterisk.textBounds.push({x:this.asterisk.x-4,y:this.asterisk.y-4,w:8,h:8});c=e.bonds_color;this.error&&(e.bonds_color=e.colorError);n.a1=this.asterisk;this.substituent&&(n.a2=this.substituent,n.bondOrder=this.bondType,n.draw(d,e));n.bondOrder=0;this.error||(e.bonds_color=e.shapes_color);for(let b=0,f=this.attachments.length;b<f;b++)n.a2=
this.attachments[b],n.draw(d,e);e.bonds_color=c};q.getPoints=function(){return[this.asterisk]};q.isOver=function(d,e){return!1}})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(q,B,w){q._Mesh=function(){};q=q._Mesh.prototype;q.storeData=function(u,l,n){this.positionData=u;this.normalData=l;this.indexData=n};q.setupBuffers=function(u){this.vertexPositionBuffer=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,this.vertexPositionBuffer);u.bufferData(u.ARRAY_BUFFER,new Float32Array(this.positionData),u.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,
this.vertexNormalBuffer);u.bufferData(u.ARRAY_BUFFER,new Float32Array(this.normalData),u.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),u.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);if(this.partitions)for(let l=
0,n=this.partitions.length;l<n;l++){let d=this.partitions[l],e=this.generateBuffers(u,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=e[0];d.vertexNormalBuffer=e[1];d.vertexIndexBuffer=e[2]}};q.generateBuffers=function(u,l,n,d){let e=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,e);u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STATIC_DRAW);e.itemSize=3;e.numItems=l.length/3;l=u.createBuffer();u.bindBuffer(u.ARRAY_BUFFER,l);u.bufferData(u.ARRAY_BUFFER,new Float32Array(n),u.STATIC_DRAW);
l.itemSize=3;l.numItems=n.length/3;let c;d&&(c=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,c),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),u.STATIC_DRAW),c.itemSize=1,c.numItems=d.length);return[e,l,c]};q.bindBuffers=function(u){this.vertexPositionBuffer||this.setupBuffers(u);u.bindBuffer(u.ARRAY_BUFFER,this.vertexPositionBuffer);u.vertexAttribPointer(u.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,u.FLOAT,!1,0,0);u.bindBuffer(u.ARRAY_BUFFER,this.vertexNormalBuffer);
u.vertexAttribPointer(u.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,u.FLOAT,!1,0,0);this.vertexIndexBuffer&&u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures.d3,Math);
(function(q,B){q._Measurement=function(){};q=q._Measurement.prototype=new q._Mesh;q.render=function(w,u){w.shader.setMatrixUniforms(w);u.measurement_update_3D&&(this.text=this.vertexPositionBuffer=B);this.vertexPositionBuffer||this.calculateData(u);this.bindBuffers(w);w.material.setDiffuseColor(w,u.shapes_color);w.lineWidth(u.shapes_lineWidth);w.drawElements(w.LINES,this.vertexIndexBuffer.numItems,w.UNSIGNED_SHORT,0)};q.renderText=function(w,u){w.shader.setMatrixUniforms(w);this.text||(this.text=
this.getText(u));u={position:[],texCoord:[],translation:[]};w.textImage.pushVertexData(this.text.value,this.text.pos,1,u);w.textMesh.storeData(w,u.position,u.texCoord,u.translation);w.textImage.useTexture(w);w.textMesh.render(w)}})(ChemDoodle.structures.d3);
(function(q,B,w,u,l,n,d,e){w.Angle=function(c,b,f){this.a1=c;this.a2=b;this.a3=f};q=w.Angle.prototype=new w._Measurement;q.calculateData=function(c){let b=[],f=[],g=[];var k=this.a2.distance3D(this.a1),m=this.a2.distance3D(this.a3);this.distUse=l.min(k,m)/2;this.vec1=d.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]);this.vec2=d.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]);this.angle=B.vec3AngleFrom(this.vec1,this.vec2);k=d.normalize(d.cross(this.vec1,
this.vec2,[]));k=d.normalize(d.cross(k,this.vec1,[]));c=c.measurement_angleBands_3D;for(m=0;m<=c;++m){var r=this.angle*m/c,t=d.scale(this.vec1,l.cos(r),[]);r=d.scale(k,l.sin(r),[]);t=d.scale(d.normalize(d.add(t,r,[])),this.distUse);b.push(this.a2.x+t[0],this.a2.y+t[1],this.a2.z+t[2]);f.push(0,0,0);m<c&&g.push(m,m+1)}this.storeData(b,f,g)};q.getText=function(c){c=d.scale(d.normalize(d.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+c[0],this.a2.y+c[1],this.a2.z+c[2]],value:[u.angleBounds(this.angle,
!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w){q.Arrow=function(u,l){let n=[],d=[];for(var e=0;e<=l;e++){var c=e*2*B.PI/l,b=B.sin(c);c=B.cos(c);d.push(0,0,-1,0,0,-1,c,b,0,c,b,0,0,0,-1,0,0,-1,c,b,1,c,b,1);n.push(0,0,0,u*c,u*b,0,u*c,u*b,0,u*c,u*b,2,u*c,u*b,2,u*c*2,u*b*2,2,u*c*2,u*b*2,2,0,0,3)}u=[];for(e=0;e<l;e++){b=e*8;for(let f=0,g=7;f<g;f++){c=f+b;let k=c+g+2;u.push(c,k,c+1,k,c,k-1)}}this.storeData(n,d,u)};q.Arrow.prototype=new q._Mesh})(ChemDoodle.structures.d3,Math);
(function(q,B,w){q.Box=function(u,l,n){u/=2;n/=2;let d=[],e=[];d.push(u,l,-n);d.push(u,l,-n);d.push(-u,l,-n);d.push(u,l,n);d.push(-u,l,n);d.push(-u,l,n);for(var c=6;c--;e.push(0,1,0));d.push(-u,l,n);d.push(-u,l,n);d.push(-u,0,n);d.push(u,l,n);d.push(u,0,n);d.push(u,0,n);for(c=6;c--;e.push(0,0,1));d.push(u,l,n);d.push(u,l,n);d.push(u,0,n);d.push(u,l,-n);d.push(u,0,-n);d.push(u,0,-n);for(c=6;c--;e.push(1,0,0));d.push(u,l,-n);d.push(u,l,-n);d.push(u,0,-n);d.push(-u,l,-n);d.push(-u,0,-n);d.push(-u,0,
-n);for(c=6;c--;e.push(0,0,-1));d.push(-u,l,-n);d.push(-u,l,-n);d.push(-u,0,-n);d.push(-u,l,n);d.push(-u,0,n);d.push(-u,0,n);for(l=6;l--;e.push(-1,0,0));d.push(-u,0,n);d.push(-u,0,n);d.push(-u,0,-n);d.push(u,0,n);d.push(u,0,-n);d.push(u,0,-n);for(u=6;u--;e.push(0,-1,0));this.storeData(d,e)};q.Box.prototype=new q._Mesh})(ChemDoodle.structures.d3,Math);
(function(q,B,w,u,l,n){B.Camera=function(){this.fieldOfView=45;this.aspect=1;this.near=.1;this.far=1E4;this.zoom=1;this.viewMatrix=u.identity([]);this.projectionMatrix=u.identity([])};q=B.Camera.prototype;q.perspectiveProjectionMatrix=function(){let d=l.tan(this.fieldOfView/360*l.PI)*this.near*this.zoom,e=this.aspect*d;return u.frustum(-e,e,-d,d,this.near,this.far,this.projectionMatrix)};q.orthogonalProjectionMatrix=function(){let d=l.tan(this.fieldOfView/360*l.PI)*((this.far-this.near)/2+this.near)*
this.zoom,e=this.aspect*d;return u.ortho(-e,e,-d,d,this.near,this.far,this.projectionMatrix)};q.updateProjectionMatrix=function(d){return d?this.perspectiveProjectionMatrix():this.orthogonalProjectionMatrix()};q.focalLength=function(){return(this.far-this.near)/2+this.near};q.zoomOut=function(){this.zoom=l.min(this.zoom*1.25,200)};q.zoomIn=function(){this.zoom=l.max(this.zoom/1.25,.0025)}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4,Math);
(function(q,B,w,u){q.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])};q.LineArrow.prototype=new q._Mesh;q.Compass=function(n,d){this.textImage=new q.TextImage;this.textImage.init(n);this.textImage.updateFont(n,d.text_font_size,d.text_font_families,d.text_font_bold,d.text_font_italic,d.text_font_stroke_3D);this.textMesh=new q.TextMesh;this.textMesh.init(n);var e=3/(d.compass_size_3D/
n.canvas.clientHeight),c=B.tan(d.projectionPerspectiveVerticalFieldOfView_3D/360*B.PI);let b=e/c,f=B.max(b-e,.1);var g=n.canvas.clientWidth/n.canvas.clientHeight;let k;if(d.projectionPerspective_3D){var m=f;k=w.frustum}else m=b,k=w.ortho;let r=m/n.canvas.clientHeight*2*c;c*=m;m=-c;let t=g*m;g*=c;if(d.compass_type_3D===0){let v=(-(n.canvas.clientWidth-d.compass_size_3D)/2+this.textImage.charHeight)*r;d=(-(n.canvas.clientHeight-d.compass_size_3D)/2+this.textImage.charHeight)*r;t-=v;g-=v;m-=d;c-=d}this.projectionMatrix=
k(t,g,m,c,f,b+e);this.translationMatrix=w.translate(w.identity([]),[0,0,-b]);e={position:[],texCoord:[],translation:[]};this.textImage.pushVertexData("X",[3.5,0,0],0,e);this.textImage.pushVertexData("Y",[0,3.5,0],0,e);this.textImage.pushVertexData("Z",[0,0,3.5],0,e);this.textMesh.storeData(n,e.position,e.texCoord,e.translation)};let l=q.Compass.prototype;l.renderArrow=function(n,d,e,c){n.material.setDiffuseColor(n,e);n.shader.setModelViewMatrix(n,c);d===1?n.drawArrays(n.LINES,0,n.lineArrowBuffer.vertexPositionBuffer.numItems):
n.drawElements(n.TRIANGLES,n.arrowBuffer.vertexIndexBuffer.numItems,n.UNSIGNED_SHORT,0)};l.render=function(n,d){n.shader.setProjectionMatrix(n,this.projectionMatrix);d.compass_type_3D===1?n.lineArrowBuffer.bindBuffers(n):n.arrowBuffer.bindBuffers(n);n.material.setTempColors(n,d.bonds_materialAmbientColor_3D,u,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D);let e=w.multiply(this.translationMatrix,n.rotationMatrix,[]),c=B.PI/2;this.renderArrow(n,d.compass_type_3D,d.compass_axisXColor_3D,
w.rotateY(e,c,[]));this.renderArrow(n,d.compass_type_3D,d.compass_axisYColor_3D,w.rotateX(e,-c,[]));this.renderArrow(n,d.compass_type_3D,d.compass_axisZColor_3D,e)};l.renderAxis=function(n){n.shader.setProjectionMatrix(n,this.projectionMatrix);let d=w.multiply(this.translationMatrix,n.rotationMatrix,[]);n.shader.setModelViewMatrix(n,d);this.textImage.useTexture(n);this.textMesh.render(n)}})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4);
(function(q,B,w){q.Cylinder=function(u,l,n,d){let e=[],c=[];if(d){for(d=0;d<=n;d++){var b=d%n*2*B.PI/n,f=B.cos(b);b=B.sin(b);c.push(0,-1,0);e.push(0,0,0);c.push(0,-1,0);e.push(u*f,0,u*b)}for(d=0;d<=n;d++)b=d%n*2*B.PI/n,f=B.cos(b),b=B.sin(b),c.push(f,0,b),e.push(u*f,0,u*b),c.push(f,0,b),e.push(u*f,l,u*b);for(d=0;d<=n;d++)b=d%n*2*B.PI/n,f=B.cos(b),b=B.sin(b),c.push(0,1,0),e.push(u*f,l,u*b),c.push(0,1,0),e.push(0,l,0)}else{for(d=0;d<n;d++)b=d*2*B.PI/n,f=B.cos(b),b=B.sin(b),c.push(f,0,b),e.push(u*f,0,
u*b),c.push(f,0,b),e.push(u*f,l,u*b);c.push(1,0,0);e.push(u,0,0);c.push(1,0,0);e.push(u,l,0)}this.storeData(e,c)};q.Cylinder.prototype=new q._Mesh})(ChemDoodle.structures.d3,Math);
(function(q,B,w,u,l){B.Distance=function(n,d,e,c){this.a1=n;this.a2=d;this.node=e;this.offset=c?c:0};B=B.Distance.prototype=new B._Measurement;B.calculateData=function(n){let d=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+w.max(n.atoms_useVDWDiameters_3D?q[this.a1.label].vdWRadius*n.atoms_vdwMultiplier_3D:n.atoms_sphereDiameter_3D/2,n.atoms_useVDWDiameters_3D?q[this.a2.label].vdWRadius*n.atoms_vdwMultiplier_3D:n.atoms_sphereDiameter_3D/2),this.displacement=
[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],u.normalize(this.displacement),n=u.scale(this.displacement,this.move,[]),d[0]+=n[0],d[1]+=n[1],d[2]+=n[2],d[3]+=n[0],d[4]+=n[1],d[5]+=n[2]);this.storeData(d,[0,0,0,0,0,0],[0,1])};B.getText=function(n){n=this.a1.distance3D(this.a2);let d=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){let e=u.scale(this.displacement,this.move+.1,[]);d[0]+=e[0];d[1]+=
e[1];d[2]+=e[2]}return{pos:d,value:[n.toFixed(2)," \u212b"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);(function(q,B,w,u){B.Fog=function(l,n,d,e){this.fogScene(l,n,d,e)};B.Fog.prototype.fogScene=function(l,n,d,e){this.colorRGB=q.getRGB(l,1);this.fogStart=n;this.fogEnd=d;this.density=e}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(q,B,w){B.Label=function(u){};B=B.Label.prototype;B.updateVerticesBuffer=function(u,l,n){for(let g=0,k=l.length;g<k;g++){var d=l[g];let m=d.labelMesh;var e=d.atoms;let r={position:[],texCoord:[],translation:[]};var c=e.length>0&&e[0].hetatm!=w;for(let t=0,v=e.length;t<v;t++){var b=e[t],f=b.label;let x=.05;n.atoms_useVDWDiameters_3D?(f=q[f].vdWRadius*n.atoms_vdwMultiplier_3D,f===0&&(f=1),x+=f):n.atoms_sphereDiameter_3D&&(x+=n.atoms_sphereDiameter_3D/2*1.5);if(c)if(!b.hetatm){if(!n.macro_displayAtoms)continue}else if(b.isWater&&
!n.macro_showWaters)continue;u.textImage.pushVertexData(b.altLabel?b.altLabel:b.label,[b.x,b.y,b.z],x,r)}if((d=d.chains)&&(n.proteins_displayRibbon||n.proteins_displayBackbone))for(let t=0,v=d.length;t<v;t++){e=d[t];for(let x=0,y=e.length;x<y;x++)c=e[x],c.name&&(b=c.cp1,u.textImage.pushVertexData(c.name,[b.x,b.y,b.z],2,r))}m.storeData(u,r.position,r.texCoord,r.translation,r.zDepth)}};B.render=function(u,l,n){u.shader.setMatrixUniforms(u);u.textImage.useTexture(u);for(let d=0,e=n.length;d<e;d++)n[d].labelMesh&&
n[d].labelMesh.render(u)}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3);(function(q,B,w){q.Sphere=function(u,l,n){let d=[],e=[];for(var c=0;c<=l;c++){var b=c*B.PI/l,f=B.sin(b);b=B.cos(b);for(var g=0;g<=n;g++){var k=g*2*B.PI/n,m=B.sin(k);k=B.cos(k)*f;let r=b;m*=f;e.push(k,r,m);d.push(u*k,u*r,u*m)}}u=[];n+=1;for(c=0;c<l;c++)for(f=0;f<n;f++)b=c*n+f%n,g=b+n,u.push(b,b+1,g),f<n-1&&u.push(g,b+1,g+1);this.storeData(d,e,u)};q.Sphere.prototype=new q._Mesh})(ChemDoodle.structures.d3,Math);
(function(q,B,w,u,l){function n(e,c,b,f){this.entire=e;this.name=c;this.indexes=b;this.pi=f}let d=n.prototype;d.getColor=function(e){return e.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(q[this.name]?this.name:"*",e):this.helix?this.entire.front?e.proteins_ribbonCartoonHelixPrimaryColor:e.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?e.proteins_ribbonCartoonSheetColor:this.entire.front?e.proteins_primaryColor:e.proteins_secondaryColor};d.getResidueColor=function(e,
c){e=q[e];if(c.proteins_residueColor==="shapely")return e.shapelyColor;if(c.proteins_residueColor==="amino")return e.aminoColor;if(c.proteins_residueColor==="polarity"){if(e.polar)return"#C10000"}else if(c.proteins_residueColor==="acidity"){if(e.acidity===1)return"#0000FF";if(e.acidity===-1)return"#FF0000";if(!e.polar)return"#773300"}return"#FFFFFF"};d.render=function(e,c,b){if(this.entire.partitions&&this.pi!==this.entire.partitions.lastRender){var f=this.entire.partitions[this.pi];e.bindBuffer(e.ARRAY_BUFFER,
f.vertexPositionBuffer);e.vertexAttribPointer(e.shader.vertexPositionAttribute,f.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0);e.bindBuffer(e.ARRAY_BUFFER,f.vertexNormalBuffer);e.vertexAttribPointer(e.shader.vertexNormalAttribute,f.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f.vertexIndexBuffer);this.entire.partitions.lastRender=this.pi}this.vertexIndexBuffer||(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,
new Uint16Array(this.indexes),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);b||c.proteins_residueColor==="rainbow"||e.material.setDiffuseColor(e,this.getColor(c));e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)};B.Ribbon=function(e,c,b){let f=e[0].lineSegments.length,g=e[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;this.front=
c>0;for(let A=0,C=e.length;A<C;A++){if(!k||k.positionData.length>65E3){this.partitions.length>0&&A--;var k={count:0,positionData:[],normalData:[]};this.partitions.push(k)}var m=e[A];k.count++;for(var r=0;r<f;r++){var t=b?m.lineSegmentsCartoon[r]:m.lineSegments[r],v=r===0,x=!1;for(var y=0;y<g;y++){var a=t[y],h=A,p=y+1;A===e.length-1&&y===g-1?p--:y===g-1&&(h++,p=0);p=b?e[h].lineSegmentsCartoon[r][p]:e[h].lineSegments[r][p];h=!1;var z=r+1;r===f-1&&(z-=2,h=!0);z=b?m.lineSegmentsCartoon[z][y]:m.lineSegments[z][y];
p=[p.x-a.x,p.y-a.y,p.z-a.z];z=[z.x-a.x,z.y-a.y,z.z-a.z];let D=u.cross(p,z,[]);y===0&&(u.normalize(p),u.scale(p,-1),k.normalData.push(p[0],p[1],p[2]),k.positionData.push(a.x,a.y,a.z));v||x?(u.normalize(z),u.scale(z,-1),k.normalData.push(z[0],z[1],z[2]),k.positionData.push(a.x,a.y,a.z),v&&y===g-1&&(v=!1,y=-1)):(u.normalize(D),(h&&!this.front||!h&&this.front)&&u.scale(D,-1),k.normalData.push(D[0],D[1],D[2]),u.scale(D,w.abs(c)),k.positionData.push(a.x+D[0],a.y+D[1],a.z+D[2]),r===f-1&&y===g-1&&(x=!0,y=
-1));if(y===-1||y===g-1)u.normalize(p),k.normalData.push(p[0],p[1],p[2]),k.positionData.push(a.x,a.y,a.z)}}}f+=2;g+=2;this.segments=[];this.partitionSegments=[];for(let A=0,C=this.partitions.length;A<C;A++){c=this.partitions[A];k=[];m=l;for(let D=0,E=c.count-1;D<E;D++){m=D;for(r=0;r<A;r++)m+=this.partitions[r].count-1;m=e[m];t=D*f*g;r=[];for(let F=0,G=f-1;F<G;F++)for(v=t+F*g,x=0;x<g-1;x++)y=1,D===E&&(y=0),y=[v+x,v+g+x,v+g+x+y,v+x,v+x+y,v+g+x+y],x!==g-1&&(this.front?r.push(y[0],y[1],y[2],y[3],y[5],
y[4]):r.push(y[0],y[2],y[1],y[3],y[4],y[5])),x!==g-2||D===c.count-2&&A===this.partitions.length-1||(a=f*g-x,y[2]+=a,y[4]+=a,y[5]+=a),this.front?k.push(y[0],y[1],y[2],y[3],y[5],y[4]):k.push(y[0],y[2],y[1],y[3],y[4],y[5]);b&&m.split&&(k=new n(this,l,k,A),k.helix=m.helix,k.sheet=m.sheet,this.partitionSegments.push(k),k=[]);this.segments.push(new n(this,m.name,r,A))}c=new n(this,l,k,A);c.helix=m.helix;c.sheet=m.sheet;this.partitionSegments.push(c)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData);
this.partitions.length===1&&(this.partitions=l)};(B.Ribbon.prototype=new B._Mesh).render=function(e,c){this.bindBuffers(e);let b=c.macro_colorByChain?this.chainColor:l;b||=this.front?c.proteins_primaryColor:c.proteins_secondaryColor;e.material.setDiffuseColor(e,b);for(let f=0,g=this.partitionSegments.length;f<g;f++)this.partitionSegments[f].render(e,c,!c.proteins_ribbonCartoonize)}})(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(q,B,w,u,l){B.Light=function(n,d,e){this.camera=new B.Camera;this.lightScene(n,d,e)};l=B.Light.prototype;l.lightScene=function(n,d,e){this.diffuseRGB=q.getRGB(n,1);this.specularRGB=q.getRGB(d,1);this.direction=e;this.updateView()};l.updateView=function(){var n=w.normalize(this.direction,[]);let d=w.scale(n,(this.camera.near-this.camera.far)/2-this.camera.near,[]);n=w.equal(n,[0,1,0])?[0,0,1]:[0,1,0];u.lookAt(d,[0,0,0],n,this.camera.viewMatrix);this.camera.orthogonalProjectionMatrix()}})(ChemDoodle.math,
ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4);(function(q,B){q.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])};q.Line.prototype=new q._Mesh})(ChemDoodle.structures.d3);
(function(q,B,w){B.Material=function(){};B=B.Material.prototype;B.setTempColors=function(u,l,n,d,e){l&&u.shader.setMaterialAmbientColor(u,q.getRGB(l,1));n&&u.shader.setMaterialDiffuseColor(u,q.getRGB(n,1));d&&u.shader.setMaterialSpecularColor(u,q.getRGB(d,1));u.shader.setMaterialShininess(u,e);u.shader.setMaterialAlpha(u,1)};B.setDiffuseColor=function(u,l){u.shader.setMaterialDiffuseColor(u,q.getRGB(l,1))};B.setAlpha=function(u,l){u.shader.setMaterialAlpha(u,l)}})(ChemDoodle.math,ChemDoodle.structures.d3);
(function(q,B,w,u){q.Picker=function(){};q=q.Picker.prototype;q.init=function(l){this.framebuffer=l.createFramebuffer();let n=l.createTexture(),d=l.createRenderbuffer();l.bindTexture(l.TEXTURE_2D,n);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);l.bindRenderbuffer(l.RENDERBUFFER,d);l.bindFramebuffer(l.FRAMEBUFFER,
this.framebuffer);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,n,0);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,d);l.bindTexture(l.TEXTURE_2D,null);l.bindRenderbuffer(l.RENDERBUFFER,null);l.bindFramebuffer(l.FRAMEBUFFER,null)};q.setDimension=function(l,n,d){l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);var e=l.getFramebufferAttachmentParameter(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);l.isRenderbuffer(e)&&(l.bindRenderbuffer(l.RENDERBUFFER,
e),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,n,d),l.bindRenderbuffer(l.RENDERBUFFER,null));e=l.getFramebufferAttachmentParameter(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);l.isTexture(e)&&(l.bindTexture(l.TEXTURE_2D,e),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,n,d,0,l.RGBA,l.UNSIGNED_BYTE,null),l.bindTexture(l.TEXTURE_2D,null));l.bindFramebuffer(l.FRAMEBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(q,B,w){q.Pill=function(u,l,n,d){var e=1,c=2*u;l-=c;l<0?(e=0,l+=c):l<c&&(e=l/c,l=c);c=[];let b=[];for(var f=0;f<=n;f++){var g=f*B.PI/n,k=B.sin(g);g=B.cos(g)*e;for(let t=0;t<=d;t++){var m=t*2*B.PI/d,r=B.sin(m);m=B.cos(m)*k;let v=g;r*=k;b.push(m,v,r);c.push(u*m,u*v+(f<n/2?l:0),u*r)}}u=[];d+=1;for(l=0;l<n;l++)for(e=0;e<d;e++)f=l*d+e%d,k=f+d,u.push(f,f+1,k),e<d-1&&u.push(k,f+1,k+1);this.storeData(c,b,u)};q.Pill.prototype=new q._Mesh})(ChemDoodle.structures.d3,Math);
(function(q,B,w,u,l,n,d,e,c){function b(k,m,r){let t=new w.Residue(-1);t.cp1=t.cp2=new w.Atom("",k,m,r);return t}function f(k,m){this.a1=k;this.a2=m}function g(k,m,r){this.a1=k;this.a2=m;this.vx=r}f.prototype.render=function(k,m){var r=this.a1;let t=this.a2;var v=1.001*r.distance3D(t);m=m.proteins_cylinderHelixDiameter/2;v=[m,v,m];m=n.translate(n.identity(),[r.x,r.y,r.z]);var x=[0,1,0];let y=0;r.x===t.x&&r.z===t.z?(x=[0,0,1],t.y<r.y&&(y=l.PI)):(r=[t.x-r.x,t.y-r.y,t.z-r.z],y=q.vec3AngleFrom(x,r),x=
d.cross(x,r,[]));y!==0&&n.rotate(m,y,x);n.scale(m,v);k.shader.setMatrixUniforms(k,m);k.drawArrays(k.TRIANGLE_STRIP,0,k.cylinderClosedBuffer.vertexPositionBuffer.numItems)};g.prototype.render=function(k,m){this.styles&&(m=this.styles);let r=1.001*this.a1.distance3D(this.a2);var t=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];let v=d.cross(t,this.vx,[]),x=d.cross(v,t,[]);d.normalize(x);d.normalize(t);d.normalize(v);t=[x[0],x[1],x[2],0,t[0],t[1],t[2],0,v[0],v[1],v[2],0,this.a1.x,this.a1.y,
this.a1.z,1];n.scale(t,[m.proteins_plankSheetWidth,r,m.proteins_tubeThickness]);k.shader.setMatrixUniforms(k,t);k.drawArrays(k.TRIANGLE_STRIP,0,k.boxBuffer.vertexPositionBuffer.numItems)};u.PipePlank=function(k,m){this.tubes=[];this.helixCylinders=[];this.sheetPlanks=[];this.chainColor=k.chainColor;var r=[],t=[],v=[],x=[];if(k.length>1){var y=k[0],a=k[1];a.helix?v.push(y):a.sheet?x.push(y):t.push(y)}for(let I=1,J=k.length-1;I<=J;I++)if(y=k[I],y.helix){if(v.push(y),y.arrow){var h=d.create();a=d.create();
if(v.length===1)h=[y.guidePointsSmall[0].x,y.guidePointsSmall[0].y,y.guidePointsSmall[0].z],a=y.guidePointsSmall[y.guidePointsSmall.length-1],a=[a.x,a.y,a.z];else if(v.length===2)h=[v[0].cp1.x,v[0].cp1.y,v[0].cp1.z],a=[v[1].cp1.x,v[1].cp1.y,v[1].cp1.z];else{v.length===3&&v.unshift(k[l.max(I-3,0)]);var p=[],z=[];for(let M=1,H=v.length-1;M<H;M++){var A=[v[M].cp1.x,v[M].cp1.y,v[M].cp1.z],C=[v[M-1].cp1.x,v[M-1].cp1.y,v[M-1].cp1.z],D=[v[M+1].cp1.x,v[M+1].cp1.y,v[M+1].cp1.z];d.subtract(C,A);d.subtract(D,
A);var E=d.scale(C,d.length(D),[]);C=d.scale(D,d.length(C),[]);E=d.normalize(d.add(E,C,[]));p.push(A);z.push(E)}v=[];for(let M=0,H=p.length-1;M<H;M++){C=p[M];D=z[M];A=p[M+1];E=z[M+1];var F=d.normalize(d.cross(D,E,[])),G=d.subtract(A,C,[]);let R=d.dot(G,F);F=d.scale(F,R,[]);F=d.length(F);G=d.length(G);G=-(F*F-G*G)/(2*d.dot(d.subtract(C,A,[]),E));C=d.add(C,d.scale(D,G,[]),[]);A=d.add(A,d.scale(E,G,[]),[]);v.push([C,A])}p=v[0][0];z=v[0][1];z=d.subtract(p,z,[]);d.add(p,z,h);p=v[v.length-1][1];z=v[v.length-
1][0];z=d.subtract(p,z,[]);d.add(p,z,a)}v=new w.Atom("",h[0],h[1],h[2]);p=new w.Atom("",a[0],a[1],a[2]);this.helixCylinders.push(new f(v,p));v=[];p=d.subtract(h,a,[]);d.normalize(p);d.scale(p,.5);t.length>0&&(z=d.add(h,p,[]),A=t[t.length-1].cp1,A=d.subtract([A.x,A.y,A.z],z,[]),d.normalize(A),d.scale(A,.5),d.add(z,A),A=new w.Residue(-1),A.cp1=A.cp2=new w.Atom("",z[0],z[1],z[2]),t.push(A),A=b(h[0],h[1],h[2]),t.push(A),r.push(t));t=[];I<J&&(h=b(a[0],a[1],a[2]),t.push(h),h=k[I+1],h.sheet?(t.push(y),t.push(y),
r.push(t),t=[],x.push(y)):(d.scale(p,-1),y=d.add(a,p,[]),a=h.cp1,a=d.subtract([a.x,a.y,a.z],y,[]),d.normalize(a),d.scale(a,.5),d.add(y,a),y=b(y[0],y[1],y[2]),t.push(y)))}}else if(y.sheet){if(x.push(y),y.arrow){h=[0,0,0];p=[0,0,0];a=x.length;for(z=0;z<a;z++)E=x[z].guidePointsLarge,A=E[0],E=E[E.length-1],d.add(h,[A.x,A.y,A.z]),d.add(p,[E.x,E.y,E.z]);d.scale(h,1/a);d.scale(p,1/a);h=d.subtract(h,p);a=x[a-1].guidePointsSmall[0];this.sheetPlanks.push(new g(x[0].guidePointsSmall[0],a,h));x=[];I<J&&(k[I+
1].sheet?x.push(y):(y=b(a.x,a.y,a.z),t.push(y)))}}else t.push(y),I<J&&k[I+1].sheet&&(a=y.guidePointsSmall[0],a=b(a.x,a.y,a.z),t.push(a),r.push(t),t=[],x.push(y));t.length>1&&(t.length==2&&t.push(t[t.length-1]),r.push(t));t=[];for(let I=0,J=r.length;I<J;I++){x=r[I];y=[];for(let M=0,H=x.length-1;M<=H;M++)y.push(x[M].cp1);t.push(y)}for(let I=0,J=t.length;I<J;I++)r=new u.CatmullTube(t[I],m.proteins_tubeThickness,m.proteins_tubeResolution_3D,m.proteins_horizontalResolution),r.chainColor=k.chainColor,this.tubes.push(r)};
(u.PipePlank.prototype=new u._Mesh).render=function(k,m){k.material.setTempColors(k,m.proteins_materialAmbientColor_3D,c,m.proteins_materialSpecularColor_3D,m.proteins_materialShininess_3D);k.material.setDiffuseColor(k,m.macro_colorByChain?this.chainColor:m.proteins_tubeColor);for(let r=0,t=this.tubes.length;r<t;r++)k.shader.setMatrixUniforms(k),this.tubes[r].render(k,m);m.macro_colorByChain||k.material.setDiffuseColor(k,m.proteins_ribbonCartoonHelixSecondaryColor);k.cylinderClosedBuffer.bindBuffers(k);
for(let r=0,t=this.helixCylinders.length;r<t;r++)this.helixCylinders[r].render(k,m);m.macro_colorByChain||k.material.setDiffuseColor(k,m.proteins_ribbonCartoonSheetColor);k.boxBuffer.bindBuffers(k);for(let r=0,t=this.sheetPlanks.length;r<t;r++)this.sheetPlanks[r].render(k,m)}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(q,B){q.Quad=function(){this.storeData([-1,1,0,-1,-1,0,1,1,0,1,-1,0],[0,0,0,0,0,0,0,0,0,0,0,0])};q.Quad.prototype=new q._Mesh})(ChemDoodle.structures.d3);
(function(q,B,w,u){B.Shape=function(l,n){var d=l.length;let e=[],c=[],b=new q.Point;for(let k=0,m=d;k<m;k++){var f=k+1;k===m-1&&(f=0);let r=l[k];var g=l[f];f=w.cross([0,0,1],[g.x-r.x,g.y-r.y,0]);for(let t=0;t<2;t++)e.push(r.x,r.y,n/2),e.push(r.x,r.y,-n/2),e.push(g.x,g.y,n/2),e.push(g.x,g.y,-n/2);for(g=0;g<4;g++)c.push(f[0],f[1],f[2]);c.push(0,0,1);c.push(0,0,-1);c.push(0,0,1);c.push(0,0,-1);b.add(r)}b.x/=d;b.y/=d;c.push(0,0,1);e.push(b.x,b.y,n/2);c.push(0,0,-1);e.push(b.x,b.y,-n/2);l=[];n=d*8;for(let k=
0,m=d;k<m;k++)d=k*8,l.push(d),l.push(d+3),l.push(d+1),l.push(d),l.push(d+2),l.push(d+3),l.push(d+4),l.push(n),l.push(d+6),l.push(d+5),l.push(d+7),l.push(n+1);this.storeData(e,c,l)};B.Shape.prototype=new B._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(q,B,w,u){q.Star=function(){let l=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,
.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],n=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,
13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],c=[];for(let k=0,m=n.length;k<m;k+=3){var b=n[k]*3,f=n[k+1]*3,g=n[k+2]*3;b=[l[b],l[b+1],l[b+2]];f=[l[f],l[f+1],l[f+2]];g=[l[g],l[g+1],l[g+2]];let r=w.cross([g[0]-f[0],g[1]-f[1],g[2]-f[2]],[b[0]-f[0],b[1]-f[1],b[2]-f[2]],[]);w.normalize(r);d.push(b[0],b[1],b[2],f[0],f[1],f[2],g[0],g[1],g[2]);e.push(r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2]);c.push(k,k+1,k+2)}this.storeData(d,e,c)};q.Star.prototype=
new q._Mesh})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(q,B,w,u,l){let n=1;u.devicePixelRatio&&(n=u.devicePixelRatio);q.TextImage=function(){this.ctx=w.createElement("canvas").getContext("2d");this.data=[];this.text="";this.charHeight=0};q=q.TextImage.prototype;q.init=function(d){this.textureImage=d.createTexture();d.bindTexture(d.TEXTURE_2D,this.textureImage);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.bindTexture(d.TEXTURE_2D,null);this.updateFont(d,12,["Sans-serif"],!1,!1,!1)};q.charData=function(d){d=this.text.indexOf(d);return d>=0?this.data[d]:null};q.updateFont=function(d,e,c,b,f,g){let k=this.ctx,m=this.ctx.canvas,r=[],t="";e*=n;c=B.getFontString(e,c,b,f);k.font=c;k.save();b=0;e*=1.5;for(let y=32,a=127;y<a;y++){f=String.fromCharCode(y);var v=k.measureText(f).width;r.push({text:f,width:v,height:e});
b+=v*2}f=["\u00b0","\u212b","\u00ae"];for(let y=0,a=f.length;y<a;y++){v=f[y];var x=k.measureText(v).width;r.push({text:v,width:x,height:e});b+=x*2}f=Math.ceil(Math.sqrt(b*e)/e);b=Math.ceil(b/(f-1));m.width=b;m.height=f*e;k.font=c;k.textAlign="left";k.textBaseline="middle";k.strokeStyle="#000";k.lineWidth=1.4;k.fillStyle="#fff";f=c=0;for(let y=0,a=r.length;y<a;y++){v=r[y];x=v.width*2;let h=v.height,p=v.text;f+x>b&&(c++,f=0);let z=c*h;g&&k.strokeText(p,f,z+h/2);k.fillText(p,f,z+h/2);v.x=f;v.y=z;t+=
p;f+=x}this.text=t;this.data=r;this.charHeight=e;d.bindTexture(d.TEXTURE_2D,this.textureImage);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,m);d.bindTexture(d.TEXTURE_2D,null)};q.pushVertexData=function(d,e,c,b){let f=d.toString().split(""),g=this.getHeight(),k=this.getWidth();d=-this.textWidth(d)/2/n;let m=-this.charHeight/2/n;for(let t=0,v=f.length;t<v;t++){var r=this.charData(f[t]);let x=r.width,y=r.x/k,a=y+r.width*1.8/k,h=r.y/g;r=h+r.height/g;let p=d+x*1.8/n,z=this.charHeight/2/n;
b.position.push(e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2]);b.texCoord.push(y,h,a,r,a,h,y,h,y,r,a,r);b.translation.push(d,z,c,p,m,c,p,z,c,d,z,c,d,m,c,p,m,c);d=p+(x-x*1.8)/n}};q.getCanvas=function(){return this.ctx.canvas};q.getHeight=function(){return this.getCanvas().height};q.getWidth=function(){return this.getCanvas().width};q.textWidth=function(d){return this.ctx.measureText(d).width};q.test=function(){w.body.appendChild(this.getCanvas())};q.useTexture=
function(d){d.bindTexture(d.TEXTURE_2D,this.textureImage)}})(ChemDoodle.structures.d3,ChemDoodle.extensions,document,window);
(function(q,B,w){q.TextMesh=function(){};q=q.TextMesh.prototype;q.init=function(u){this.vertexPositionBuffer=u.createBuffer();this.vertexTexCoordBuffer=u.createBuffer();this.vertexTranslationBuffer=u.createBuffer()};q.setVertexData=function(u,l,n,d){u.bindBuffer(u.ARRAY_BUFFER,l);u.bufferData(u.ARRAY_BUFFER,new Float32Array(n),u.STATIC_DRAW);l.itemSize=d;l.numItems=n.length/d};q.storeData=function(u,l,n,d){this.setVertexData(u,this.vertexPositionBuffer,l,3);this.setVertexData(u,this.vertexTexCoordBuffer,
n,2);this.setVertexData(u,this.vertexTranslationBuffer,d,3)};q.bindBuffers=function(u){u.bindBuffer(u.ARRAY_BUFFER,this.vertexPositionBuffer);u.vertexAttribPointer(u.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,u.FLOAT,!1,0,0);u.bindBuffer(u.ARRAY_BUFFER,this.vertexTexCoordBuffer);u.vertexAttribPointer(u.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,u.FLOAT,!1,0,0);u.bindBuffer(u.ARRAY_BUFFER,this.vertexTranslationBuffer);u.vertexAttribPointer(u.shader.vertexNormalAttribute,
this.vertexTranslationBuffer.itemSize,u.FLOAT,!1,0,0)};q.render=function(u){let l=this.vertexPositionBuffer.numItems;l&&(this.bindBuffers(u),u.drawArrays(u.TRIANGLES,0,l))}})(ChemDoodle.structures.d3,Math);
(function(q,B,w,u,l,n,d){w.Torsion=function(e,c,b,f){this.a1=e;this.a2=c;this.a3=b;this.a4=f};q=w.Torsion.prototype=new w._Measurement;q.calculateData=function(e){let c=[],b=[],f=[];var g=this.a2.distance3D(this.a1),k=this.a2.distance3D(this.a3);this.distUse=u.min(g,k)/2;k=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];g=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z];var m=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],r=n.cross(k,g,[]);m=n.cross(g,m,[]);
n.scale(k,n.length(g));this.torsion=u.atan2(n.dot(k,m),n.dot(r,m));r=n.normalize(n.cross(r,g,[]));k=n.normalize(n.cross(g,r,[]));this.pos=n.add([this.a2.x,this.a2.y,this.a2.z],n.scale(n.normalize(g,[]),this.distUse));m=[];let t=e.measurement_angleBands_3D;var v=d;for(e=0;e<=t;++e){var x=this.torsion*e/t;v=n.scale(r,u.cos(x),[]);x=n.scale(k,u.sin(x),[]);v=n.scale(n.normalize(n.add(v,x,[])),this.distUse);e==0&&(m=v);c.push(this.pos[0]+v[0],this.pos[1]+v[1],this.pos[2]+v[2]);b.push(0,0,0);e<t&&f.push(e,
e+1)}this.vecText=n.normalize(n.add(m,v,[]));g=n.normalize(g,[]);n.scale(g,.0625);m=this.torsion-u.asin(.125)*2*this.torsion/u.abs(this.torsion);r=n.scale(r,u.cos(m),[]);k=n.scale(k,u.sin(m),[]);v=n.scale(n.normalize(n.add(r,k,[])),this.distUse);c.push(this.pos[0]+g[0]+v[0],this.pos[1]+g[1]+v[1],this.pos[2]+g[2]+v[2]);b.push(0,0,0);c.push(this.pos[0]-g[0]+v[0],this.pos[1]-g[1]+v[1],this.pos[2]-g[2]+v[2]);b.push(0,0,0);f.push(--e,e+1,e,e+2);this.storeData(c,b,f)};q.getText=function(e){n.add(this.pos,
n.scale(this.vecText,this.distUse+.3,[]));return{pos:this.pos,value:[B.angleBounds(this.torsion,!0,!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w,u,l,n,d,e,c){let b=function(g,k){g.bindBuffer(g.ARRAY_BUFFER,k.vertexPositionBuffer);g.vertexAttribPointer(g.shader.vertexPositionAttribute,k.vertexPositionBuffer.itemSize,g.FLOAT,!1,0,0);g.bindBuffer(g.ARRAY_BUFFER,k.vertexNormalBuffer);g.vertexAttribPointer(g.shader.vertexNormalAttribute,k.vertexNormalBuffer.itemSize,g.FLOAT,!1,0,0);g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,k.vertexIndexBuffer)},f=function(g,k,m){let r=l.sqrt(k[1]*k[1]+k[2]*k[2]),t=[1,0,0,0,0,k[2]/r,-k[1]/r,0,0,k[1]/r,
k[2]/r,0,0,0,0,1],v=[1,0,0,0,0,k[2]/r,k[1]/r,0,0,-k[1]/r,k[2]/r,0,0,0,0,1],x=[r,0,-k[0],0,0,1,0,0,k[0],0,r,0,0,0,0,1];k=[r,0,k[0],0,0,1,0,0,-k[0],0,r,0,0,0,0,1];m=[l.cos(m),-l.sin(m),0,0,l.sin(m),l.cos(m),0,0,0,0,1,0,0,0,0,1];let y=n.multiply(t,n.multiply(x,n.multiply(m,n.multiply(k,v,[]))));this.rotate=function(){return n.multiplyVec3(y,g)}};u.Tube=function(g,k,m){var r=g[0].lineSegments[0].length;this.partitions=[];this.ends=[];this.ends.push(g[0].lineSegments[0][0]);this.ends.push(g[g.length-1].lineSegments[0][0]);
var t=[1,0,0];for(let A=0,C=g.length;A<C;A++){if(!v||v.positionData.length>65E3){this.partitions.length>0&&A--;var v={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(v)}var x=g[A];v.count++;var y=Infinity,a=new w.Atom("",g[A].cp1.x,g[A].cp1.y,g[A].cp1.z);for(let D=0;D<r;D++){let E=x.lineSegments[0][D];var h=void 0;h=D===r-1?A===g.length-1?x.lineSegments[0][D-1]:g[A+1].lineSegments[0][0]:x.lineSegments[0][D+1];h=[h.x-E.x,h.y-E.y,h.z-E.z];d.normalize(h);A===g.length-1&&D===
r-1&&d.scale(h,-1);var p=d.cross(h,t,[]);d.normalize(p);d.scale(p,k/2);h=new f(p,h,2*Math.PI/m);for(let F=0,G=m;F<G;F++)p=h.rotate(),F===l.floor(m/4)&&(t=[p[0],p[1],p[2]]),v.normalData.push(p[0],p[1],p[2]),v.positionData.push(E.x+p[0],E.y+p[1],E.z+p[2]);a&&(h=E.distance3D(a),h<y&&(y=h,g[A].pPoint=E))}}for(let A=0,C=this.partitions.length;A<C;A++){v=this.partitions[A];for(let D=0,E=v.count-1;D<E;D++){t=D*r*m;for(let F=0,G=r;F<G;F++)for(x=t+F*m,y=0;y<m;y++)a=x+y,v.indexData.push(a),v.indexData.push(a+
m),v.indexData.push(a+m+1),v.indexData.push(a),v.indexData.push(a+m+1),v.indexData.push(a+1)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);m=[new w.Point(2,0)];for(r=0;r<60;r++)v=r/60*l.PI,m.push(new w.Point(2*l.cos(v),-2*l.sin(v)));m.push(new w.Point(-2,0),new w.Point(-2,4),new w.Point(2,4));let z=new w.d3.Shape(m,1);this.render=function(A,C){this.bindBuffers(A);A.material.setDiffuseColor(A,C.macro_colorByChain?this.chainColor:C.nucleics_tubeColor);
A.drawElements(A.TRIANGLES,this.vertexIndexBuffer.numItems,A.UNSIGNED_SHORT,0);if(this.partitions)for(let H=1,R=this.partitions.length;H<R;H++){var D=this.partitions[H];b(A,D);A.drawElements(A.TRIANGLES,D.vertexIndexBuffer.numItems,A.UNSIGNED_SHORT,0)}A.sphereBuffer.bindBuffers(A);for(D=0;D<2;D++){var E=this.ends[D];E=n.translate(n.identity(),[E.x,E.y,E.z]);var F=k/2;n.scale(E,[F,F,F]);A.shader.setMatrixUniforms(A,E);A.drawElements(A.TRIANGLES,A.sphereBuffer.vertexIndexBuffer.numItems,A.UNSIGNED_SHORT,
0)}A.cylinderBuffer.bindBuffers(A);for(let H=0,R=g.length-1;H<R;H++){E=g[H];D=E.pPoint;E=new w.Atom("",E.cp2.x,E.cp2.y,E.cp2.z);F=1.001*D.distance3D(E);F=[k/4,F,k/4];var G=n.translate(n.identity(),[D.x,D.y,D.z]),I=[0,1,0],J=0,M=[E.x-D.x,E.y-D.y,E.z-D.z];D.x===E.x&&D.z===E.z?(E=[0,0,1],D.y<D.y&&(J=l.PI)):(J=q.vec3AngleFrom(I,M),E=d.cross(I,M,[]));J!==0&&n.rotate(G,J,E);n.scale(G,F);A.shader.setMatrixUniforms(A,G);A.drawArrays(A.TRIANGLE_STRIP,0,A.cylinderBuffer.vertexPositionBuffer.numItems)}z.bindBuffers(A);
C.nucleics_residueColor!=="none"||C.macro_colorByChain||A.material.setDiffuseColor(A,C.nucleics_baseColor);for(let H=0,R=g.length-1;H<R;H++)if(D=g[H],G=D.cp2,E=n.translate(n.identity(),[G.x,G.y,G.z]),I=[0,1,0],J=0,M=D.cp3){F=[M.x-G.x,M.y-G.y,M.z-G.z];G.x===M.x&&G.z===M.z?(I=[0,0,1],G.y<G.y&&(J=l.PI)):(J=q.vec3AngleFrom(I,F),I=d.cross(I,F,[]));J!==0&&n.rotate(E,J,I);G=[1,0,0];J=n.rotate(n.identity([]),J,I);n.multiplyVec3(J,G);J=D.cp4;I=D.cp5;if(J.y!==I.y||J.z!==I.z)J=[I.x-J.x,I.y-J.y,I.z-J.z],I=q.vec3AngleFrom(G,
J),d.dot(F,d.cross(G,J))<0&&(I*=-1),n.rotateY(E,I);C.macro_colorByChain||(C.nucleics_residueColor==="shapely"?B[D.name]?A.material.setDiffuseColor(A,B[D.name].shapelyColor):A.material.setDiffuseColor(A,B["*"].shapelyColor):C.nucleics_residueColor==="rainbow"&&A.material.setDiffuseColor(A,e.rainbowAt(H,R,C.macro_rainbowColors)));A.shader.setMatrixUniforms(A,E);A.drawElements(A.TRIANGLES,z.vertexIndexBuffer.numItems,A.UNSIGNED_SHORT,0)}}};u.Tube.prototype=new u._Mesh;u.CatmullTube=function(g,k,m,r){var t=
[];g.push(g[g.length-1]);for(let A=0,C=g.length-2;A<=C;A++){var v=g[A==0?0:A-1],x=g[A+0],y=g[A+1],a=g[A==C?A+1:A+2],h=[];for(let D=0;D<r;D++){var p=D/r;A==C&&(p=D/(r-1));p=new w.Atom("C",.5*(2*x.x+(y.x-v.x)*p+(2*v.x-5*x.x+4*y.x-a.x)*p*p+(3*x.x-v.x-3*y.x+a.x)*p*p*p),.5*(2*x.y+(y.y-v.y)*p+(2*v.y-5*x.y+4*y.y-a.y)*p*p+(3*x.y-v.y-3*y.y+a.y)*p*p*p),.5*(2*x.z+(y.z-v.z)*p+(2*v.z-5*x.z+4*y.z-a.z)*p*p+(3*x.z-v.z-3*y.z+a.z)*p*p*p));h.push(p)}t.push(h)}g=t[0].length;this.partitions=[];this.ends=[];this.ends.push(t[0][0]);
this.ends.push(t[t.length-1][0]);r=[1,0,0];for(let A=0,C=t.length;A<C;A++){if(!z||z.positionData.length>65E3){this.partitions.length>0&&A--;var z={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(z)}v=t[A];z.count++;for(x=0;x<g;x++){y=v[x];a=x===g-1?A===t.length-1?v[x-1]:t[A+1][0]:v[x+1];a=[a.x-y.x,a.y-y.y,a.z-y.z];d.normalize(a);A===t.length-1&&x===g-1&&d.scale(a,-1);h=d.cross(a,r,[]);d.normalize(h);d.scale(h,k/2);a=new f(h,a,2*Math.PI/m);for(let D=0,E=m;D<E;D++)h=a.rotate(),
D===l.floor(m/4)&&(r=[h[0],h[1],h[2]]),z.normalData.push(h[0],h[1],h[2]),z.positionData.push(y.x+h[0],y.y+h[1],y.z+h[2])}}for(let A=0,C=this.partitions.length;A<C;A++){k=this.partitions[A];for(let D=0,E=k.count-1;D<E;D++){t=D*g*m;for(let F=0,G=g;F<G;F++)for(z=t+F*m,r=0;r<=m;r++)v=z+r%m,k.indexData.push(v,v+m)}}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)};(u.CatmullTube.prototype=new u._Mesh).render=function(g,k){this.bindBuffers(g);for(let t=
0,v=this.partitions.length;t<v;t++){var m=this.partitions[t];b(g,m);g.drawElements(g.TRIANGLE_STRIP,m.vertexIndexBuffer.numItems,g.UNSIGNED_SHORT,0)}g.sphereBuffer.bindBuffers(g);for(m=0;m<2;m++){var r=this.ends[m];r=n.translate(n.identity(),[r.x,r.y,r.z]);let t=k.proteins_tubeThickness/2;n.scale(r,[t,t,t]);g.shader.setMatrixUniforms(g,r);g.drawElements(g.TRIANGLES,g.sphereBuffer.vertexIndexBuffer.numItems,g.UNSIGNED_SHORT,0)}}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,
Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(q,B,w,u,l){q.UnitCell=function(n,d,e){this.lengths=n;this.angles=d;this.offset=e;n=B.CIFInterpreter.generateABC2XYZ(n[0],n[1],n[2],d[0],d[1],d[2]);e||(this.offset=[0,0,0]);this.unitCellVectors={o:w.multiplyVec3(n,this.offset,[]),x:w.multiplyVec3(n,[this.offset[0]+1,this.offset[1],this.offset[2]]),y:w.multiplyVec3(n,[this.offset[0],this.offset[1]+1,this.offset[2]]),z:w.multiplyVec3(n,[this.offset[0],this.offset[1],this.offset[2]+1]),xy:w.multiplyVec3(n,[this.offset[0]+1,this.offset[1]+1,
this.offset[2]]),xz:w.multiplyVec3(n,[this.offset[0]+1,this.offset[1],this.offset[2]+1]),yz:w.multiplyVec3(n,[this.offset[0],this.offset[1]+1,this.offset[2]+1]),xyz:w.multiplyVec3(n,[this.offset[0]+1,this.offset[1]+1,this.offset[2]+1])};let c=[],b=[];e=function(f,g,k,m){c.push(f[0],f[1],f[2]);c.push(g[0],g[1],g[2]);c.push(k[0],k[1],k[2]);c.push(m[0],m[1],m[2]);for(f=0;f<4;f++)b.push(0,0,0)};e(this.unitCellVectors.o,this.unitCellVectors.x,this.unitCellVectors.xy,this.unitCellVectors.y);e(this.unitCellVectors.o,
this.unitCellVectors.y,this.unitCellVectors.yz,this.unitCellVectors.z);e(this.unitCellVectors.o,this.unitCellVectors.z,this.unitCellVectors.xz,this.unitCellVectors.x);e(this.unitCellVectors.yz,this.unitCellVectors.y,this.unitCellVectors.xy,this.unitCellVectors.xyz);e(this.unitCellVectors.xyz,this.unitCellVectors.xz,this.unitCellVectors.z,this.unitCellVectors.yz);e(this.unitCellVectors.xy,this.unitCellVectors.x,this.unitCellVectors.xz,this.unitCellVectors.xyz);e=[];for(n=0;n<6;n++)d=n*4,e.push(d,d+
1,d+1,d+2,d+2,d+3,d+3,d);this.storeData(c,b,e)};(q.UnitCell.prototype=new q._Mesh).render=function(n,d){n.shader.setMatrixUniforms(n);this.bindBuffers(n);n.material.setDiffuseColor(n,d.shapes_color);n.lineWidth(d.shapes_lineWidth);n.drawElements(n.LINES,this.vertexIndexBuffer.numItems,n.UNSIGNED_SHORT,0)}})(ChemDoodle.structures.d3,ChemDoodle.io,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w,u){q.Framebuffer=function(){};q=q.Framebuffer.prototype;q.init=function(l){this.framebuffer=l.createFramebuffer()};q.setColorTexture=function(l,n,d){d=d===u?0:d;l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);l.bindTexture(l.TEXTURE_2D,n);l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+d,l.TEXTURE_2D,n,0);l.bindTexture(l.TEXTURE_2D,null);l.bindFramebuffer(l.FRAMEBUFFER,null)};q.setColorRenderbuffer=function(l,n,d){d=d===u?0:d;l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);
l.bindRenderbuffer(l.RENDERBUFFER,n);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+d,l.RENDERBUFFER,n);l.bindRenderbuffer(l.RENDERBUFFER,null);l.bindFramebuffer(l.FRAMEBUFFER,null)};q.setDepthTexture=function(l,n){l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);l.bindTexture(l.TEXTURE_2D,n);l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,n,0);l.bindTexture(l.TEXTURE_2D,null);l.bindFramebuffer(l.FRAMEBUFFER,null)};q.setDepthRenderbuffer=function(l,n){l.bindFramebuffer(l.FRAMEBUFFER,
this.framebuffer);l.bindRenderbuffer(l.RENDERBUFFER,n);l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,n);l.bindRenderbuffer(l.RENDERBUFFER,null);l.bindFramebuffer(l.FRAMEBUFFER,null)};q.bind=function(l,n,d){l.bindFramebuffer(l.FRAMEBUFFER,this.framebuffer);l.viewport(0,0,n,d)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(q,B,w,u){q.Renderbuffer=function(){};q=q.Renderbuffer.prototype;q.init=function(l,n){this.renderbuffer=l.createRenderbuffer();this.format=n};q.setParameter=function(l,n,d){this.width=n;this.height=d;l.bindRenderbuffer(l.RENDERBUFFER,this.renderbuffer);l.renderbufferStorage(l.RENDERBUFFER,this.format,this.width,this.height);l.bindRenderbuffer(l.RENDERBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(q,B,w,u){B.SSAO=function(){};q=B.SSAO.prototype;q.initSampleKernel=function(l){let n=[];for(let e=0;e<l;e++){let c=w.random()*2-1,b=w.random()*2-1,f=w.random()*2-1;var d=e/l;d=.1+d*d*.9;c*=d;b*=d;f*=d;n.push(c,b,f)}this.sampleKernel=new Float32Array(n)};q.initNoiseTexture=function(l){let n=[];for(let d=0;d<16;d++)n.push(w.random()*2-1),n.push(w.random()*2-1),n.push(0);this.noiseTexture=l.createTexture();l.bindTexture(l.TEXTURE_2D,this.noiseTexture);l.texImage2D(l.TEXTURE_2D,0,l.RGB,4,4,
0,l.RGB,l.FLOAT,new Float32Array(n));l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT);l.bindTexture(l.TEXTURE_2D,null)}})(ChemDoodle.math,ChemDoodle.structures.d3,Math);
(function(q,B,w,u){q.Texture=function(){};q=q.Texture.prototype;q.init=function(l,n,d,e){this.texture=l.createTexture();this.type=n;this.internalFormat=d;this.format=e!==u?e:d;l.bindTexture(l.TEXTURE_2D,this.texture);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE);l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE);l.bindTexture(l.TEXTURE_2D,null)};q.setParameter=
function(l,n,d){this.width=n;this.height=d;l.bindTexture(l.TEXTURE_2D,this.texture);l.texImage2D(l.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null);l.bindTexture(l.TEXTURE_2D,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(q,B,w,u,l){q._Shader=function(){};q=q._Shader.prototype;q.useShaderProgram=function(n){n.useProgram(this.gProgram);n.shader=this};q.init=function(n){let d=this.getShader(n,"vertex-shader");d||=this.loadDefaultVertexShader(n);let e=this.getShader(n,"fragment-shader");e||=this.loadDefaultFragmentShader(n);this.gProgram=n.createProgram();n.attachShader(this.gProgram,d);n.attachShader(this.gProgram,e);this.onShaderAttached(n);n.linkProgram(this.gProgram);n.getProgramParameter(this.gProgram,
n.LINK_STATUS)||alert("Could not initialize shaders: "+n.getProgramInfoLog(this.gProgram));n.useProgram(this.gProgram);this.initUniformLocations(n);n.useProgram(null)};q.onShaderAttached=function(n){this.vertexPositionAttribute=0;this.vertexNormalAttribute=1;n.bindAttribLocation(this.gProgram,this.vertexPositionAttribute,"a_vertex_position");n.bindAttribLocation(this.gProgram,this.vertexNormalAttribute,"a_vertex_normal")};q.getShaderFromStr=function(n,d,e){let c=n.createShader(d);n.shaderSource(c,
e);n.compileShader(c);return n.getShaderParameter(c,n.COMPILE_STATUS)?c:(alert(d+" "+n.getShaderInfoLog(c)),n.deleteShader(c),l)};q.enableAttribsArray=function(n){n.enableVertexAttribArray(this.vertexPositionAttribute)};q.disableAttribsArray=function(n){n.disableVertexAttribArray(this.vertexPositionAttribute)};q.getShader=function(n,d){d=u.getElementById(d);if(!d)return l;var e=[];let c=d.firstChild;for(;c;)c.nodeType===3&&e.push(c.textContent),c=c.nextSibling;e=e.join("");if(d.type==="x-shader/x-fragment")n=
this.getShaderFromStr(n,n.FRAGMENT_SHADER,e);else if(d.type==="x-shader/x-vertex")n=this.getShaderFromStr(n,n.VERTEX_SHADER,e);else return l;return n};q.initUniformLocations=function(n){this.modelViewMatrixUniform=n.getUniformLocation(this.gProgram,"u_model_view_matrix");this.projectionMatrixUniform=n.getUniformLocation(this.gProgram,"u_projection_matrix")};q.loadDefaultVertexShader=function(n){};q.loadDefaultFragmentShader=function(n){};q.setMatrixUniforms=function(n,d){d===l?this.setModelViewMatrix(n,
n.modelViewMatrix):this.setModelViewMatrix(n,w.multiply(n.modelViewMatrix,d,[]))};q.setProjectionMatrix=function(n,d){n.uniformMatrix4fv(this.projectionMatrixUniform,!1,d)};q.setModelViewMatrix=function(n,d){n.uniformMatrix4fv(this.modelViewMatrixUniform,!1,d)};q.setMaterialAmbientColor=function(n,d){};q.setMaterialDiffuseColor=function(n,d){};q.setMaterialSpecularColor=function(n,d){};q.setMaterialShininess=function(n,d){};q.setMaterialAlpha=function(n,d){}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,
ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.FXAAShader=function(){};let n=q._Shader.prototype;q=q.FXAAShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.antialiasUniform=d.getUniformLocation(this.gProgram,"u_antialias");this.edgeThresholdUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold");this.edgeThresholdMinUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold_min");this.searchStepsUniform=
d.getUniformLocation(this.gProgram,"u_search_steps");this.searchThresholdUniform=d.getUniformLocation(this.gProgram,"u_search_threshold");this.subpixCapUniform=d.getUniformLocation(this.gProgram,"u_subpix_cap");this.subpixTrimUniform=d.getUniformLocation(this.gProgram,"u_subpix_trim")};q.setBuffersize=function(d,e,c){d.uniform2f(this.buffersizeUniform,e,c)};q.setAntialias=function(d,e){d.uniform1f(this.antialiasUniform,e)};q.setEdgeThreshold=function(d,e){d.uniform1f(this.edgeThresholdUniform,e)};
q.setEdgeThresholdMin=function(d,e){d.uniform1f(this.edgeThresholdMinUniform,e)};q.setSearchSteps=function(d,e){d.uniform1i(this.searchStepsUniform,e)};q.setSearchThreshold=function(d,e){d.uniform1f(this.searchThresholdUniform,e)};q.setSubpixCap=function(d,e){d.uniform1f(this.subpixCapUniform,e)};q.setSubpixTrim=function(d,e){d.uniform1f(this.subpixTrimUniform,e)};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n    \tvarying vec2 v_texcoord;\n\n\t\tvoid main() {\n\t\t\tgl_Position \x3d vec4(a_vertex_position, 1.);\n        \tv_texcoord \x3d a_vertex_position.xy * .5 + .5;\n\t\t}")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\tprecision mediump float;\n\n\t\tconst int fxaaMaxSearchSteps \x3d 128;\n\n\t\tuniform float u_edge_threshold;\n\t\tuniform float u_edge_threshold_min;\n\t\tuniform int u_search_steps;\n\t\tuniform float u_search_threshold;\n\t\tuniform float u_subpix_cap;\n\t\tuniform float u_subpix_trim;\n\n\t\tuniform sampler2D u_sampler0;\n\t\tuniform vec2 u_buffersize;\n\t\tuniform bool u_antialias;\n\n\t\tvarying vec2 v_texcoord;\n\n\t\tfloat FxaaLuma(vec3 rgb) {\n\t\t\treturn rgb.y * (0.587/0.299) + rgb.x;\n\t\t}\n\n\t\tvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\n\t\t    return (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n\t\t}\n\n\t\tvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 off, vec2 rcpFrame) {\n\t\t    return texture2D(tex, pos + off * rcpFrame);\n\t\t}\n\n\t\tvec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\n\t\t\tfloat subpix_trim_scale \x3d (1.0/(1.0 - u_subpix_trim));\n\t\t    vec3 rgbN \x3d FxaaTexOff(tex, pos.xy, vec2( 0.,-1.), rcpFrame).xyz;\n\t\t    vec3 rgbW \x3d FxaaTexOff(tex, pos.xy, vec2(-1., 0.), rcpFrame).xyz;\n\t\t    vec3 rgbM \x3d FxaaTexOff(tex, pos.xy, vec2( 0., 0.), rcpFrame).xyz;\n\t\t    vec3 rgbE \x3d FxaaTexOff(tex, pos.xy, vec2( 1., 0.), rcpFrame).xyz;\n\t\t    vec3 rgbS \x3d FxaaTexOff(tex, pos.xy, vec2( 0., 1.), rcpFrame).xyz;\n\n\t\t    float lumaN \x3d FxaaLuma(rgbN);\n\t\t    float lumaW \x3d FxaaLuma(rgbW);\n\t\t    float lumaM \x3d FxaaLuma(rgbM);\n\t\t    float lumaE \x3d FxaaLuma(rgbE);\n\t\t    float lumaS \x3d FxaaLuma(rgbS);\n\t\t    float rangeMin \x3d min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\n\t\t    float rangeMax \x3d max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\n\n\t\t    float range \x3d rangeMax - rangeMin;\n\t\t    if(range \x3c max(u_edge_threshold_min, rangeMax * u_edge_threshold)) {\n\t\t        return rgbM;\n\t\t    }\n\n\t\t    vec3 rgbL \x3d rgbN + rgbW + rgbM + rgbE + rgbS;\n\n\t\t    float lumaL \x3d (lumaN + lumaW + lumaE + lumaS) * 0.25;\n\t\t    float rangeL \x3d abs(lumaL - lumaM);\n\t\t    float blendL \x3d max(0.0, (rangeL / range) - u_subpix_trim) * subpix_trim_scale;\n\t\t    blendL \x3d min(u_subpix_cap, blendL);\n\n\t\t    vec3 rgbNW \x3d FxaaTexOff(tex, pos.xy, vec2(-1.,-1.), rcpFrame).xyz;\n\t\t    vec3 rgbNE \x3d FxaaTexOff(tex, pos.xy, vec2( 1.,-1.), rcpFrame).xyz;\n\t\t    vec3 rgbSW \x3d FxaaTexOff(tex, pos.xy, vec2(-1., 1.), rcpFrame).xyz;\n\t\t    vec3 rgbSE \x3d FxaaTexOff(tex, pos.xy, vec2( 1., 1.), rcpFrame).xyz;\n\t\t    rgbL +\x3d (rgbNW + rgbNE + rgbSW + rgbSE);\n\t\t    rgbL *\x3d vec3(1.0/9.0);\n\n\t\t    float lumaNW \x3d FxaaLuma(rgbNW);\n\t\t    float lumaNE \x3d FxaaLuma(rgbNE);\n\t\t    float lumaSW \x3d FxaaLuma(rgbSW);\n\t\t    float lumaSE \x3d FxaaLuma(rgbSE);\n\n\t\t    float edgeVert \x3d\n\t\t        abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\n\t\t        abs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\n\t\t        abs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\n\t\t    float edgeHorz \x3d\n\t\t        abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\n\t\t        abs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\n\t\t        abs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\n\n\t\t    bool horzSpan \x3d edgeHorz \x3e\x3d edgeVert;\n\t\t    float lengthSign \x3d horzSpan ? -rcpFrame.y : -rcpFrame.x;\n\n\t\t    if(!horzSpan) {\n\t\t        lumaN \x3d lumaW;\n\t\t        lumaS \x3d lumaE;\n\t\t    }\n\n\t\t    float gradientN \x3d abs(lumaN - lumaM);\n\t\t    float gradientS \x3d abs(lumaS - lumaM);\n\t\t    lumaN \x3d (lumaN + lumaM) * 0.5;\n\t\t    lumaS \x3d (lumaS + lumaM) * 0.5;\n\n\t\t    if (gradientN \x3c gradientS) {\n\t\t        lumaN \x3d lumaS;\n\t\t        lumaN \x3d lumaS;\n\t\t        gradientN \x3d gradientS;\n\t\t        lengthSign *\x3d -1.0;\n\t\t    }\n\n\t\t    vec2 posN;\n\t\t    posN.x \x3d pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\n\t\t    posN.y \x3d pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\n\n\t\t    gradientN *\x3d u_search_threshold;\n\n\t\t    vec2 posP \x3d posN;\n\t\t    vec2 offNP \x3d horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\n\t\t    float lumaEndN \x3d lumaN;\n\t\t    float lumaEndP \x3d lumaN;\n\t\t    bool doneN \x3d false;\n\t\t    bool doneP \x3d false;\n\t\t    posN +\x3d offNP * vec2(-1.0, -1.0);\n\t\t    posP +\x3d offNP * vec2( 1.0,  1.0);\n\n\t\t    for(int i \x3d 0; i \x3c fxaaMaxSearchSteps; i++) {\n\t\t    \tif(i \x3e\x3d u_search_steps) break;\n\t\t        if(!doneN) {\n\t\t            lumaEndN \x3d FxaaLuma(texture2D(tex, posN.xy).xyz);\n\t\t        }\n\t\t        if(!doneP) {\n\t\t            lumaEndP \x3d FxaaLuma(texture2D(tex, posP.xy).xyz);\n\t\t        }\n\n\t\t        doneN \x3d doneN || (abs(lumaEndN - lumaN) \x3e\x3d gradientN);\n\t\t        doneP \x3d doneP || (abs(lumaEndP - lumaN) \x3e\x3d gradientN);\n\n\t\t        if(doneN \x26\x26 doneP) {\n\t\t            break;\n\t\t        }\n\t\t        if(!doneN) {\n\t\t            posN -\x3d offNP;\n\t\t        }\n\t\t        if(!doneP) {\n\t\t            posP +\x3d offNP;\n\t\t        }\n\t\t    }\n\n\t\t    float dstN \x3d horzSpan ? pos.x - posN.x : pos.y - posN.y;\n\t\t    float dstP \x3d horzSpan ? posP.x - pos.x : posP.y - pos.y;\n\t\t    bool directionN \x3d dstN \x3c dstP;\n\t\t    lumaEndN \x3d directionN ? lumaEndN : lumaEndP;\n\n\t\t    if(((lumaM - lumaN) \x3c 0.0) \x3d\x3d ((lumaEndN - lumaN) \x3c 0.0)) {\n\t\t        lengthSign \x3d 0.0;\n\t\t    }\n\n\n\t\t    float spanLength \x3d (dstP + dstN);\n\t\t    dstN \x3d directionN ? dstN : dstP;\n\t\t    float subPixelOffset \x3d (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\n\t\t    vec3 rgbF \x3d texture2D(tex, vec2(\n\t\t        pos.x + (horzSpan ? 0.0 : subPixelOffset),\n\t\t        pos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\n\t\t    return FxaaLerp3(rgbL, rgbF, blendL);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tgl_FragColor \x3d texture2D(u_sampler0, v_texcoord);\n\t\t\tif(u_antialias) {\n\t\t\t\tgl_FragColor.xyz \x3d FxaaPixelShader(v_texcoord, u_sampler0, 1. / u_buffersize).xyz;\n\t\t\t}\n\t\t}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.SMAAEdgesShader=function(){};let n=q._Shader.prototype;q=q.SMAAEdgesShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.edgeThresholdUniform=d.getUniformLocation(this.gProgram,"u_threshold");this.contrastFactorUniform=d.getUniformLocation(this.gProgram,"u_contrast_factor");this.backgroundColorUniform=d.getUniformLocation(this.gProgram,"u_bgnd_color");
this.imageSamplerUniform=d.getUniformLocation(this.gProgram,"u_image_sampler")};q.setBuffersize=function(d,e,c){d.uniform2f(this.buffersizeUniform,e,c)};q.setEdgeThreshold=function(d,e){d.uniform1f(this.edgeThresholdUniform,e)};q.setContrastFactor=function(d,e){d.uniform1f(this.contrastFactorUniform,e)};q.setBackgroundColor=function(d,e,c,b){d.uniform3f(this.backgroundColorUniform,e,c,b)};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\t\tprecision highp float;\n\n\t\t\tattribute vec3 a_vertex_position;\n\t\t\tuniform vec2 u_buffersize;\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec4 vOffset[3];\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 resVals \x3d vec2(1.0 / u_buffersize.x, 1.0 / u_buffersize.y);\n\n\t\t\t\tvTexCoord \x3d vec2((a_vertex_position.xy + 1.0) / 2.0);\n\n\t\t\t\t// Set UVs of offset checks as varyings to be more efficient in frag shader\n\t\t\t\tvOffset[0] \x3d vTexCoord.xyxy + resVals.xyxy * vec4(-1.0, 0.0, 0.0, -1.0);\n\t\t\t\tvOffset[1] \x3d vTexCoord.xyxy + resVals.xyxy * vec4( 1.0, 0.0, 0.0, 1.0);\n\t\t\t\tvOffset[2] \x3d vTexCoord.xyxy + resVals.xyxy * vec4(-2.0, 0.0, 0.0, -2.0);\n\n\t\t\t\tgl_Position \x3d vec4(a_vertex_position.xy, 0.0, 1.0);\n\t\t\t}\n\t\t")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\t\tprecision highp float;\n\t\t\t\n\t\t\tuniform float u_threshold;\n\t\t\tuniform float u_contrast_factor;\n\t\t\tuniform sampler2D u_image_sampler;\n\t\t\tuniform vec3 u_bgnd_color;\n\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec4 vOffset[3];\n\n\t\t\tvec3 handleAlpha(vec4 color) {\n\t\t\t\t// Allows for edge detection between transparent and non-transparent sections by forcing full transparency to background color\n\t\t\t\tif (color.a \x3c 1e-6) {\n\t\t\t\t\tcolor \x3d vec4(u_bgnd_color, 1.);\n\t\t\t\t}\n\t\t\t\treturn color.rgb;\n\t\t\t}\n\t\t\t\t\n\t\t\tfloat calcColDelta(vec3 col, vec2 offset) {\n\t\t\t\t// Calculates the max difference of color from one direction from the fragment\n\t\t\t\tvec3 colDir \x3d handleAlpha(texture2D(u_image_sampler, offset));\n\t\t\t\tvec3 tDiff \x3d abs(col - colDir);\n\t\t\t\treturn max(max(tDiff.r, tDiff.g), tDiff.b);\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\t// Get the base color at fragment position\n\t\t\t\tvec4 delta;\n\t\t\t\tvec3 col \x3d handleAlpha(texture2D(u_image_sampler, vTexCoord));\n\n\t\t\t\t// Get the color deltas for the left and top positions\n\t\t\t\tdelta.x \x3d calcColDelta(col, vOffset[0].xy);\n\t\t\t\tdelta.y \x3d calcColDelta(col, vOffset[0].zw);\n\n\t\t\t\t// Threshold check to leave when there is no edge\n\t\t\t\tvec2 edges \x3d step(u_threshold, delta.xy);\n\t\t\t\tif (dot(edges, vec2(1.0, 1.0)) \x3d\x3d 0.0) { discard; }\n\n\t\t\t\t// Get the color deltas for the right and bottom positions\n\t\t\t\tdelta.z \x3d calcColDelta(col, vOffset[1].xy);\n\t\t\t\tdelta.w \x3d calcColDelta(col, vOffset[1].zw);\n\n\t\t\t\t// Get the max color delta of these four positions\n\t\t\t\tvec2 maxDelta \x3d max(delta.xy, delta.zw);\n\n\t\t\t\t// Get the color deltas for the pixels next positions further left and top\n\t\t\t\tdelta.z \x3d calcColDelta(col, vOffset[2].xy);\n\t\t\t\tdelta.w \x3d calcColDelta(col, vOffset[2].zw);\n\n\t\t\t\t// Get the max color delta from all of these\n\t\t\t\tmaxDelta \x3d max(maxDelta.xy, delta.zw);\n\t\t\t\tfloat finalDelta \x3d max(maxDelta.x, maxDelta.y);\n\n\t\t\t\t// Adjust for local contrast\n\t\t\t\tedges.xy *\x3d step(finalDelta, u_contrast_factor * delta.xy);\n\n\t\t\t\tgl_FragColor \x3d vec4(edges, 0.0, 1.0);\n\t\t\t}\n\t\t")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.SMAAWeightsShader=function(){};let n=q._Shader.prototype;q=q.SMAAWeightsShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.searchStepsUniform=d.getUniformLocation(this.gProgram,"u_search_steps");this.edgesSamplerUniform=d.getUniformLocation(this.gProgram,"u_edges_sampler");this.areaSamplerUniform=d.getUniformLocation(this.gProgram,"u_area_ref_sampler");
this.searchSamplerUniform=d.getUniformLocation(this.gProgram,"u_search_ref_sampler")};q.setBuffersize=function(d,e,c){d.uniform2f(this.buffersizeUniform,e,c)};q.setSearchSteps=function(d,e){d.uniform1f(this.searchStepsUniform,e)};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\t\tprecision highp float;\n\n\t\t\tattribute vec3 a_vertex_position;\n\t\t\tuniform float u_search_steps;\n\t\t\tuniform vec2 u_buffersize;\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec2 vPixCoord;\n\t\t\tvarying vec4 vOffset[3];\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 resVals \x3d vec2(1.0 / u_buffersize.x, 1.0 / u_buffersize.y);\n\n\t\t\t\tvTexCoord \x3d vec2((a_vertex_position.xy + 1.0) / 2.0);\n\t\t\t\tvPixCoord \x3d vTexCoord * u_buffersize;\n\n\t\t\t\t// Set UVs of offset checks as varyings to be more efficient in frag shader\n\t\t\t\tvOffset[0] \x3d vTexCoord.xyxy + resVals.xyxy * vec4(-0.25, -0.125,  1.25, -0.125);\n\t\t\t\tvOffset[1] \x3d vTexCoord.xyxy + resVals.xyxy * vec4(-0.125, -0.25, -0.125, 1.25);\n\t\t\t\tvOffset[2] \x3d vec4(vOffset[0].xz, vOffset[1].yw) + resVals.xxyy * vec4(-2.0, 2.0, -2.0, 2.0) * u_search_steps;\n\n\t\t\t\tgl_Position \x3d vec4(a_vertex_position.xy, 0.0, 1.0);\n\t\t\t}\n\t\t")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\t\tprecision highp float;\n\t\n\t\t\t#define MAX_SEARCH_STEPS 32\n\t\t\t#define AREATEX_MAX_DISTANCE 16\n\t\t\t#define AREATEX_PIXEL_SIZE (1.0 / vec2(160.0, 560.0))\n\t\t\t#define AREATEX_SUBTEX_SIZE (1.0 / 7.0)\n\t\t\t#define SEARCHTEX_SIZE vec2(66.0, 33.0)\n\t\t\t#define SEARCHTEX_PACKED_SIZE vec2(64.0, 16.0)\n\n\t\t\t#define mad(a, b, c) (a * b + c)\t\t\n\n\t\t\tuniform vec2 u_buffersize;\n\t\t\tuniform float u_search_steps;\n\t\t\tuniform sampler2D u_edges_sampler;\n\t\t\tuniform sampler2D u_area_ref_sampler;\n\t\t\tuniform sampler2D u_search_ref_sampler;\n\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec4 vOffset[3];\n\t\t\tvarying vec2 vPixCoord;\n\n\t\t\t#define INVRES 1.0/u_buffersize\n\n\t\t\tvec2 areaTextureSelect(vec4 sample) { return sample.rg; }\n\t\t\tfloat searchTextureSelect(vec4 sample) { return sample.r; }\n\n\t\t\tvec4 SMAASampleLevelZeroOffset(sampler2D tex, vec2 coord, vec2 offset) {\n\t\t\t\treturn texture2D(tex, coord + offset * INVRES);\n\t\t\t}\n\n\t\t\t// Determines amount to add to final steps\n\t\t\t// Find interpolated edge, adding 0-2 depending on what is active (on search texture)\n\t\t\tfloat SMAASearchLength(sampler2D searchSampler, vec2 e, float offset) {\n\t\t\t\t// The texture is y-flipped, split horizontally for left and right cases\n\t\t\t\t// Coords are adjusted to get to the texel center, and converted from pixel to texture coordinates\n\t\t\t\tvec2 scale \x3d (SEARCHTEX_SIZE * vec2(0.5, 1.0) + vec2(-1.0,  1.0)) / SEARCHTEX_PACKED_SIZE;\n\t\t\t\tvec2 bias \x3d (SEARCHTEX_SIZE * vec2(offset, 1.0) + vec2( 0.5, -0.5)) / SEARCHTEX_PACKED_SIZE;\n\n\t\t\t\t// Lookup the search texture\n\t\t\t\treturn searchTextureSelect(texture2D(searchSampler, mad(scale, e, bias)));\n\n\t\t\t}\n\n\t\t\t// Search functions in all directions using offset texcoords to fetch edges and determine which are active\n\t\t\tfloat SMAASearchXLeft(sampler2D u_edges_sampler, sampler2D searchSampler, vec2 texcoord, float end) {\n\t\t\t\tvec2 e \x3d vec2(0.0, 1.0);\n\t\t\t\tfor (int i \x3d 0; i \x3c MAX_SEARCH_STEPS; i++) { \n\t\t\t\t\tif (i \x3e\x3d int(u_search_steps)) break;\n\t\t\t\t\tif (!(texcoord.x \x3e end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0)) break;\n\t\t\t\t\te \x3d texture2D(u_edges_sampler, texcoord).rg;\n\t\t\t\t\ttexcoord \x3d mad(-vec2(2.0, 0.0), INVRES.xy, texcoord);\n\t\t\t\t}\n\n\t\t\t\tfloat offset \x3d mad(-(255.0 / 127.0), SMAASearchLength(searchSampler, e, 0.0), 3.25);\n\t\t\t\treturn mad(INVRES.x, offset, texcoord.x);\n\t\t\t}\n\n\t\t\tfloat SMAASearchXRight(sampler2D u_edges_sampler, sampler2D searchSampler, vec2 texcoord, float end) {\n\t\t\t\tvec2 e \x3d vec2(0.0, 1.0);\n\t\t\t\tfor (int i \x3d 0; i \x3c MAX_SEARCH_STEPS; i++) { \n\t\t\t\t\tif (i \x3e\x3d int(u_search_steps)) break;\n\t\t\t\t\tif (!(texcoord.x \x3c end \x26\x26 e.g \x3e 0.8281 \x26\x26 e.r \x3d\x3d 0.0)) break;\n\t\t\t\t\te \x3d texture2D(u_edges_sampler, texcoord).rg;\n\t\t\t\t\ttexcoord \x3d mad(vec2(2.0, 0.0), INVRES.xy, texcoord);\n\t\t\t\t}\n\t\t\t\tfloat offset \x3d mad(-(255.0 / 127.0), SMAASearchLength(searchSampler, e, 0.5), 3.25);\n\t\t\t\treturn mad(-INVRES.x, offset, texcoord.x);\n\t\t\t}\n\n\t\t\tfloat SMAASearchYUp(sampler2D u_edges_sampler, sampler2D searchSampler, vec2 texcoord, float end) {\n\t\t\t\tvec2 e \x3d vec2(1.0, 0.0);\n\t\t\t\tfor (int i \x3d 0; i \x3c MAX_SEARCH_STEPS; i++) { \n\t\t\t\t\tif (i \x3e\x3d int(u_search_steps)) break;\n\t\t\t\t\tif (!(texcoord.y \x3e end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0)) break;\n\t\t\t\t\te \x3d texture2D(u_edges_sampler, texcoord).rg;\n\t\t\t\t\ttexcoord \x3d mad(-vec2(0.0, 2.0), INVRES.xy, texcoord);\n\t\t\t\t}\n\t\t\t\tfloat offset \x3d mad(-(255.0 / 127.0), SMAASearchLength(searchSampler, e.gr, 0.0), 3.25);\n\t\t\t\treturn mad(INVRES.y, offset, texcoord.y);\n\t\t\t}\n\n\t\t\tfloat SMAASearchYDown(sampler2D u_edges_sampler, sampler2D searchSampler, vec2 texcoord, float end) {\n\t\t\t\tvec2 e \x3d vec2(1.0, 0.0);\n\t\t\t\tfor (int i \x3d 0; i \x3c MAX_SEARCH_STEPS; i++) { \n\t\t\t\t\tif (i \x3e\x3d int(u_search_steps)) break;\n\t\t\t\t\tif (!(texcoord.y \x3c end \x26\x26 e.r \x3e 0.8281 \x26\x26 e.g \x3d\x3d 0.0)) break;\n\t\t\t\t\te \x3d texture2D(u_edges_sampler, texcoord).rg;\n\t\t\t\t\ttexcoord \x3d mad(vec2(0.0, 2.0), INVRES.xy, texcoord);\n\t\t\t\t}\n\t\t\t\tfloat offset \x3d mad(-(255.0 / 127.0), SMAASearchLength(searchSampler, e.gr, 0.5), 3.25);\n\t\t\t\treturn mad(-INVRES.y, offset, texcoord.y);\n\t\t\t}\n\n\t\t\t// Determine areas of each side of edge\n\t\t\tvec2 SMAAArea(sampler2D u_area_ref_sampler, vec2 dist, float e1, float e2, float offset) {\n\t\t\t\tvec2 texcoord \x3d mad(vec2(AREATEX_MAX_DISTANCE, AREATEX_MAX_DISTANCE), floor(4.0 * vec2(e1, e2) + 0.5), dist);\n\t\t\t\t// Map to texel space\n\t\t\t\ttexcoord \x3d mad(AREATEX_PIXEL_SIZE, texcoord, 0.5 * AREATEX_PIXEL_SIZE);\n\t\t\t\ttexcoord.y \x3d mad(AREATEX_SUBTEX_SIZE, offset, texcoord.y);\n\t\t\t\treturn areaTextureSelect(texture2D(u_area_ref_sampler, texcoord));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec4 subsampleIndices \x3d vec4(0.0); \n\t\t\t\tvec4 weights \x3d vec4(0.0, 0.0, 0.0, 0.0);\n\t\t\t\tvec2 e \x3d texture2D(u_edges_sampler, vTexCoord).rg;\n\t\n\t\t\t\tif (e.g \x3e 0.0) { // Northern Edge\n\n\t\t\t\t\tvec2 d;\n\n\t\t\t\t\t// Get distance of left\n\t\t\t\t\tvec3 coords;\n\t\t\t\t\tcoords.x \x3d SMAASearchXLeft(u_edges_sampler, u_search_ref_sampler, vOffset[0].xy, vOffset[2].x);\n\t\t\t\t\tcoords.y \x3d vOffset[1].y;\n\t\t\t\t\td.x \x3d coords.x;\n\n\t\t\t\t\t// Get the left crossing edges\n\t\t\t\t\tfloat e1 \x3d texture2D(u_edges_sampler, coords.xy).r;\n\n\t\t\t\t\t// Get distance of right\n\t\t\t\t\tcoords.z \x3d SMAASearchXRight(u_edges_sampler, u_search_ref_sampler, vOffset[0].zw, vOffset[2].y);\n\t\t\t\t\td.y \x3d coords.z;\n\n\t\t\t\t\t// Set to pixel units and find square root\n\t\t\t\t\td \x3d abs(mad(u_buffersize.xx, d, -vPixCoord.xx));\n\t\t\t\t\tvec2 sqrt_d \x3d sqrt(d);\n\n\t\t\t\t\t// Get the left crossing edge\n\t\t\t\t\tfloat e2 \x3d SMAASampleLevelZeroOffset(u_edges_sampler, coords.zy, vec2(1, 0)).r;\n\n\t\t\t\t\t// Get the area\n\t\t\t\t\tweights.rg \x3d SMAAArea(u_area_ref_sampler, sqrt_d, e1, e2, subsampleIndices.y);\n\n\t\t\t\t}\n\n\t\t\t\tif (e.r \x3e 0.0) { // Western Edge\n\t\t\t\t\tvec2 d;\n\n\t\t\t\t\t// Get distance of top\n\t\t\t\t\tvec3 coords;\n\t\t\t\t\tcoords.y \x3d SMAASearchYUp(u_edges_sampler, u_search_ref_sampler, vOffset[1].xy, vOffset[2].z);\n\t\t\t\t\tcoords.x \x3d vOffset[0].x; \n\t\t\t\t\td.x \x3d coords.y;\n\n\t\t\t\t\t// Get the top crossing edge\n\t\t\t\t\tfloat e1 \x3d texture2D(u_edges_sampler, coords.xy).g;\n\n\t\t\t\t\t// Get distance of bottom\n\t\t\t\t\tcoords.z \x3d SMAASearchYDown(u_edges_sampler, u_search_ref_sampler, vOffset[1].zw, vOffset[2].w);\n\t\t\t\t\td.y \x3d coords.z;\n\n\t\t\t\t\t//  Set to pixel units and find square root\n\t\t\t\t\td \x3d abs(mad(u_buffersize.yy, d, -vPixCoord.yy));\n\t\t\t\t\tvec2 sqrt_d \x3d sqrt(d);\n\n\t\t\t\t\t// Get the bottom crossing edge\n\t\t\t\t\tfloat e2 \x3d SMAASampleLevelZeroOffset(u_edges_sampler, coords.xz, vec2(0, 1)).g;\n\n\t\t\t\t\t// Get the area \n\t\t\t\t\tweights.ba \x3d SMAAArea(u_area_ref_sampler, sqrt_d, e1, e2, subsampleIndices.x);\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor \x3d weights;\n\n\t\t\t}\t\t\t\n\t\t")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.SMAABlendShader=function(){};let n=q._Shader.prototype;q=q.SMAABlendShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.antialiasUniform=d.getUniformLocation(this.gProgram,"u_antialias");this.imageSamplerUniform=d.getUniformLocation(this.gProgram,"u_image_sampler");this.weightsSamplerUniform=d.getUniformLocation(this.gProgram,"u_weights_sampler")};
q.setBuffersize=function(d,e,c){d.uniform2f(this.buffersizeUniform,e,c)};q.setAntialias=function(d,e){d.uniform1f(this.antialiasUniform,e)};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\t\tprecision highp float;\n\n\t\t\tattribute vec3 a_vertex_position;\n\t\t\tuniform vec2 u_buffersize;\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec4 vOffset;\n\n\t\t\tvoid main() {\n\t\t\t\tvec2 resVals \x3d vec2(1.0 / u_buffersize.x, 1.0 / u_buffersize.y);\n\n\t\t\t\tvTexCoord \x3d vec2((a_vertex_position.xy + 1.0) / 2.0);\n\n\t\t\t\t// Set UVs of offset check as varying to be more efficient in frag shader\n\t\t\t\tvOffset \x3d vTexCoord.xyxy + resVals.xyxy * vec4( 1.0, 0.0, 0.0, 1.0);\n\n\t\t\t\tgl_Position \x3d vec4(a_vertex_position.xy, 0.0, 1.0);\n\t\t\t}\n\t\t")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\t\tprecision highp float;\n\t\n\t\t\tuniform vec2 u_buffersize;\n\t\t\tuniform bool u_antialias;\n\t\t\tuniform sampler2D u_weights_sampler;\n\t\t\tuniform sampler2D u_image_sampler;\n\t\t\tvarying vec2 vTexCoord;\n\t\t\tvarying vec4 vOffset;\n\n\t\t\t// Conditional move\n\t\t\tvoid SMAAMovc(bvec2 cond, inout vec2 variable, vec2 value) {\n\t\t\t\tif (cond.x) variable.x \x3d value.x;\n\t\t\t\tif (cond.y) variable.y \x3d value.y;\n\t\t\t}\n\n\t\t\tvoid SMAAMovc(bvec4 cond, inout vec4 variable, vec4 value) {\n\t\t\t\tSMAAMovc(cond.xy, variable.xy, value.xy);\n\t\t\t\tSMAAMovc(cond.zw, variable.zw, value.zw);\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec4 color;\n\n\t\t\t\t// Get the blending weights for this fragment (x is right, y is top, z is bottom, w is left)\n\t\t\t\tvec4 a;\n\t\t\t\ta.x \x3d texture2D(u_weights_sampler, vOffset.xy).a; \n\t\t\t\ta.y \x3d texture2D(u_weights_sampler, vOffset.zw).g; \n\t\t\t\ta.wz \x3d texture2D(u_weights_sampler, vTexCoord).xz; \n\n\t\t\t\t// Check for blending weight greater than 0\n\t\t\t\tif (dot(a, vec4(1.0, 1.0, 1.0, 1.0)) \x3c\x3d 1e-5) {\n\t\t\t\t\tcolor \x3d texture2D(u_image_sampler, vTexCoord);\n\t\t\t\t} else {\n\t\t\t\t\tbool h \x3d max(a.x, a.z) \x3e max(a.y, a.w); // max(horizontal) \x3e max(vertical)\n\n\t\t\t\t\t// Get the blending offsets\n\t\t\t\t\tvec4 blendingOffset \x3d vec4(0.0, a.y, 0.0, a.w);\n\t\t\t\t\tvec2 blendingWeight \x3d a.yw;\n\t\t\t\t\tSMAAMovc(bvec4(h, h, h, h), blendingOffset, vec4(a.x, 0.0, a.z, 0.0));\n\t\t\t\t\tSMAAMovc(bvec2(h, h), blendingWeight, a.xz);\n\t\t\t\t\tblendingWeight /\x3d dot(blendingWeight, vec2(1.0, 1.0));\n\n\t\t\t\t\t// Get the texture coordinates\n\t\t\t\t\tvec2 resVals \x3d vec2(1.0 / u_buffersize.x, 1.0 / u_buffersize.y);\n\t\t\t\t\tvec4 blendingCoord \x3d vTexCoord.xyxy + blendingOffset * vec4(resVals, -resVals);\n\n\t\t\t\t\t// Mix current fragment and neighbor with bilinear interpolation\n\t\t\t\t\tcolor \x3d blendingWeight.x * texture2D(u_image_sampler, blendingCoord.xy);\n\t\t\t\t\tcolor +\x3d blendingWeight.y * texture2D(u_image_sampler, blendingCoord.zw);\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor \x3d color;\n\n\t\t\t\tif (!u_antialias) {\n\t\t\t\t\t// Bypass anti-alias and use original image\n\t\t\t\t\tgl_FragColor \x3d texture2D(u_image_sampler, vTexCoord);\n\t\t\t\t}\n\t\t\t}\n\t\t")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.LabelShader=function(){};let n=q._Shader.prototype;q=q.LabelShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.dimensionUniform=d.getUniformLocation(this.gProgram,"u_dimension")};q.onShaderAttached=function(d){n.onShaderAttached.call(this,d);this.vertexTexCoordAttribute=2;d.bindAttribLocation(this.gProgram,this.vertexTexCoordAttribute,"a_vertex_texcoord")};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,
d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\t\tattribute vec3 a_vertex_normal;\n\t\tattribute vec2 a_vertex_texcoord;\n\n\t\t// matrices set by gl.setMatrixUniforms\n\t\tuniform mat4 u_model_view_matrix;\n\t\tuniform mat4 u_projection_matrix;\n\t\tuniform vec2 u_dimension;\n\n\t\t// sent to the fragment shader\n\t\tvarying vec2 v_texcoord;\n\n\t\tvoid main() {\n\n\t\t\tgl_Position \x3d u_model_view_matrix * vec4(a_vertex_position, 1.);\n\n\t\t\tvec4 depth_pos \x3d vec4(gl_Position);\n\n\t\t\tdepth_pos.z +\x3d a_vertex_normal.z;\n\n\t\t\tgl_Position \x3d u_projection_matrix * gl_Position;\n\n\t\t\tdepth_pos \x3d u_projection_matrix * depth_pos;\n\n\t\t\tgl_Position /\x3d gl_Position.w;\n\n\t\t\tgl_Position.xy +\x3d a_vertex_normal.xy / u_dimension * 2.;\n\n\t\t\tgl_Position.z \x3d depth_pos.z / depth_pos.w;\n\n\t\t\tv_texcoord \x3d a_vertex_texcoord;\n\n\t\t}")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,`
		// set macro for depth mmap texture
		${d.depthTextureExt?"#define CWC_DEPTH_TEX":""}
		
		// set float precision
		precision mediump float;

		// texture for draw text nor shadow map
		uniform sampler2D u_image;
					
		// from the vertex shader
		varying vec2 v_texcoord;

		void main(void) {
			gl_FragColor = texture2D(u_image, v_texcoord);
		}`)};q.enableAttribsArray=function(d){n.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute);d.enableVertexAttribArray(this.vertexTexCoordAttribute)};q.disableAttribsArray=function(d){n.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute);d.disableVertexAttribArray(this.vertexTexCoordAttribute)};q.setDimension=function(d,e,c){d.uniform2f(this.dimensionUniform,e,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,
document);
(function(q,B,w,u,l){q.LightingShader=function(){};let n=q._Shader.prototype;q=q.LightingShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.positionSampleUniform=d.getUniformLocation(this.gProgram,"u_position_sample");this.colorSampleUniform=d.getUniformLocation(this.gProgram,"u_color_sample");this.ssaoSampleUniform=d.getUniformLocation(this.gProgram,"u_ssao_sample");this.outlineSampleUniform=d.getUniformLocation(this.gProgram,"u_outline_sample")};q.loadDefaultVertexShader=
function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n\t\t// sent to the fragment shader\n    \tvarying vec2 v_texcoord;\n\n\t\tvoid main() {\n\t\t\tgl_Position \x3d vec4(a_vertex_position, 1.);\n        \tv_texcoord \x3d a_vertex_position.xy * .5 + .5;\n\t\t}")};q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\n\t\t// set float precision\n\t\tprecision mediump float;\n\n\t    uniform sampler2D u_position_sample;\n\t    uniform sampler2D u_color_sample;\n\t\tuniform sampler2D u_ssao_sample;\n\t\tuniform sampler2D u_outline_sample;\n\t    \n    \tvarying vec2 v_texcoord;\n\n\t    void main() {\n\t    \tvec4 position \x3d texture2D(u_position_sample, v_texcoord);\n\t    \tvec4 color \x3d texture2D(u_color_sample, v_texcoord);\n\t\t\tvec4 ao \x3d texture2D(u_ssao_sample, v_texcoord);\n\t\t\tfloat outline \x3d texture2D(u_outline_sample, v_texcoord).r;\n\n\t\t\t// skip background color\n\t    \tif(position.w \x3d\x3d 0. \x26\x26 outline \x3d\x3d 1.) {\n\t\t\t\t// gl_FragColor \x3d vec4(0., 0., 0., 1.);\n\t    \t\treturn;\n\t    \t}\n\n\t\t\tgl_FragColor \x3d vec4(color.rgb * ao.r * outline, 1.);\n\t    }")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.NormalShader=function(){};let n=q._Shader.prototype;q=q.NormalShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix")};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\t\tattribute vec3 a_vertex_normal;\n\n\t\t// matrices set by gl.setMatrixUniforms\n\t\tuniform mat4 u_model_view_matrix;\n\t\tuniform mat4 u_projection_matrix;\n\t\tuniform mat3 u_normal_matrix;\n\n\t\t// sent to the fragment shader\n\t\tvarying vec3 v_normal;\n\n\t\tvoid main() {\n\n\t\t\tv_normal \x3d length(a_vertex_normal)\x3d\x3d0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;\n\t\t\t\n\t\t\tgl_Position \x3d u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);\n\n\t\t}")};q.loadDefaultFragmentShader=
function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\t\n\t\t// set float precision\n\t\tprecision mediump float;\n\t\t\t\t\t\n\t\tvarying vec3 v_normal;\n\n\t\tvoid main(void) {\n\t\t\tvec3 normal \x3d length(v_normal)\x3d\x3d0. ? vec3(0., 0., 1.) : normalize(v_normal);\n\t\t\tgl_FragColor \x3d vec4(normal, 0.);\n\t\t}")};q.enableAttribsArray=function(d){n.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};q.disableAttribsArray=function(d){n.disableAttribsArray.call(this,
d);d.disableVertexAttribArray(this.vertexNormalAttribute)};q.setModelViewMatrix=function(d,e){n.setModelViewMatrix.call(this,d,e);e=B.transpose(w.toInverseMat3(e,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.OutlineShader=function(){};let n=q._Shader.prototype;q=q.OutlineShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.normalSampleUniform=d.getUniformLocation(this.gProgram,"u_normal_sample");this.depthSampleUniform=d.getUniformLocation(this.gProgram,"u_depth_sample");this.gbufferTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_gbuffer_texture_size");this.normalThresholdUniform=d.getUniformLocation(this.gProgram,"u_normal_threshold");
this.depthThresholdUniform=d.getUniformLocation(this.gProgram,"u_depth_threshold");this.thicknessUniform=d.getUniformLocation(this.gProgram,"u_thickness")};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n    \tvarying vec2 v_texcoord;\n\n\t\tvoid main() {\n\t\t\tgl_Position \x3d vec4(a_vertex_position, 1.);\n        \tv_texcoord \x3d a_vertex_position.xy * .5 + .5;\n\t\t}")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"\n\t\t// set float precision\n\t\tprecision mediump float;\n\n\t    uniform sampler2D u_normal_sample;\n\t    uniform sampler2D u_depth_sample;\n\n\t    uniform float u_normal_threshold;\n\t    uniform float u_depth_threshold;\n\n\t    uniform float u_thickness;\n\n\t    uniform vec2 u_gbuffer_texture_size;\n\n\t    \n\t    varying vec2 v_texcoord;\n\n\t    void main() {\n\t    \tvec3 normal \x3d texture2D(u_normal_sample, v_texcoord).xyz;\n\t    \tfloat depth \x3d texture2D(u_depth_sample, v_texcoord).r;\n\n\t    \t// check background pixel\n\t    \t// if(depth \x3d\x3d 1.) {\n\t    \t// \treturn;\n\t    \t// }\n\n\t    \tvec2 texelSize \x3d u_thickness/u_gbuffer_texture_size * .5;\n\t    \tvec2 offsets[8];\n\n\t\t\toffsets[0] \x3d vec2(-texelSize.x, -texelSize.y);\n\t\t\toffsets[1] \x3d vec2(-texelSize.x, 0);\n\t\t\toffsets[2] \x3d vec2(-texelSize.x, texelSize.y);\n\n\t\t\toffsets[3] \x3d vec2(0, -texelSize.y);\n\t\t\toffsets[4] \x3d vec2(0,  texelSize.y);\n\n\t\t\toffsets[5] \x3d vec2(texelSize.x, -texelSize.y);\n\t\t\toffsets[6] \x3d vec2(texelSize.x, 0);\n\t\t\toffsets[7] \x3d vec2(texelSize.x, texelSize.y);\n\n\t\t\tfloat edge \x3d 0.;\n\n\t\t\tfor (int i \x3d 0; i \x3c 8; i++) {\n\t\t\t\tvec3 sampleNorm \x3d texture2D(u_normal_sample, v_texcoord + offsets[i]).xyz;\n\n\t\t\t\tif(normal \x3d\x3d vec3(.0, .0, .0)) {\n\t\t\t\t\tif(sampleNorm !\x3d vec3(.0, .0, .0)) {\n\t\t\t\t\t\tedge \x3d 1.0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (dot(sampleNorm, normal) \x3c u_normal_threshold) {\n\t\t\t\t\tedge \x3d 1.0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tfloat sampleDepth \x3d texture2D(u_depth_sample, v_texcoord + offsets[i]).r;\n\t\t\t\tif (abs(sampleDepth - depth) \x3e u_depth_threshold) {\n\t\t\t\t\tedge \x3d 1.0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tedge \x3d 1. - edge;\n\n\t\t    gl_FragColor \x3d vec4(edge, edge, edge, 1.);\n\t    }")};
q.setGbufferTextureSize=function(d,e,c){d.uniform2f(this.gbufferTextureSizeUniform,e,c)};q.setNormalThreshold=function(d,e){d.uniform1f(this.normalThresholdUniform,e)};q.setDepthThreshold=function(d,e){d.uniform1f(this.depthThresholdUniform,e)};q.setThickness=function(d,e){d.uniform1f(this.thicknessUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.PhongShader=function(){};let n=q._Shader.prototype;q=q.PhongShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.shadowUniform=d.getUniformLocation(this.gProgram,"u_shadow");this.flatColorUniform=d.getUniformLocation(this.gProgram,"u_flat_color");this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix");this.lightModelViewMatrixUniform=d.getUniformLocation(this.gProgram,"u_light_model_view_matrix");this.lightProjectionMatrixUniform=
d.getUniformLocation(this.gProgram,"u_light_projection_matrix");this.lightDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_light_diffuse_color");this.lightSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_light_specular_color");this.lightDirectionUniform=d.getUniformLocation(this.gProgram,"u_light_direction");this.materialAmbientColorUniform=d.getUniformLocation(this.gProgram,"u_material_ambient_color");this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color");
this.materialSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_material_specular_color");this.materialShininessUniform=d.getUniformLocation(this.gProgram,"u_material_shininess");this.materialAlphaUniform=d.getUniformLocation(this.gProgram,"u_material_alpha");this.fogModeUniform=d.getUniformLocation(this.gProgram,"u_fog_mode");this.fogColorUniform=d.getUniformLocation(this.gProgram,"u_fog_color");this.fogStartUniform=d.getUniformLocation(this.gProgram,"u_fog_start");this.fogEndUniform=d.getUniformLocation(this.gProgram,
"u_fog_end");this.fogDensityUniform=d.getUniformLocation(this.gProgram,"u_fog_density");this.shadowDepthSampleUniform=d.getUniformLocation(this.gProgram,"u_shadow_depth_sample");this.shadowTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_shadow_texture_size");this.shadowIntensityUniform=d.getUniformLocation(this.gProgram,"u_shadow_intensity");this.gammaCorrectionUniform=d.getUniformLocation(this.gProgram,"u_gamma_inverted");this.pointSizeUniform=d.getUniformLocation(this.gProgram,"u_point_size")};
q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\t\tattribute vec3 a_vertex_normal;\n\n\t\t// scene uniforms\n\t\tuniform vec3 u_light_diffuse_color;\n\t\tuniform vec3 u_material_ambient_color;\n\t\tuniform vec3 u_material_diffuse_color;\n\t\t// matrices set by gl.setMatrixUniforms\n\t\tuniform mat4 u_model_view_matrix;\n\t\tuniform mat4 u_projection_matrix;\n\t\tuniform mat3 u_normal_matrix;\n\n\t\tuniform mat4 u_light_model_view_matrix;\n\t\tuniform mat4 u_light_projection_matrix;\n\n\t\tuniform bool u_shadow;\n\n\t\t// sent to the fragment shader\n\t\tvarying vec3 v_viewpos;\n  \t\tvarying vec4 v_shadcoord;\n\t\tvarying vec3 v_diffuse;\n\t\tvarying vec3 v_ambient;\n\t\tvarying vec3 v_normal;\n\t\t\n\t\tuniform float u_point_size;\n\n\t\tvoid main() {\n\n\t\t\tv_normal \x3d length(a_vertex_normal)\x3d\x3d0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;\n\t\t\tv_ambient \x3d u_material_ambient_color;\n\t\t\tv_diffuse \x3d u_material_diffuse_color * u_light_diffuse_color;\n\n\t\t\tif(u_shadow) {\n\t\t\t\tv_shadcoord \x3d u_light_projection_matrix * u_light_model_view_matrix * vec4(a_vertex_position, 1.);\n\t\t\t\tv_shadcoord /\x3d v_shadcoord.w;\n\t\t\t}\n\n\t\t\tvec4 viewPos \x3d u_model_view_matrix * vec4(a_vertex_position, 1.);\n\n\t\t\tv_viewpos \x3d viewPos.xyz / viewPos.w;\n\t\t\t\n\t\t\tgl_Position \x3d u_projection_matrix * viewPos;\n\n\t\t\t// just to make sure the w is 1\n\t\t\tgl_Position /\x3d gl_Position.w;\n\t\t\tgl_PointSize \x3d u_point_size;\n\n\t\t}")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,`
		// set macro for depth mmap texture
		${d.depthTextureExt?"#define CWC_DEPTH_TEX":""} 
		
		// set float precision
		precision mediump float;
					
		// scene uniforms
		uniform vec3 u_light_specular_color;
		uniform vec3 u_light_direction;

		uniform vec3 u_material_specular_color;
		uniform float u_material_shininess;
		uniform float u_material_alpha;

		uniform int u_fog_mode;
		uniform vec3 u_fog_color;
		uniform float u_fog_density;
		uniform float u_fog_start;
		uniform float u_fog_end;

		uniform bool u_shadow;
		uniform float u_shadow_intensity;

		uniform bool u_flat_color;
		
		uniform float u_gamma_inverted;

		// texture for shadow map
		uniform sampler2D u_shadow_depth_sample;

		uniform vec2 u_shadow_texture_size;
					
		// from the vertex shader
		varying vec3 v_viewpos;
  		varying vec4 v_shadcoord;
		varying vec3 v_diffuse;
		varying vec3 v_ambient;
		varying vec3 v_normal;


		\n#ifndef CWC_DEPTH_TEX\n
		float unpack (vec4 colour) {
			const vec4 bitShifts = vec4(1.,
				1. / 255.,
				1. / (255. * 255.),
				1. / (255. * 255. * 255.));
			return dot(colour, bitShifts);
		}
		\n#endif\n

		float shadowMapDepth(vec4 shadowMapColor) {
			float zShadowMap;
			\n#ifdef CWC_DEPTH_TEX\n
			zShadowMap = shadowMapColor.r;
			\n#else\n
			zShadowMap = unpack(shadowMapColor);
			\n#endif\n
			return zShadowMap;
		}

		void main(void) {
			vec3 color = v_diffuse;
			if(length(v_normal)!=0.){
				vec3 normal = normalize(v_normal);
				vec3 lightDir = normalize(-u_light_direction);
				float nDotL = dot(normal, lightDir);

    			float shadow = 0.0;
    			if(u_shadow) {
					vec3 depthCoord = .5 + v_shadcoord.xyz / v_shadcoord.w * .5;

				    if(depthCoord.z <= 1. && depthCoord.z >= 0.) {
						float bias = max(.05 * (1. - nDotL), .005);
						vec2 texelSize = 1. / u_shadow_texture_size;
					    for(int x = -1; x <= 1; ++x) {
					        for(int y = -1; y <= 1; ++y)  {
								vec4 shadowMapColor = texture2D(u_shadow_depth_sample, depthCoord.xy + vec2(x, y) * texelSize);
								float zShadowMap = shadowMapDepth(shadowMapColor);
					            shadow += zShadowMap + bias < depthCoord.z ? 1. : 0.;
					        }
					    }
					    shadow /= 9.;
					    shadow *= u_shadow_intensity;
					}
    			}

    			if(!u_flat_color) {
					vec3 viewDir = normalize(-v_viewpos);
					vec3 halfDir = normalize(lightDir + viewDir);
					float nDotHV = max(dot(halfDir, normal), 0.);
					vec3 specular = u_material_specular_color * u_light_specular_color;
					color*=max(nDotL, 0.);
					color+=specular * pow(nDotHV, u_material_shininess);
				}

				// set the color
				color = (1.-shadow)*color+v_ambient;
			}

			gl_FragColor = vec4(pow(color, vec3(u_gamma_inverted)), u_material_alpha);

			if(u_fog_mode != 0){
				float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);
				float fogFactor = 1.;

				// linear equation
				if(u_fog_mode == 1){
					fogFactor = 1.-fogCoord;
				}
				// exp equation
				else if(u_fog_mode == 2) {
					fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);
				}
				// exp2 equation
				else if(u_fog_mode == 3) {
					fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);
				}
				gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);

				// for debugging
				// gl_FragColor = vec4(vec3(fogFactor), 1.);
			}
		}`)};q.enableAttribsArray=function(d){n.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};q.disableAttribsArray=function(d){n.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute)};q.setMatrixUniforms=function(d,e){if(e===l)this.setModelViewMatrix(d,d.modelViewMatrix),this.setLightModelViewMatrix(d,d.lightViewMatrix);else{let c=w.multiply(d.modelViewMatrix,e,[]);e=w.multiply(d.lightViewMatrix,e,[]);this.setModelViewMatrix(d,
c);this.setLightModelViewMatrix(d,e)}};q.setModelViewMatrix=function(d,e){n.setModelViewMatrix.call(this,d,e);e=B.transpose(w.toInverseMat3(e,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,e)};q.setFlatColor=function(d,e){d.uniform1i(this.flatColorUniform,e)};q.setShadow=function(d,e){d.uniform1i(this.shadowUniform,e)};q.setFogMode=function(d,e){d.uniform1i(this.fogModeUniform,e)};q.setFogColor=function(d,e){d.uniform3fv(this.fogColorUniform,e)};q.setFogStart=function(d,e){d.uniform1f(this.fogStartUniform,
e)};q.setFogEnd=function(d,e){d.uniform1f(this.fogEndUniform,e)};q.setFogDensity=function(d,e){d.uniform1f(this.fogDensityUniform,e)};q.setMaterialAmbientColor=function(d,e){d.uniform3fv(this.materialAmbientColorUniform,e)};q.setMaterialDiffuseColor=function(d,e){d.uniform3fv(this.materialDiffuseColorUniform,e)};q.setMaterialSpecularColor=function(d,e){d.uniform3fv(this.materialSpecularColorUniform,e)};q.setMaterialShininess=function(d,e){d.uniform1f(this.materialShininessUniform,e)};q.setMaterialAlpha=
function(d,e){d.uniform1f(this.materialAlphaUniform,e)};q.setLightDiffuseColor=function(d,e){d.uniform3fv(this.lightDiffuseColorUniform,e)};q.setLightSpecularColor=function(d,e){d.uniform3fv(this.lightSpecularColorUniform,e)};q.setLightDirection=function(d,e){d.uniform3fv(this.lightDirectionUniform,e)};q.setLightModelViewMatrix=function(d,e){d.uniformMatrix4fv(this.lightModelViewMatrixUniform,!1,e)};q.setLightProjectionMatrix=function(d,e){d.uniformMatrix4fv(this.lightProjectionMatrixUniform,!1,e)};
q.setShadowTextureSize=function(d,e,c){d.uniform2f(this.shadowTextureSizeUniform,e,c)};q.setShadowIntensity=function(d,e){d.uniform1f(this.shadowIntensityUniform,e)};q.setGammaCorrection=function(d,e){d.uniform1f(this.gammaCorrectionUniform,1/e)};q.setPointSize=function(d,e){d.uniform1f(this.pointSizeUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.PickShader=function(){};let n=q._Shader.prototype;q=q.PickShader.prototype=new q._Shader;q.initUniformLocations=function(d){n.initUniformLocations.call(this,d);this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color")};q.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n\t\t// matrices set by gl.setMatrixUniforms\n\t\tuniform mat4 u_model_view_matrix;\n\t\tuniform mat4 u_projection_matrix;\n\n\t\tvoid main() {\n\t\t\t\n\t\t\tgl_Position \x3d u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);\n\n\t\t\t// just to make sure the w is 1\n\t\t\tgl_Position /\x3d gl_Position.w;\n\n\t\t}")};
q.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,`
		// set macro for depth mmap texture
		${d.depthTextureExt?"#define CWC_DEPTH_TEX":""}
		
		// set float precision
		precision mediump float;

		uniform vec3 u_material_diffuse_color;
					
		void main(void) {
			gl_FragColor = vec4(u_material_diffuse_color, 1.);
		}`)};q.setMaterialDiffuseColor=function(d,e){d.uniform3fv(this.materialDiffuseColorUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.PositionShader=function(){};q=q.PositionShader.prototype=new q._Shader;q.loadDefaultVertexShader=function(n){return this.getShaderFromStr(n,n.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n\t\t// matrices set by gl.setMatrixUniforms\n\t\tuniform mat4 u_model_view_matrix;\n\t\tuniform mat4 u_projection_matrix;\n\n\t\tvarying vec4 v_position;\n\n\t\tvoid main() {\n\t\t\tvec4 viewPos \x3d u_model_view_matrix * vec4(a_vertex_position, 1.);\n\n\t\t\tgl_Position \x3d u_projection_matrix * viewPos;\n\n\t\t\tv_position \x3d viewPos / viewPos.w;\n\n\t\t}")};q.loadDefaultFragmentShader=
function(n){return this.getShaderFromStr(n,n.FRAGMENT_SHADER,"\n\t\t// set float precision\n\t\tprecision mediump float;\n\n\t\tvarying vec4 v_position;\n\n\t\tvoid main(void) {\n\t\t\tgl_FragColor \x3d v_position;\n\t\t}")}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l){q.QuadShader=function(){};q=q.QuadShader.prototype=new q._Shader;q.loadDefaultVertexShader=function(n){return this.getShaderFromStr(n,n.VERTEX_SHADER,"\n\t\tprecision mediump float;\n\t\t\n\t\t// attributes set when rendering objects\n\t\tattribute vec3 a_vertex_position;\n\n    \tvarying vec2 v_texcoord;\n\n\t\tvoid main() {\n\t\t\tgl_Position \x3d vec4(a_vertex_position, 1.);\n        \tv_texcoord \x3d a_vertex_position.xy * .5 + .5;\n\t\t}")};q.loadDefaultFragmentShader=function(n){return this.getShaderFromStr(n,
n.FRAGMENT_SHADER,"\n\n\t\t// set float precision\n\t\tprecision mediump float;\n\n\t    uniform sampler2D u_image;\n\n    \tvarying vec2 v_texcoord;\n\t    \n\t    void main() {\n\t        gl_FragColor \x3d texture2D(u_image, v_texcoord);\n\t    }")}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(q,B,w,u,l,n,d){let e=function(c,b,f){this.i1=c;this.i2=b;this.i3=f};B._Surface=function(){};B=B._Surface.prototype=new B._Mesh;B.generate=function(c,b,f,g,k,m,r,t){c=[];b=k[4]-g;for(f=0;f<t;f++){let v=k[2]-g;for(let x=0;x<r;x++){let y=k[0]-g;for(let a=0;a<m;a++)c.push(this.calculate(y,v,b)),y+=g;v+=g}b+=g}return c};B.build=function(c,b,f){let g=[],k=[],m=[];var r=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity];b+=2;for(let p=0,z=c.length;p<z;p++){var t=c[p];r[0]=n.min(r[0],t.x-
b);r[1]=n.max(r[1],t.x+b);r[2]=n.min(r[2],t.y-b);r[3]=n.max(r[3],t.y+b);r[4]=n.min(r[4],t.z-b);r[5]=n.max(r[5],t.z+b)}b=r[1]-r[0];t=r[3]-r[2];var v=r[5]-r[4];c=n.min(b,n.min(t,v))/f;f=2+n.ceil(b/c);var x=2+n.ceil(t/c),y=2+n.ceil(v/c);b=this.generate(b,t,v,c,r,f,x,y);b=u(b,[f,x,y]);f=[];t=[];for(let p=0,z=b.vertices.length;p<z;p++){v=t;x=v.push;var a=b.vertices[p];y=f;var h=a[0]*c+r[0]-c;let A=a[1]*c+r[2]-c;a=a[2]*c+r[4]-c;let C=-1;for(let D=0,E=y.length;D<E;D++){let F=y[D];if(n.abs(F.x-h)<.001&&n.abs(F.y-
A)<.001&&n.abs(F.z-a)<.001){C=D;break}}C==-1&&(C=y.length,y.push(new q.Atom("C",h,A,a)));x.call(v,C)}r=[];for(let p=0,z=b.faces.length;p<z;p++)x=b.faces[p],c=t[x[0]],v=t[x[1]],x=t[x[2]],r.push(new e(c,v,x)),m.push(c,v,x);c=[];for(let p=0,z=f.length;p<z;p++){b=[];for(let A=0,C=r.length;A<C;A++)if(t=r[A],t.i1===p||t.i2===p||t.i3===p)t.i1!=p&&b.indexOf(t.i1)===-1&&b.push(t.i1),t.i2!=p&&b.indexOf(t.i2)===-1&&b.push(t.i2),t.i3!=p&&b.indexOf(t.i3)===-1&&b.push(t.i3);c.push(b)}b=[];for(let p=0,z=f.length;p<
z;p++){v=f[p];x=c[p];t=new q.Atom;if(x.length<3)t.x=v.x,t.y=v.y,t.z=v.z;else{y=1;x.length<5&&(y=.5);for(let A=0,C=x.length;A<C;A++)h=f[x[A]],t.x+=h.x,t.y+=h.y,t.z+=h.z;t.x+=v.x*y;t.y+=v.y*y;t.z+=v.z*y;v=1/(y+x.length);t.x*=v;t.y*=v;t.z*=v}b.push(t)}f=b;for(let p=0,z=f.length;p<z;p++)c=f[p],g.push(c.x,c.y,c.z);for(let p=0,z=r.length;p<z;p++)c=r[p],b=f[c.i1],v=f[c.i2],t=f[c.i3],v=[v.x-b.x,v.y-b.y,v.z-b.z],l.cross(v,[t.x-b.x,t.y-b.y,t.z-b.z]),isNaN(v[0])&&(v=[0,0,0]),c.normal=v;for(let p=0,z=f.length;p<
z;p++){f=[0,0,0];for(let A=0,C=r.length;A<C;A++)if(c=r[A],c.i1===p||c.i2===p||c.i3===p)f[0]+=c.normal[0],f[1]+=c.normal[1],f[2]+=c.normal[2];l.normalize(f);k.push(f[0],f[1],f[2])}this.storeData(g,k,m)};B.render=function(c,b){this.styles&&(b=this.styles);b.surfaces_display&&(c.shader.setMatrixUniforms(c),this.bindBuffers(c),c.material.setTempColors(c,b.surfaces_materialAmbientColor_3D,b.surfaces_color,b.surfaces_materialSpecularColor_3D,b.surfaces_materialShininess_3D),c.material.setAlpha(c,b.surfaces_alpha),
b.surfaces_style==="Dots"?(c.shader.setPointSize(c,b.shapes_pointSize),c.drawElements(c.POINTS,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)):b.surfaces_style==="Mesh"?(c.lineWidth(b.shapes_lineWidth),c.drawElements(c.LINES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)):c.drawElements(c.TRIANGLES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0))}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,ChemDoodle.lib.MarchingCubes,ChemDoodle.lib.vec3,Math);
(function(q,B,w,u,l){B.SASSurface=function(n,d,e){this.atoms=n;this.probeRadius=d;this.resolution=e;this.build(n,d,e)};(B.SASSurface.prototype=new B._Surface).calculate=function(n,d,e){let c=Infinity;n=new q.Atom("C",n,d,e);for(let b=0,f=this.atoms.length;b<f;b++)d=this.atoms[b],e=w[d.label]&&w[d.label].vdWRadius!==0?w[d.label].vdWRadius:2,d=d.distance3D(n)-this.probeRadius-e,c=u.min(c,d);return c}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(q,B,w,u,l){B.VDWSurface=function(n,d){this.atoms=n;this.probeRadius=0;this.resolution=d;this.build(n,0,d)};(B.VDWSurface.prototype=new B._Surface).calculate=function(n,d,e){let c=Infinity;n=new q.Atom("C",n,d,e);for(let b=0,f=this.atoms.length;b<f;b++)d=this.atoms[b],e=w[d.label]&&w[d.label].vdWRadius!==0?w[d.label].vdWRadius:2,d=d.distance3D(n)-e,c=u.min(c,d);return c}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(q,B,w,u){q.Plate=function(l){this.lanes=Array(l);i=0;for(ii=l;i<ii;i++)this.lanes[i]=[]};u=q.Plate.prototype;u.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(l,n){return l-n})};u.draw=function(l,n){n=l.canvas.width;var d=l.canvas.height;this.origin=9*d/10;this.front=d/10;this.laneLength=this.origin-this.front;l.strokeStyle="#000000";l.beginPath();l.moveTo(0,this.front);l.lineTo(n,this.front);l.setLineDash([3]);l.stroke();l.setLineDash([]);l.beginPath();
l.moveTo(0,this.origin);l.lineTo(n,this.origin);l.closePath();l.stroke();i=0;for(ii=this.lanes.length;i<ii;i++)for(d=(i+1)*n/(ii+1),l.beginPath(),l.moveTo(d,this.origin),l.lineTo(d,this.origin+3),l.closePath(),l.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){let e=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":l.beginPath();l.arc(d,e,3,0,2*w.PI,!1);l.closePath();break;case "expanded":l.beginPath();l.arc(d,e,7,0,2*w.PI,!1);l.closePath();break;case "widened":B.contextEllipse(l,
d-18,e-10,36,10);break;case "cresent":l.beginPath(),l.arc(d,e,9,0,w.PI,!0),l.closePath()}switch(this.lanes[i][s].style){case "solid":l.fillStyle="#000000";l.fill();break;case "transparent":l.stroke()}}};q.Plate.Spot=function(l,n,d){this.type=l;this.rf=n;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(q,B,w,u,l,n){q.DEFAULT_STYLES={backgroundColor:"#FFFFFF",scale:1,rotateAngle:0,bondLength_2D:20,angstromsPerBondLength:1.25,lightDirection_3D:[-.1,-.1,-1],lightDiffuseColor_3D:"#FFFFFF",lightSpecularColor_3D:"#FFFFFF",projectionPerspective_3D:!0,projectionPerspectiveVerticalFieldOfView_3D:45,projectionOrthoWidth_3D:40,projectionWidthHeightRatio_3D:n,projectionFrontCulling_3D:.1,projectionBackCulling_3D:1E4,cullBackFace_3D:!0,fog_mode_3D:0,fog_color_3D:"#000000",fog_start_3D:0,fog_end_3D:1,
fog_density_3D:1,shadow_3D:!1,shadow_intensity_3D:.85,flat_color_3D:!1,antialias_3D:!0,gammaCorrection_3D:2.2,colorHover:"#885110",colorSelect:"#0060B2",colorError:"#c10000",colorPreview:"#00FF00",ssao_3D:!1,ssao_kernel_radius:17,ssao_kernel_samples:32,ssao_power:1,outline_3D:!1,outline_thickness:1,outline_normal_threshold:.85,outline_depth_threshold:.1,fxaa_edgeThreshold:.0625,fxaa_edgeThresholdMin:1/12,fxaa_searchSteps:64,fxaa_searchThreshold:.25,fxaa_subpixCap:1,fxaa_subpixTrim:0,smaa_useSMAA:!0,
smaa_edgeThreshold:.1,smaa_contrastFactor:2,smaa_searchSteps:16,atoms_display:!0,atoms_color:"#000000",atoms_font_size_2D:12,atoms_font_families_2D:["Helvetica","Arial","Dialog"],atoms_font_bold_2D:!1,atoms_font_italic_2D:!1,atoms_circles_2D:!1,atoms_circleDiameter_2D:10,atoms_circleBorderWidth_2D:1,atoms_lonePairDistance_2D:8,atoms_lonePairSpread_2D:4,atoms_lonePairDiameter_2D:1,atoms_useJMOLColors:!1,atoms_usePYMOLColors:!1,atoms_HBlack_2D:!0,atoms_implicitHydrogens_2D:!0,atoms_displayTerminalCarbonLabels_2D:!1,
atoms_showHiddenCarbons_2D:!0,atoms_showAttributedCarbons_2D:!0,atoms_displayAllCarbonLabels_2D:!1,atoms_resolution_3D:30,atoms_sphereDiameter_3D:.8,atoms_useVDWDiameters_3D:!1,atoms_vdwMultiplier_3D:1,atoms_materialAmbientColor_3D:"#000000",atoms_materialSpecularColor_3D:"#555555",atoms_materialShininess_3D:32,atoms_nonBondedAsStars_3D:!1,atoms_displayLabels_3D:!1,bonds_display:!0,bonds_color:"#000000",bonds_width_2D:1,bonds_useAbsoluteSaturationWidths_2D:!0,bonds_saturationWidth_2D:.2,bonds_saturationWidthAbs_2D:5,
bonds_ends_2D:"round",bonds_splitColor:!1,bonds_colorGradient:!1,bonds_saturationAngle_2D:w.PI/3,bonds_symmetrical_2D:!1,bonds_clearOverlaps_2D:!1,bonds_overlapClearWidth_2D:.5,bonds_atomLabelBuffer_2D:1,bonds_wedgeThickness_2D:6,bonds_wavyLength_2D:4,bonds_hashWidth_2D:1,bonds_hashSpacing_2D:2.5,bonds_dotSize_2D:2,bonds_lewisStyle_2D:!1,bonds_showBondOrders_3D:!1,bonds_resolution_3D:30,bonds_renderAsLines_3D:!1,bonds_cylinderDiameter_3D:.3,bonds_pillLatitudeResolution_3D:10,bonds_pillLongitudeResolution_3D:20,
bonds_pillHeight_3D:.3,bonds_pillSpacing_3D:.1,bonds_pillDiameter_3D:.3,bonds_materialAmbientColor_3D:"#000000",bonds_materialSpecularColor_3D:"#555555",bonds_materialShininess_3D:32,proteins_displayRibbon:!0,proteins_displayBackbone:!1,proteins_backboneThickness:1.5,proteins_backboneColor:"#CCCCCC",proteins_ribbonCartoonize:!1,proteins_displayPipePlank:!1,proteins_residueColor:"none",proteins_primaryColor:"#FF0D0D",proteins_secondaryColor:"#FFFF30",proteins_ribbonCartoonHelixPrimaryColor:"#00E740",
proteins_ribbonCartoonHelixSecondaryColor:"#9905FF",proteins_ribbonCartoonSheetColor:"#E8BB99",proteins_tubeColor:"#FF0D0D",proteins_tubeResolution_3D:15,proteins_ribbonThickness:.2,proteins_tubeThickness:.5,proteins_plankSheetWidth:3.5,proteins_cylinderHelixDiameter:4,proteins_verticalResolution:8,proteins_horizontalResolution:8,proteins_materialAmbientColor_3D:"#000000",proteins_materialSpecularColor_3D:"#555555",proteins_materialShininess_3D:32,nucleics_display:!0,nucleics_tubeColor:"#CCCCCC",
nucleics_baseColor:"#C10000",nucleics_residueColor:"none",nucleics_tubeThickness:1.5,nucleics_tubeResolution_3D:15,nucleics_verticalResolution:8,nucleics_materialAmbientColor_3D:"#000000",nucleics_materialSpecularColor_3D:"#555555",nucleics_materialShininess_3D:32,macro_displayAtoms:!1,macro_displayBonds:!1,macro_atomToLigandDistance:-1,macro_showWater:!1,macro_colorByChain:!1,macro_rainbowColors:["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],surfaces_display:!0,surfaces_alpha:.5,surfaces_style:"Solid",
surfaces_color:"white",surfaces_materialAmbientColor_3D:"#000000",surfaces_materialSpecularColor_3D:"#000000",surfaces_materialShininess_3D:32,plots_color:"#000000",plots_width:1,plots_showIntegration:!1,plots_integrationColor:"#c10000",plots_integrationLineWidth:1,plots_showGrid:!1,plots_gridColor:"gray",plots_gridLineWidth:.5,plots_showYAxis:!0,plots_flipXAxis:!1,text_font_size:12,text_font_families:["Helvetica","Arial","Dialog"],text_font_bold:!0,text_font_italic:!1,text_font_stroke_3D:!0,text_color:"#000000",
shapes_color:"#000000",shapes_lineWidth:1,shapes_pointSize:2,shapes_arrowLength_2D:8,compass_display:!1,compass_axisXColor_3D:"#FF0000",compass_axisYColor_3D:"#00FF00",compass_axisZColor_3D:"#0000FF",compass_size_3D:50,compass_resolution_3D:10,compass_displayText_3D:!0,compass_type_3D:0,measurement_update_3D:!1,measurement_angleBands_3D:10,measurement_displayText_3D:!0};B.Styles=function(d){l.assign(this,u.parse(u.stringify(d===n?q.DEFAULT_STYLES:d)))};w=B.Styles.prototype;w.set3DRepresentation=function(d){this.bonds_display=
this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_splitColor=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;d==="Ball and Stick"?(this.atoms_vdwMultiplier_3D=.3,this.bonds_splitColor=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):d==="van der Waals Spheres"?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=
1):d==="Stick"?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):d==="Wireframe"?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D):d==="Line"?(this.atoms_display=!1,this.bonds_renderAsLines_3D=
!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+d+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};w.copy=function(){return new B.Styles(this)}})(ChemDoodle,ChemDoodle.structures,Math,JSON,Object);
(function(q,B,w,u,l){w.getPointsPerAngstrom=function(){return q.DEFAULT_STYLES.bondLength_2D/q.DEFAULT_STYLES.angstromsPerBondLength};w.BondDeducer=function(){};l=w.BondDeducer.prototype;l.margin=1.1;l.deduceCovalentBonds=function(n,d){let e=w.getPointsPerAngstrom();d&&(e=d);for(let c=0,b=n.atoms.length;c<b;c++)for(d=c+1;d<b;d++){let f=n.atoms[c],g=n.atoms[d];f.distance3D(g)<(B[f.label].covalentRadius+B[g.label].covalentRadius)*e*this.margin&&n.bonds.push(new u.Bond(f,g,1))}}})(ChemDoodle,ChemDoodle.ELEMENT,
ChemDoodle.informatics,ChemDoodle.structures);
(function(q,B,w){q.HydrogenDeducer=function(){};q.HydrogenDeducer.prototype.removeHydrogens=function(u,l){let n=[],d=[];for(let e=0,c=u.bonds.length;e<c;e++){let b=u.bonds[e],f=b.a1.label!=="H"&&b.a2.label!=="H";f||l||b.stereo===B.Bond.STEREO_NONE||(f=!0);f?(b.a1.tag=!0,d.push(b)):(b.a1.label==="H"&&(b.a1.remove=!0),b.a2.label==="H"&&(b.a2.remove=!0))}for(let e=0,c=u.atoms.length;e<c;e++)l=u.atoms[e],l.remove?l.remove=w:n.push(l);u.atoms=n;u.bonds=d}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(q,B,w){q.Splitter=function(){};q.Splitter.prototype.split=function(u){let l=[];for(let e=0,c=u.atoms.length;e<c;e++)u.atoms[e].visited=!1;for(let e=0,c=u.bonds.length;e<c;e++)u.bonds[e].visited=!1;for(let e=0,c=u.atoms.length;e<c;e++){var n=u.atoms[e];if(!n.visited){let b=new B.Molecule;b.atoms.push(n);n.visited=!0;let f=new B.Queue;for(f.enqueue(n);!f.isEmpty();){n=f.dequeue();for(let g=0,k=u.bonds.length;g<k;g++){var d=u.bonds[g];d.contains(n)&&!d.visited&&(d.visited=!0,b.bonds.push(d),
d=d.getNeighbor(n),d.visited||(d.visited=!0,b.atoms.push(d),f.enqueue(d)))}}l.push(b)}}return l}})(ChemDoodle.informatics,ChemDoodle.structures);(function(q,B,w,u){q.StructureBuilder=function(){};q.StructureBuilder.prototype.copy=function(l){let n=new B.JSONInterpreter;return n.molFrom(n.molTo(l))}})(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures);
(function(q,B){q._Counter=function(){};q=q._Counter.prototype;q.value=0;q.molecule=B;q.setMolecule=function(w){this.value=0;this.molecule=w;this.innerCalculate&&this.innerCalculate()}})(ChemDoodle.informatics);(function(q,B){q.FrerejacqueNumberCounter=function(w){this.setMolecule(w)};(q.FrerejacqueNumberCounter.prototype=new q._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new q.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(q,B,w){B.NumberOfMoleculesCounter=function(u){this.setMolecule(u)};(B.NumberOfMoleculesCounter.prototype=new B._Counter).innerCalculate=function(){for(let l=0,n=this.molecule.atoms.length;l<n;l++)this.molecule.atoms[l].visited=!1;for(let l=0,n=this.molecule.atoms.length;l<n;l++)if(!this.molecule.atoms[l].visited){this.value++;let d=new q.Queue;this.molecule.atoms[l].visited=!0;for(d.enqueue(this.molecule.atoms[l]);!d.isEmpty();){let e=d.dequeue();for(let c=0,b=this.molecule.bonds.length;c<
b;c++){var u=this.molecule.bonds[c];u.contains(e)&&(u=u.getNeighbor(e),u.visited||(u.visited=!0,d.enqueue(u)))}}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(q,B){q._RingFinder=function(){};q=q._RingFinder.prototype;q.atoms=B;q.bonds=B;q.rings=B;q.reduce=function(w){for(let l=0,n=w.atoms.length;l<n;l++)w.atoms[l].visited=!1;for(let l=0,n=w.bonds.length;l<n;l++)w.bonds[l].visited=!1;let u=!0;for(;u;){u=!1;for(let l=0,n=w.atoms.length;l<n;l++){let d=0,e;for(let c=0,b=w.bonds.length;c<b;c++)if(w.bonds[c].contains(w.atoms[l])&&!w.bonds[c].visited){d++;if(d===2)break;e=w.bonds[c]}d===1&&(u=!0,e.visited=!0,w.atoms[l].visited=!0)}}for(let l=0,n=w.atoms.length;l<
n;l++)w.atoms[l].visited||this.atoms.push(w.atoms[l]);for(let l=0,n=w.bonds.length;l<n;l++)w.bonds[l].visited||this.bonds.push(w.bonds[l]);this.bonds.length===0&&this.atoms.length!==0&&(this.atoms=[])};q.setMolecule=function(w){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(w);this.atoms.length>2&&this.innerGetRings&&this.innerGetRings()};q.fuse=function(){for(let w=0,u=this.rings.length;w<u;w++)for(let l=0,n=this.bonds.length;l<n;l++)this.rings[w].atoms.indexOf(this.bonds[l].a1)!==-1&&this.rings[w].atoms.indexOf(this.bonds[l].a2)!==
-1&&this.rings[w].bonds.push(this.bonds[l])}})(ChemDoodle.informatics);
(function(q,B,w){function u(n,d){this.atoms=[];if(d)for(let e=0,c=d.atoms.length;e<c;e++)this.atoms[e]=d.atoms[e];this.atoms.push(n)}let l=u.prototype;l.grow=function(n,d){let e=this.atoms[this.atoms.length-1],c=[];for(let b=0,f=n.length;b<f;b++)if(n[b].contains(e)){let g=n[b].getNeighbor(e);d.indexOf(g)===-1&&c.push(g)}n=[];for(let b=0,f=c.length;b<f;b++)n.push(new u(c[b],this));return n};l.check=function(n,d,e){for(let b=0,f=d.atoms.length-1;b<f;b++)if(this.atoms.indexOf(d.atoms[b])!==-1)return w;
let c;if(d.atoms[d.atoms.length-1]===this.atoms[this.atoms.length-1]){c=new B.Ring;c.atoms[0]=e;for(let b=0,f=this.atoms.length;b<f;b++)c.atoms.push(this.atoms[b]);for(n=d.atoms.length-2;n>=0;n--)c.atoms.push(d.atoms[n])}else{let b=[];for(let f=0,g=n.length;f<g;f++)n[f].contains(d.atoms[d.atoms.length-1])&&b.push(n[f]);for(let f=0,g=b.length;f<g;f++)if((d.atoms.length===1||!b[f].contains(d.atoms[d.atoms.length-2]))&&b[f].contains(this.atoms[this.atoms.length-1])){c=new B.Ring;c.atoms[0]=e;for(let k=
0,m=this.atoms.length;k<m;k++)c.atoms.push(this.atoms[k]);for(n=d.atoms.length-1;n>=0;n--)c.atoms.push(d.atoms[n]);break}}return c};q.EulerFacetRingFinder=function(n){this.setMolecule(n)};q=q.EulerFacetRingFinder.prototype=new q._RingFinder;q.fingerBreak=5;q.innerGetRings=function(){for(let f=0,g=this.atoms.length;f<g;f++){let k=[];for(let m=0,r=this.bonds.length;m<r;m++)this.bonds[m].contains(this.atoms[f])&&k.push(this.bonds[m].getNeighbor(this.atoms[f]));for(let m=0,r=k.length;m<r;m++)for(let t=
m+1;t<k.length;t++){var n=[];n[0]=new u(k[m]);n[1]=new u(k[t]);var d=[];d[0]=this.atoms[f];for(let v=0,x=k.length;v<x;v++)v!==m&&v!==t&&d.push(k[v]);var e=[],c=n[0].check(this.bonds,n[1],this.atoms[f]);for(c&&(e[0]=c);e.length===0&&n.length>0&&n[0].atoms.length<this.fingerBreak;){c=[];for(let v=0,x=n.length;v<x;v++){var b=n[v].grow(this.bonds,d);for(let y=0,a=b.length;y<a;y++)c.push(b[y])}n=c;for(let v=0,x=n.length;v<x;v++)for(c=v+1;c<x;c++)(b=n[v].check(this.bonds,n[c],this.atoms[f]))&&e.push(b);
if(e.length===0){c=[];for(let v=0,x=d.length;v<x;v++)for(let y=0,a=this.bonds.length;y<a;y++)this.bonds[y].contains(d[v])&&(b=this.bonds[y].getNeighbor(d[v]),d.indexOf(b)===-1&&c.indexOf(b)===-1&&c.push(b));for(let v=0,x=c.length;v<x;v++)d.push(c[v])}}if(e.length>0){n=w;for(let v=0,x=e.length;v<x;v++)if(!n||n.atoms.length>e[v].atoms.length)n=e[v];e=!1;for(let v=0,x=this.rings.length;v<x;v++){d=!0;for(let y=0,a=n.atoms.length;y<a;y++)if(this.rings[v].atoms.indexOf(n.atoms[y])===-1){d=!1;break}if(d){e=
!0;break}}e||this.rings.push(n)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(q,B){q.SSSRFinder=function(w){this.rings=[];if(w.atoms.length>0){let u=(new q.FrerejacqueNumberCounter(w)).value,l=(new q.EulerFacetRingFinder(w)).rings;l.sort(function(n,d){return n.atoms.length-d.atoms.length});for(let n=0,d=w.bonds.length;n<d;n++)w.bonds[n].visited=!1;for(let n=0,d=l.length;n<d;n++){w=!1;for(let e=0,c=l[n].bonds.length;e<c;e++)if(!l[n].bonds[e].visited){w=!0;break}if(w){for(let e=0,c=l[n].bonds.length;e<c;e++)l[n].bonds[e].visited=!0;this.rings.push(l[n])}if(this.rings.length===
u)break}}}})(ChemDoodle.informatics);(function(q,B){q._Interpreter=function(){};q._Interpreter.prototype.fit=function(w,u,l){let n=w.length,d=[];for(let e=0;e<u-n;e++)d.push(" ");return l?w+d.join(""):d.join("")+w}})(ChemDoodle.io);
(function(q,B,w,u,l,n,d,e){let c=/\s+/g,b=/\(|\)|\s+/g,f=/'|\s+/g,g=/,|'|\s+/g,k=/^\s+/,m=/[0-9]/g,r=/[0-9]|\+|\-/g,t=function(a){return a.length!==0},v={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},x=function(a){let h=0,p=0,z=0,A=0;var C=a.indexOf("x"),D=a.indexOf("y");let E=a.indexOf("z");C!==-1&&(p++,C>0&&a.charAt(C-1)!=="+"&&(p*=-1));D!==-1&&(z++,
D>0&&a.charAt(D-1)!=="+"&&(z*=-1));E!==-1&&(A++,E>0&&a.charAt(E-1)!=="+"&&(A*=-1));if(a.length>2){C="+";for(let F=0,G=a.length;F<G;F++)D=a.charAt(F),D!=="-"&&D!=="/"||F!==a.length-1&&!a.charAt(F+1).match(m)||(C=D),D.match(m)&&(C==="+"?h+=parseInt(D):C==="-"?h-=parseInt(D):C==="/"&&(h/=parseInt(D)))}return[h,p,z,A]};B.CIFInterpreter=function(){};B.CIFInterpreter.generateABC2XYZ=function(a,h,p,z,A,C){z=(l.cos(z)-l.cos(C)*l.cos(A))/l.sin(C);return[a,0,0,0,h*l.cos(C),h*l.sin(C),0,0,p*l.cos(A),p*z,p*l.sqrt(1-
l.pow(l.cos(A),2)-z*z),0,0,0,0,1]};(B.CIFInterpreter.prototype=new B._Interpreter).read=function(a,h,p,z){h=h?h:1;p=p?p:1;z=z?z:1;let A=new w.Molecule;if(!a)return A;var C=a.split("\n");let D=a=0,E=0,F=0,G=0,I=0;var J="P",M,H;let R;for(var K,L=!0;C.length>0;)if(L?K=C.shift():L=!0,K.length>0)if(K.startsWith("_cell_length_a"))a=parseFloat(K.split(b)[1]);else if(K.startsWith("_cell_length_b"))D=parseFloat(K.split(b)[1]);else if(K.startsWith("_cell_length_c"))E=parseFloat(K.split(b)[1]);else if(K.startsWith("_cell_angle_alpha"))F=
l.PI*parseFloat(K.split(b)[1])/180;else if(K.startsWith("_cell_angle_beta"))G=l.PI*parseFloat(K.split(b)[1])/180;else if(K.startsWith("_cell_angle_gamma"))I=l.PI*parseFloat(K.split(b)[1])/180;else if(K.startsWith("_symmetry_space_group_name_H-M"))J=K.split(f)[1];else if(K.startsWith("loop_")){for(var N={fields:[],lines:[]},Q=!1;(K=C.shift())!==e&&!(K=K.replace(k,"")).startsWith("loop_")&&K.length>0;)if(K.startsWith("_")){if(Q)break;N.fields=N.fields.concat(K.split(c).filter(t))}else Q=!0,N.lines.push(K);
C.length!==0&&(K.startsWith("loop_")||K.startsWith("_"))&&(L=!1);N.fields.indexOf("_symmetry_equiv_pos_as_xyz")!==-1||N.fields.indexOf("_space_group_symop_operation_xyz")!==-1?M=N:N.fields.indexOf("_atom_site_label")!==-1?H=N:N.fields.indexOf("_geom_bond_atom_site_label_1")!==-1&&(R=N)}C=B.CIFInterpreter.generateABC2XYZ(a,D,E,F,G,I);if(H){var O=Q=N=L=-1,S=-1;for(let P=0,U=H.fields.length;P<U;P++)K=H.fields[P],K==="_atom_site_type_symbol"?L=P:K==="_atom_site_label"?N=P:K==="_atom_site_fract_x"?Q=P:
K==="_atom_site_fract_y"?O=P:K==="_atom_site_fract_z"&&(S=P);for(let P=0,U=H.lines.length;P<U;P++){K=H.lines[P];K=K.split(c).filter(t);var T=new w.Atom(K[L===-1?N:L].split(r)[0],parseFloat(K[Q]),parseFloat(K[O]),parseFloat(K[S]));A.atoms.push(T);N!==-1&&(T.cifId=K[N],T.cifPart=0)}}if(M&&!R){H=0;for(let P=0,U=M.fields.length;P<U;P++)if(K=M.fields[P],K==="_symmetry_equiv_pos_as_xyz"||K==="_space_group_symop_operation_xyz")H=P;K=v[J];J=[];for(let P=0,U=M.lines.length;P<U;P++){Q=M.lines[P].split(g).filter(t);
L=x(Q[H]);N=x(Q[H+1]);Q=x(Q[H+2]);for(let W=0,X=A.atoms.length;W<X;W++){O=A.atoms[W];S=O.x*L[1]+O.y*L[2]+O.z*L[3]+L[0];T=O.x*N[1]+O.y*N[2]+O.z*N[3]+N[0];let aa=O.x*Q[1]+O.y*Q[2]+O.z*Q[3]+Q[0];var V=new w.Atom(O.label,S,T,aa);J.push(V);O.cifId!==e&&(V.cifId=O.cifId,V.cifPart=P+1);if(K)for(let Z=0,Y=K.length;Z<Y;Z++)V=K[Z],V=new w.Atom(O.label,S+V[0],T+V[1],aa+V[2]),J.push(V),O.cifId!==e&&(V.cifId=O.cifId,V.cifPart=P+1)}}for(let P=0,U=J.length;P<U;P++){for(H=J[P];H.x>=1;)H.x--;for(;H.x<0;)H.x++;for(;H.y>=
1;)H.y--;for(;H.y<0;)H.y++;for(;H.z>=1;)H.z--;for(;H.z<0;)H.z++}H=[];for(let P=0,U=J.length;P<U;P++){K=!1;L=J[P];for(let W=0,X=A.atoms.length;W<X;W++)if(A.atoms[W].distance3D(L)<1E-4){K=!0;break}if(!K){for(let W=0,X=H.length;W<X;W++)if(H[W].distance3D(L)<1E-4){K=!0;break}K||H.push(L)}}A.atoms=A.atoms.concat(H)}J=[];for(H=0;H<h;H++)for(K=0;K<p;K++)for(L=0;L<z;L++)if(H!==0||K!==0||L!==0)for(let P=0,U=A.atoms.length;P<U;P++)N=A.atoms[P],Q=new w.Atom(N.label,N.x+H,N.y+K,N.z+L),J.push(Q),N.cifId!==e&&
(Q.cifId=N.cifId,Q.cifPart=N.cifPart+(M?M.lines.length:0)+H+K*10+L*100);A.atoms=A.atoms.concat(J);for(let P=0,U=A.atoms.length;P<U;P++)h=A.atoms[P],p=n.multiplyVec3(C,[h.x,h.y,h.z]),h.x=p[0],h.y=p[1],h.z=p[2];if(R){p=h=-1;for(let P=0,U=R.fields.length;P<U;P++)z=R.fields[P],z==="_geom_bond_atom_site_label_1"?h=P:z==="_geom_bond_atom_site_label_2"&&(p=P);for(let P=0,U=R.lines.length;P<U;P++){M=R.lines[P].split(c).filter(t);z=M[h];M=M[p];for(let W=0,X=A.atoms.length;W<X;W++)for(C=W+1;C<X;C++){J=A.atoms[W];
H=A.atoms[C];if(J.cifPart!==H.cifPart)break;(J.cifId===z&&H.cifId===M||J.cifId===M&&H.cifId===z)&&A.bonds.push(new w.Bond(J,H))}}}else(new q.informatics.BondDeducer).deduceCovalentBonds(A,1);return{molecule:A,unitCell:new u.UnitCell([a,D,E],[F,G,I],[0,0,0])}};let y=new B.CIFInterpreter;q.readCIF=function(a,h,p,z){return y.read(a,h,p,z)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(q,B,w,u){B.CMLInterpreter=function(){};u=B.CMLInterpreter.prototype=new B._Interpreter;u.read=function(n){let d=[];n=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("cml");for(let k=0,m=n.length;k<m;k++){let r=n[k].getElementsByTagName("molecule");for(let t=0,v=r.length;t<v;t++){let x=d[t]=new w.Molecule,y=[];var e=r[t].getElementsByTagName("atom");for(let a=0,h=e.length;a<h;a++){var c=e[a],b=c.getAttribute("elementType"),f=c.getAttribute("x2"),g=c.getAttribute("y2");
let p=0;if(f===null||f==="")f=c.getAttribute("x3"),g=c.getAttribute("y3"),p=c.getAttribute("z3");b=d[t].atoms[a]=new w.Atom(b,f,g,p);y[a]=c.getAttribute("id");c.getAttribute("formalCharge")!==null&&(b.charge=c.getAttribute("formalCharge"))}e=r[t].getElementsByTagName("bond");for(let a=0,h=e.length;a<h;a++){c=e[a];f=c.getAttribute("atomRefs2").split(" ");b=x.atoms[y.indexOf(f[0])];f=x.atoms[y.indexOf(f[1])];switch(c.getAttribute("order")){case "2":case "D":g=2;break;case "3":case "T":g=3;break;case "A":g=
1.5;break;default:g=1}b=d[t].bonds[a]=new w.Bond(b,f,g);if(c=c.querySelector("bondStereo"))switch(c.textContent){case "W":b.stereo=w.Bond.STEREO_PROTRUDING;break;case "H":b.stereo=w.Bond.STEREO_RECESSED}}}}return d};u.write=function(n){let d=[];d.push('\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e\n');d.push('\x3ccml convention\x3d"conventions:molecular" xmlns\x3d"http://www.xml-cml.org/schema" xmlns:conventions\x3d"http://www.xml-cml.org/convention/" xmlns:dc\x3d"http://purl.org/dc/elements/1.1/"\x3e\n');
for(let c=0,b=n.length;c<b;c++){d.push('\x3cmolecule id\x3d"m');d.push(c);d.push('"\x3e');d.push("\x3catomArray\x3e");for(let f=0,g=n[c].atoms.length;f<g;f++){var e=n[c].atoms[f];d.push('\x3catom elementType\x3d"');d.push(e.label);d.push('" id\x3d"a');d.push(f);d.push('" ');d.push('x3\x3d"');d.push(e.x);d.push('" y3\x3d"');d.push(e.y);d.push('" z3\x3d"');d.push(e.z);d.push('" ');e.charge!=0&&(d.push('formalCharge\x3d"'),d.push(e.charge),d.push('" '));d.push("/\x3e")}d.push("\x3c/atomArray\x3e");d.push("\x3cbondArray\x3e");
for(let f=0,g=n[c].bonds.length;f<g;f++){e=n[c].bonds[f];d.push('\x3cbond atomRefs2\x3d"a');d.push(n[c].atoms.indexOf(e.a1));d.push(" a");d.push(n[c].atoms.indexOf(e.a2));d.push('" order\x3d"');switch(e.bondOrder){case 1.5:d.push("A");break;case 1:case 2:case 3:d.push(e.bondOrder);break;default:d.push("S")}d.push('"/\x3e')}d.push("\x3c/bondArray\x3e");d.push("\x3c/molecule\x3e")}d.push("\x3c/cml\x3e");return d.join("")};let l=new B.CMLInterpreter;q.readCML=function(n){return l.read(n)};q.writeCML=
function(n){return l.write(n)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(q,B,w,u,l){w.MOLInterpreter=function(){};let n=w.MOLInterpreter.prototype=new w._Interpreter;n.version=2;n.read=function(c,b){b||(b=q.DEFAULT_STYLES.bondLength_2D);let f=new u.Molecule;if(!c)return f;c=c.split("\n");var g=c[3],k=parseInt(g.substring(0,3)),m=parseInt(g.substring(3,6));g=g.substring(34,39).trim().toUpperCase()==="V3000"?3:2;if(g===2){for(var r=0;r<k;r++){g=c[4+r];var t=new u.Atom(g.substring(31,34),parseFloat(g.substring(0,10))*b,(b===1?1:-1)*parseFloat(g.substring(10,20))*
b,parseFloat(g.substring(20,30))*b),v=parseInt(g.substring(34,36));v!==0&&B[t.label]&&(t.mass=B[t.label].mass+v);switch(parseInt(g.substring(36,39))){case 1:t.charge=3;break;case 2:t.charge=2;break;case 3:t.charge=1;break;case 5:t.charge=-1;break;case 6:t.charge=-2;break;case 7:t.charge=-3}f.atoms[r]=t}for(b=0;b<m;b++){g=c[4+k+b];t=parseInt(g.substring(6,9));r=parseInt(g.substring(9,12));if(t>3)switch(t){case 4:t=1.5;break;default:t=1}g=new u.Bond(f.atoms[parseInt(g.substring(0,3))-1],f.atoms[parseInt(g.substring(3,
6))-1],t);switch(r){case 3:g.stereo=u.Bond.STEREO_AMBIGUOUS;break;case 1:g.stereo=u.Bond.STEREO_PROTRUDING;break;case 6:g.stereo=u.Bond.STEREO_RECESSED}f.bonds[b]=g}}else if(g===3)for(let x=4,y=c.length;x<y;x++)if(m=c[x].trim(),m.startsWith("M  V30 "))if(m=m.substring(7),m.startsWith("BEGIN "))r=m.substring(6);else if(m.startsWith("END "))r=l;else if(k=m.split(/(\s+)/).filter(a=>a.trim().length>0),r==="ATOM"){m=new u.Atom(k[1],parseFloat(k[2])*b,(b===1?1:-1)*parseFloat(k[3])*b,parseFloat(k[4])*b);
for(let a=6,h=k.length;a<h;a++)t=k[a],v=t.indexOf("\x3d"),v!==-1&&(g=t.substring(0,v),t=t.substring(v+1),g==="CHG"?m.charge=parseInt(t):g==="RAD"?m.numRadical=parseInt(t):g==="MASS"&&(m.mass=parseInt(t)));f.atoms.push(m)}else if(r==="BOND"){m=parseInt(k[1]);if(m>3)switch(m){case 4:m=1.5;break;default:m=1}m=new u.Bond(f.atoms[parseInt(k[2])-1],f.atoms[parseInt(k[3])-1],m);for(let a=4,h=k.length;a<h;a++)if(t=k[a],v=t.indexOf("\x3d"),v!==-1&&(g=t.substring(0,v),t=t.substring(v+1),g==="CFG"))switch(parseInt(t)){case 2:m.stereo=
u.Bond.STEREO_AMBIGUOUS;break;case 1:m.stereo=u.Bond.STEREO_PROTRUDING;break;case 3:m.stereo=u.Bond.STEREO_RECESSED}f.bonds.push(m)}else if(r==="COLLECTION")if(m.startsWith("MDLV30/STEREL")){m=m.substring(13);g=m.indexOf(" ");k=parseInt(m.substring(0,g));m=m.substring(g+1);m=m.substring(7,m.length-1);m=m.split(/(\s+)/).filter(a=>a.trim().length>0);for(let a=1,h=m.length;a<h;a++)f.atoms[parseInt(m[a])-1].enhancedStereo={type:u.Atom.ESTEREO_OR,group:k}}else if(m.startsWith("MDLV30/STERAC")){m=m.substring(13);
g=m.indexOf(" ");k=parseInt(m.substring(0,g));m=m.substring(g+1);m=m.substring(7,m.length-1);m=m.split(/(\s+)/).filter(a=>a.trim().length>0);for(let a=1,h=m.length;a<h;a++)f.atoms[parseInt(m[a])-1].enhancedStereo={type:u.Atom.ESTEREO_AND,group:k}}return f};n.write=function(c){let b=[];b.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");b.push(this.fit(c.atoms.length.toString(),3));b.push(this.fit(c.bonds.length.toString(),3));b.push("  0  0  0  0            999 V"+this.version+
"000\n");var f=c.getCenter();if(this.version===2){for(let t=0,v=c.atoms.length;t<v;t++){var g=c.atoms[t],k=" 0";if(g.mass!==-1&&B[g.label]){var m=g.mass-B[g.label].mass;m<5&&m>-4&&(k=(m>-1?" ":"")+m)}m="  0";if(g.charge!==0)switch(g.charge){case 3:m="  1";break;case 2:m="  2";break;case 1:m="  3";break;case -1:m="  5";break;case -2:m="  6";break;case -3:m="  7"}b.push(this.fit(((g.x-f.x)/q.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));b.push(this.fit((-(g.y-f.y)/q.DEFAULT_STYLES.bondLength_2D).toFixed(4),
10));b.push(this.fit((g.z/q.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));b.push(" ");b.push(this.fit(g.label,3,!0));b.push(k);b.push(m);b.push("  0  0  0  0\n")}for(let t=0,v=c.bonds.length;t<v;t++){k=c.bonds[t];g=0;k.stereo===u.Bond.STEREO_AMBIGUOUS?g=3:k.stereo===u.Bond.STEREO_PROTRUDING?g=1:k.stereo===u.Bond.STEREO_RECESSED&&(g=6);b.push(this.fit((c.atoms.indexOf(k.a1)+1).toString(),3));b.push(this.fit((c.atoms.indexOf(k.a2)+1).toString(),3));k=k.bondOrder;if(k==1.5)k=4;else if(k>3||k%1!=0)k=
1;b.push(this.fit(k.toString(),3));b.push("  ");b.push(g);b.push("  0  0  0\n")}}else if(this.version===3){b.push("M  V30 BEGIN CTAB\n");b.push("M  V30 COUNTS ");b.push(c.atoms.length);b.push(" ");b.push(c.bonds.length);b.push(" 0 0 0\n");b.push("M  V30 BEGIN ATOM\n");for(let t=0,v=c.atoms.length;t<v;t++){var r=c.atoms[t];b.push("M  V30 ");b.push(t+1);b.push(" ");b.push(r.label);b.push(" ");b.push(((r.x-f.x)/q.DEFAULT_STYLES.bondLength_2D).toFixed(6));b.push(" ");b.push((-(r.y-f.y)/q.DEFAULT_STYLES.bondLength_2D).toFixed(6));
b.push(" ");b.push((r.z/q.DEFAULT_STYLES.bondLength_2D).toFixed(6));b.push(" 0");r.charge!==0&&(b.push(" CHG\x3d"),b.push(r.charge));r.numRadical!==0&&(b.push(" RAD\x3d"),b.push(r.numRadical));r.mass!==-1&&(b.push(" MASS\x3d"),b.push(r.mass));b.push("\n")}b.push("M  V30 END ATOM\n");b.push("M  V30 BEGIN BOND\n");for(let t=0,v=c.bonds.length;t<v;t++){f=c.bonds[t];r=f.bondOrder;if(r==1.5)r=4;else if(r>3||r%1!=0)r=1;b.push("M  V30 ");b.push(t+1);b.push(" ");b.push(r);b.push(" ");b.push(c.atoms.indexOf(f.a1)+
1);b.push(" ");b.push(c.atoms.indexOf(f.a2)+1);f.stereo!==u.Bond.STEREO_NONE&&(r=0,f.stereo===u.Bond.STEREO_AMBIGUOUS?r=2:f.stereo===u.Bond.STEREO_PROTRUDING?r=1:f.stereo===u.Bond.STEREO_RECESSED&&(r=3),b.push(" CFG\x3d"),b.push(r));b.push("\n")}b.push("M  V30 END BOND\n");for(let t=0,v=c.atoms.length;t<v;t++)if(f=c.atoms[t],f.enhancedStereo.type!==u.Atom.ESTEREO_ABSOLUTE){k||(k=[],g=[]);f.enhancedStereo.type===u.Atom.ESTEREO_AND?m=k:f.enhancedStereo.type===u.Atom.ESTEREO_OR&&(m=g);let x;for(let y=
0,a=m.length;y<a;y++)if(r=m[y],r.group==f.enhancedStereo.group){x=r;break}x||(x={group:f.enhancedStereo.group,list:[]},m.push(x));x.list.push(f)}if(k&&(k.length>0||g.length>0)){b.push("M  V30 BEGIN COLLECTION\n");if(k.length>0)for(let t=0,v=k.length;t<v;t++){m=k[t];b.push("M  V30 MDLV30/STERAC");b.push(m.group);b.push(" ATOMS\x3d(");b.push(m.list.length);for(let x=0,y=m.list.length;x<y;x++)b.push(" "),b.push(c.atoms.indexOf(m.list[x])+1);b.push(")\n")}if(g.length>0)for(let t=0,v=g.length;t<v;t++){k=
g[t];b.push("M  V30 MDLV30/STEREL");b.push(k.group);b.push(" ATOMS\x3d(");b.push(k.list.length);for(let x=0,y=k.list.length;x<y;x++)b.push(" "),b.push(c.atoms.indexOf(k.list[x])+1);b.push(")\n")}b.push("M  V30 END COLLECTION\n")}b.push("M  V30 END CTAB\n")}b.push("M  END");return b.join("")};let d=new w.MOLInterpreter;q.readMOL=function(c,b){return d.read(c,b)};q.writeMOL=function(c){return d.write(c)};let e=new w.MOLInterpreter;e.version=3;q.writeMOLV3=function(c){return e.write(c)}})(ChemDoodle,
ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures);
(function(q,B,w,u,l,n){function d(c,b,f,g,k){for(let m=0,r=b.length;m<r;m++){let t=b[m];if(t.id===f&&g>=t.start&&g<=t.end){k?c.helix=!0:c.sheet=!0;g===t.end&&(c.arrow=!0);break}}}B.PDBInterpreter=function(){};n=B.PDBInterpreter.prototype=new B._Interpreter;n.calculateRibbonDistances=!1;n.deduceResidueBonds=!1;n.read=function(c,b){let f=new w.Molecule;f.chains=[];if(!c)return f;var g=c.split("\n");b||=1;var k=[];let m=[];let r=[];c=[];let t=[];for(let z=0,A=g.length;z<A;z++){var v=g[z];if(v.startsWith("HELIX"))k.push({id:v.substring(19,
20),start:parseInt(v.substring(21,25)),end:parseInt(v.substring(33,37))});else if(v.startsWith("SHEET"))m.push({id:v.substring(21,22),start:parseInt(v.substring(22,26)),end:parseInt(v.substring(33,37))});else if(v.startsWith("ATOM")){var x=v.substring(16,17);if(x===" "||x==="A"){x=v.substring(76,78).trim();if(x.length===0){var y=v.substring(12,14).trim();y==="HD"?x="H":y.length>0&&(x=y.length>1?y.charAt(0)+y.substring(1).toLowerCase():y)}x=new w.Atom(x,parseFloat(v.substring(30,38))*b,parseFloat(v.substring(38,
46))*b,parseFloat(v.substring(46,54))*b);x.hetatm=!1;c.push(x);y=parseInt(v.substring(22,26));if(r.length===0)for(var a=0;a<3;a++){var h=new w.Residue(-1);h.cp1=x;h.cp2=x;r.push(h)}r[r.length-1].resSeq!==y&&(a=new w.Residue(y),a.name=v.substring(17,20).trim(),a.name.length===3?a.name=a.name.substring(0,1)+a.name.substring(1).toLowerCase():a.name.length===2&&a.name.charAt(0)==="D"&&(a.name=a.name.substring(1)),r.push(a),h=v.substring(21,22),d(a,k,h,y,!0),d(a,m,h,y,!1));v=v.substring(12,16).trim();
y=r[r.length-1];if(v==="CA"||v==="P"||v==="O5'")y.cp1||(y.cp1=x);else if(v==="N3"&&(y.name==="C"||y.name==="U"||y.name==="T")||v==="N1"&&(y.name==="A"||y.name==="G"))y.cp3=x;else if(v==="C2")y.cp4=x;else if(v==="C4"&&(y.name==="C"||y.name==="U"||y.name==="T")||v==="C6"&&(y.name==="A"||y.name==="G"))y.cp5=x;else if(v==="O"||v==="C6"&&(y.name==="C"||y.name==="U"||y.name==="T")||v==="N9"){if(!r[r.length-1].cp2){if(v==="C6"||v==="N9")var p=x;y.cp2=x}}else v==="C"&&(p=x)}}else if(v.startsWith("HETATM"))x=
v.substring(76,78).trim(),x.length===0&&(x=v.substring(12,16).trim()),x.length>1&&(x=x.substring(0,1)+x.substring(1).toLowerCase()),x=new w.Atom(x,parseFloat(v.substring(30,38))*b,parseFloat(v.substring(38,46))*b,parseFloat(v.substring(46,54))*b),x.hetatm=!0,v.substring(17,20).trim()==="HOH"&&(x.isWater=!0),f.atoms.push(x),t[parseInt(v.substring(6,11).trim())]=x;else if(v.startsWith("CONECT")){if(x=parseInt(v.substring(6,11).trim()),t[x])for(x=t[x],y=0;y<4;y++)if(a=v.substring(11+y*5,16+y*5).trim(),
a.length!==0&&(a=parseInt(a),t[a])){a=t[a];h=!1;for(let C=0,D=f.bonds.length;C<D;C++){let E=f.bonds[C];if(E.a1===x&&E.a2===a||E.a1===a&&E.a2===x){h=!0;break}}h||f.bonds.push(new w.Bond(x,a))}}else if(v.startsWith("TER"))this.endChain(f,r,p,c),r=[];else if(v.startsWith("ENDMDL"))break}this.endChain(f,r,p,c);f.bonds.length===0&&(new q.informatics.BondDeducer).deduceCovalentBonds(f,b);if(this.deduceResidueBonds)for(let z=0,A=c.length;z<A;z++)for(b=l.min(A,z+20),p=z+1;p<b;p++)g=c[z],k=c[p],g.distance3D(k)<
(u[g.label].covalentRadius+u[k.label].covalentRadius)*1.1&&f.bonds.push(new w.Bond(g,k,1));f.atoms=f.atoms.concat(c);this.calculateRibbonDistances&&this.calculateDistances(f,c);return f};n.endChain=function(c,b,f,g){if(b.length>0){var k=b[b.length-1];k.cp1||(k.cp1=g[g.length-2]);k.cp2||(k.cp2=g[g.length-1]);for(g=0;g<4;g++)k=new w.Residue(-1),k.cp1=f,k.cp2=b[b.length-1].cp2,b.push(k);c.chains.push(b)}};n.calculateDistances=function(c,b){let f=[];for(let g=0,k=c.atoms.length;g<k;g++){let m=c.atoms[g];
m.hetatm&&(m.isWater||f.push(m))}for(let g=0,k=b.length;g<k;g++)if(c=b[g],c.closestDistance=Number.POSITIVE_INFINITY,f.length===0)c.closestDistance=0;else for(let m=0,r=f.length;m<r;m++)c.closestDistance=Math.min(c.closestDistance,c.distance3D(f[m]))};let e=new B.PDBInterpreter;q.readPDB=function(c,b){return e.read(c,b)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,Math);
(function(q,B,w,u){let l={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},n={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},d={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};B.JCAMPInterpreter=function(){};let e=B.JCAMPInterpreter.prototype=new B._Interpreter;e.convertHZ2PPM=!1;e.read=function(b){this.isBreak=function(J){return l[J]!==u||n[J]!==u||d[J]!==u||J===" "||J==="-"||J==="+"};this.getValue=function(J,M){let H=J.charAt(0);
J=J.substring(1);return l[H]!==u?parseFloat(l[H]+J):n[H]!==u?parseFloat(n[H]+J)+M:parseFloat(J)};let f=new w.Spectrum;if(b===u||b.length===0)return f;b=b.split("\n");let g=[],k,m,r,t,v=1,x=1,y=1,a=-1;var h=-1;let p=!0,z=!1;for(let J=0,M=b.length;J<M;J++){var A=b[J].trim(),C=A.indexOf("$$");C!==-1&&(A=A.substring(0,C));if(g.length!==0&&b[J].startsWith("##"))if(C=g.join(""),p&&C.length<100&&f.metadata.push(C),g=[A],C.startsWith("##TITLE\x3d"))f.title=C.substring(8).trim();else if(C.startsWith("##XUNITS\x3d"))f.xUnit=
C.substring(9).trim(),this.convertHZ2PPM&&f.xUnit.toUpperCase()==="HZ"&&(f.xUnit="PPM",z=!0);else if(C.startsWith("##YUNITS\x3d"))f.yUnit=C.substring(9).trim();else{if(!C.startsWith("##XYPAIRS\x3d"))if(C.startsWith("##FIRSTX\x3d"))m=parseFloat(C.substring(9).trim());else if(C.startsWith("##LASTX\x3d"))k=parseFloat(C.substring(8).trim());else if(C.startsWith("##FIRSTY\x3d"))r=parseFloat(C.substring(9).trim());else if(C.startsWith("##NPOINTS\x3d"))t=parseFloat(C.substring(10).trim());else if(C.startsWith("##XFACTOR\x3d"))v=
parseFloat(C.substring(10).trim());else if(C.startsWith("##YFACTOR\x3d"))x=parseFloat(C.substring(10).trim());else if(C.startsWith("##DELTAX\x3d"))parseFloat(C.substring(9).trim());else if(C.startsWith("##.OBSERVE FREQUENCY\x3d"))this.convertHZ2PPM&&(y=parseFloat(C.substring(21).trim()));else if(C.startsWith("##.SHIFT REFERENCE\x3d"))this.convertHZ2PPM&&(h=C.substring(19).split(","),a=parseInt(h[2].trim()),h=parseFloat(h[3].trim()));else if(C.startsWith("##XYDATA\x3d")){z||(y=1);A=p=!1;C=C.split("\n");
var D=(k-m)/(t-1),E=m-D,F=r,G=0;let H;for(let R=1,K=C.length;R<K;R++){var I=[];E=C[R].trim();F=[];for(let L=0,N=E.length;L<N;L++)this.isBreak(E.charAt(L))?(F.length>0&&(F.length!==1||F[0]!==" ")&&I.push(F.join("")),F=[E.charAt(L)]):F.push(E.charAt(L));I.push(F.join(""));E=parseFloat(I[0])*v-D;for(let L=1,N=I.length;L<N;L++)if(F=I[L],d[F.charAt(0)]!==u){let Q=parseInt(d[F.charAt(0)]+F.substring(1))-1;for(let O=0;O<Q;O++)E+=D,G=this.getValue(H,G),F=G*x,f.data[f.data.length-1]=new w.Point(E/y,F)}else l[F.charAt(0)]!==
u&&A?F=this.getValue(F,G)*x:(A=n[F.charAt(0)]!==u,H=F,E+=D,G=this.getValue(F,G),F=G*x,f.data.push(new w.Point(E/y,F)))}if(a!==-1){A=h-f.data[a-1].x;for(let R=0,K=f.data.length;R<K;R++)f.data[R].x+=A}}else if(C.startsWith("##PEAK TABLE\x3d")){p=!1;f.continuous=!1;A=C.split("\n");C=/[\s,]+/;for(let H=1,R=A.length;H<R;H++){D=A[H].split(C);for(let K=0,L=D.length;K+1<L;K+=2)f.data.push(new w.Point(parseFloat(D[K].trim()),parseFloat(D[K+1].trim())))}}else if(C.startsWith("##ATOMLIST\x3d")){f.molecule=new w.Molecule;
A=C.split("\n");C=/[\s]+/;for(let H=1,R=A.length;H<R;H++)D=A[H].split(C),f.molecule.atoms.push(new w.Atom(D[1]))}else if(C.startsWith("##BONDLIST\x3d")){A=C.split("\n");C=/[\s]+/;for(let H=1,R=A.length;H<R;H++)D=A[H].split(C),G=1,D[2]==="D"?G=2:D[2]==="T"&&(G=3),f.molecule.bonds.push(new w.Bond(f.molecule.atoms[parseInt(D[0])-1],f.molecule.atoms[parseInt(D[1])-1],G))}else if(f.molecule&&C.startsWith("##XY_RASTER\x3d")){A=C.split("\n");C=/[\s]+/;for(let H=1,R=A.length;H<R;H++)D=A[H].split(C),G=f.molecule.atoms[parseInt(D[0])-
1],G.x=parseInt(D[1]),G.y=parseInt(D[2]),D.length==4&&(G.z=parseInt(D[3]));f.molecule.scaleToAverageBondLength(20)}else if(C.startsWith("##PEAK ASSIGNMENTS\x3d")){A=C.split("\n");C=/[\s,()<>]+/;f.assignments=[];for(let H=1,R=A.length;H<R;H++){I=A[H].split(C);D=parseFloat(I[1]);G=parseFloat(I[2]);I=f.molecule.atoms[parseInt(I[3])-1];E=!1;for(let K=0,L=f.assignments.length;K<L;K++)if(F=f.assignments[K],F.x===D){F.as.push(I);I.assigned=F;E=!0;break}E||(D={x:D,y:G,as:[I]},I.assigned=D,f.assignments.push(D))}}}else A=
A.trim(),g.length!==0&&A.length!==0&&g.push("\n"),g.push(A)}f.setup();return f};e.makeStructureSpectrumSet=function(b,f){this.convertHZ2PPM=!0;let g=this.read(f),k=new q.ViewerCanvas(b+"_molecule",200,200);k.styles.atoms_displayTerminalCarbonLabels_2D=!0;k.styles.atoms_displayImplicitHydrogens_2D=!0;k.mouseout=function(r){if(this.molecules.length!==0){for(let t=0,v=this.molecules[0].atoms.length;t<v;t++)this.molecules[0].atoms[t].isHover=!1;g.hovered=u;this.repaint();m.repaint()}};k.touchend=k.mouseout;
k.mousemove=function(r){if(this.molecules.length!==0){let t=u;for(let v=0,x=this.molecules[0].atoms.length;v<x;v++){let y=this.molecules[0].atoms[v];y.isHover=!1;y.assigned&&(t===u||r.p.distance(y)<r.p.distance(t))&&(t=y)}g.hovered=u;if(r.p.distance(t)<20){for(let v=0,x=t.assigned.as.length;v<x;v++)t.assigned.as[v].isHover=!0;m.spectrum.hovered=t.assigned}this.repaint();m.repaint()}};k.touchmove=k.mousemove;k.drawChildExtras=function(r,t){if(this.molecules.length!==0)for(let v=0,x=this.molecules[0].atoms.length;v<
x;v++)this.molecules[0].atoms[v].drawDecorations(r,t)};let m=new q.ObserverCanvas(b+"_spectrum",400,200);m.styles.plots_showYAxis=!1;m.styles.plots_flipXAxis=!0;m.mouseout=function(r){if(this.spectrum&&this.spectrum.assignments){for(let t=0,v=k.molecules[0].atoms.length;t<v;t++)k.molecules[0].atoms[t].isHover=!1;this.spectrum.hovered=u;k.repaint();this.repaint()}};m.touchend=m.mouseout;m.mousemove=function(r){if(this.spectrum&&this.spectrum.assignments){let t=u;for(let v=0,x=k.molecules[0].atoms.length;v<
x;v++)k.molecules[0].atoms[v].isHover=!1;this.spectrum.hovered=u;for(let v=0,x=this.spectrum.assignments.length;v<x;v++){let y=this.spectrum.assignments[v];if(t===u||Math.abs(this.spectrum.getTransformedX(y.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x)<Math.abs(this.spectrum.getTransformedX(t.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x))t=y}if(Math.abs(this.spectrum.getTransformedX(t.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-
r.p.x)<20){for(let v=0,x=t.as.length;v<x;v++)t.as[v].isHover=!0;this.spectrum.hovered=t}k.repaint();this.repaint()}};m.touchmove=m.mousemove;m.drawChildExtras=function(r){if(this.spectrum&&this.spectrum.hovered){let t=this.spectrum.getTransformedX(this.spectrum.hovered.x,m.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);t>=this.spectrum.memory.offsetLeft&&t<this.spectrum.memory.width&&(r.save(),r.strokeStyle="#885110",r.lineWidth=3,r.beginPath(),r.moveTo(t,this.spectrum.memory.height-
this.spectrum.memory.offsetBottom),r.lineTo(t,this.spectrum.getTransformedY(this.spectrum.hovered.y,m.styles,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),r.stroke(),r.restore())}};g&&(m.loadSpectrum(g),g.molecule&&k.loadMolecule(g.molecule));return[k,m]};let c=new B.JCAMPInterpreter;c.convertHZ2PPM=!0;q.readJCAMP=function(b){return c.read(b)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(q,B,w,u,l,n,d){B.JSONInterpreter=function(){};let e=B.JSONInterpreter.prototype;e.contentTo=function(b,f){b||=[];f||=[];var g=!0;for(let v=0,x=b.length;v<x;v++){var k=b[v];for(let y=0,a=k.atoms.length;y<a;y++)if(k.atoms[y].pid===d){g=!1;break}if(g)for(let y=0,a=k.bonds.length;y<a;y++)if(k.bonds[y].pid===d){g=!1;break}}let m=k=0,r=0;for(let v=0,x=b.length;v<x;v++){let y=b[v],a=d;for(let h=0,p=y.atoms.length;h<p;h++){var t=y.atoms[h];if(g){if(t.tmpid="a"+t.pid,a===d||a>t.pid)a=t.pid}else t.tmpid=
"a"+k++}for(let h=0,p=y.bonds.length;h<p;h++)t=y.bonds[h],t.tmpid=g?"b"+t.pid:"b"+m++;y.tmpid="m"+(a===d?r++:a)}k=0;for(let v=0,x=f.length;v<x;v++)f[v].tmpid="s"+k++;g={};if(b&&b.length>0){g.m=[];for(let v=0,x=b.length;v<x;v++)g.m.push(this.molTo(b[v]))}if(f&&f.length>0){g.s=[];for(let v=0,x=f.length;v<x;v++)g.s.push(this.shapeTo(f[v]))}for(let v=0,x=b.length;v<x;v++){k=b[v];for(let y=0,a=k.atoms.length;y<a;y++)k.atoms[y].tmpid=d;for(let y=0,a=k.bonds.length;y<a;y++)k.bonds[y].tmpid=d;k.tmpid=d}for(let v=
0,x=f.length;v<x;v++)f[v].tmpid=d;return g};e.contentFrom=function(b){let f={molecules:[],shapes:[]};if(b.m)for(let g=0,k=b.m.length;g<k;g++)f.molecules.push(this.molFrom(b.m[g]));if(b.s)for(let g=0,k=b.s.length;g<k;g++)f.shapes.push(this.shapeFrom(b.s[g],f.molecules));for(let g=0,k=f.molecules.length;g<k;g++){b=f.molecules[g];for(let m=0,r=b.atoms.length;m<r;m++)b.atoms[m].tmpid=d;for(let m=0,r=b.bonds.length;m<r;m++)b.bonds[m].tmpid=d}for(let g=0,k=f.shapes.length;g<k;g++)f.shapes[g].tmpid=d;return f};
e.queryTo=function(b){let f={},g=function(k,m,r,t){m&&(k[r]={v:t?b.outputRange(m.v):m.v,n:m.not})};b.type===w.Query.TYPE_ATOM?(g(f,b.elements,"as"),g(f,b.chirality,"@"),g(f,b.aromatic,"A"),g(f,b.charge,"C",!0),g(f,b.hydrogens,"H",!0),g(f,b.ringCount,"R",!0),g(f,b.saturation,"S"),g(f,b.connectivity,"X",!0),g(f,b.connectivityNoH,"x",!0)):(g(f,b.orders,"bs"),g(f,b.stereo,"@"),g(f,b.aromatic,"A"),g(f,b.ringCount,"R",!0));return f};e.molTo=function(b){let f={a:[]};b.tmpid&&(f.i=b.tmpid);for(let m=0,r=
b.atoms.length;m<r;m++){var g=b.atoms[m],k={x:g.x,y:g.y};g.tmpid&&(k.i=g.tmpid);g.label!=="C"&&(k.l=g.label);g.z!==0&&(k.z=g.z);g.charge!==0&&(k.c=g.charge);g.mass!==-1&&(k.m=g.mass);g.implicitH!==-1&&(k.h=g.implicitH);g.numRadical!==0&&(k.r=g.numRadical);g.numLonePair!==0&&(k.p=g.numLonePair);g.enhancedStereo&&g.enhancedStereo.type!==w.Atom.ESTEREO_ABSOLUTE&&(k.s2={t:g.enhancedStereo.type},g.enhancedStereo.group>1&&(k.s2.g=g.enhancedStereo.group));g.query&&(k.q=this.queryTo(g.query));f.a.push(k)}if(b.bonds.length>
0){f.b=[];for(let m=0,r=b.bonds.length;m<r;m++)g=b.bonds[m],k={b:b.atoms.indexOf(g.a1),e:b.atoms.indexOf(g.a2)},g.tmpid&&(k.i=g.tmpid),g.bondOrder!==1&&(k.o=g.bondOrder),g.stereo!==w.Bond.STEREO_NONE&&(k.s=g.stereo),g.query&&(k.q=this.queryTo(g.query)),f.b.push(k)}return f};e.queryFrom=function(b){let f=new w.Query(b.as?w.Query.TYPE_ATOM:w.Query.TYPE_BOND),g=function(k,m,r,t){m&&(k[r]={},k[r].v=t?k.parseRange(m.v):m.v,m.n&&(k[r].not=!0))};f.type===w.Query.TYPE_ATOM?(g(f,b.as,"elements"),g(f,b["@"],
"chirality"),g(f,b.A,"aromatic"),g(f,b.C,"charge",!0),g(f,b.H,"hydrogens",!0),g(f,b.R,"ringCount",!0),g(f,b.S,"saturation"),g(f,b.X,"connectivity",!0),g(f,b.x,"connectivityNoH",!0)):(g(f,b.bs,"orders"),g(f,b["@"],"stereo"),g(f,b.A,"aromatic"),g(f,b.R,"ringCount",!0));return f};e.molFrom=function(b){let f=new w.Molecule;for(let m=0,r=b.a.length;m<r;m++){var g=b.a[m],k=new w.Atom(g.l?g.l:"C",g.x,g.y);g.i&&(k.tmpid=g.i);g.z&&(k.z=g.z);g.c&&(k.charge=g.c);g.m&&(k.mass=g.m);g.h&&(k.implicitH=g.h);g.r&&
(k.numRadical=g.r);g.p&&(k.numLonePair=g.p);g.s2&&(k.enhancedStereo={type:g.s2.t,group:g.s2.g===d?1:g.s2.g});g.q&&(k.query=this.queryFrom(g.q));g.p_h!==d&&(k.hetatm=g.p_h);g.p_w!==d&&(k.isWater=g.p_w);g.p_d!==d&&(k.closestDistance=g.p_d);f.atoms.push(k)}if(b.b)for(let m=0,r=b.b.length;m<r;m++)g=b.b[m],k=new w.Bond(f.atoms[g.b],f.atoms[g.e],g.o===d?1:g.o),g.i&&(k.tmpid=g.i),g.s&&(k.stereo=g.s),g.q&&(k.query=this.queryFrom(g.q)),f.bonds.push(k);return f};e.shapeTo=function(b){let f={};b.tmpid&&(f.i=
b.tmpid);if(b instanceof u.Line){f.t="Line";f.x1=b.p1.x;f.y1=b.p1.y;f.x2=b.p2.x;f.y2=b.p2.y;f.a=b.arrowType;if(b.reactants!==d&&b.reactants.length>0){f.rs=[];for(let g=0,k=b.reactants.length;g<k;g++)f.rs[g]=b.reactants[g].tmpid}if(b.products!==d&&b.products.length>0){f.ps=[];for(let g=0,k=b.products.length;g<k;g++)f.ps[g]=b.products[g].tmpid}}else if(b instanceof u.Pusher)f.t="Pusher",f.o1=b.o1.tmpid,f.o2=b.o2.tmpid,b.numElectron!==1&&(f.e=b.numElectron);else if(b instanceof u.AtomMapping)f.t="AtomMapping",
f.a1=b.o1.tmpid,f.a2=b.o2.tmpid,f.n=b.label;else if(b instanceof u.Bracket)f.t="Bracket",f.x1=b.p1.x,f.y1=b.p1.y,f.x2=b.p2.x,f.y2=b.p2.y,b.charge!==0&&(f.c=b.charge),b.mult!==0&&(f.m=b.mult),b.repeat!==0&&(f.r=b.repeat);else if(b instanceof u.RepeatUnit)f.t="RepeatUnit",f.b1=b.b1.tmpid,f.b2=b.b2.tmpid,f.n1=b.n1,f.n2=b.n2,b.flip===!0&&(f.f=!0);else if(b instanceof u.VAP){f.t="VAP";f.x=b.asterisk.x;f.y=b.asterisk.y;b.bondType!==1&&(f.o=b.bondType);b.substituent&&(f.s=b.substituent.tmpid);f.a=[];for(let g=
0,k=b.attachments.length;g<k;g++)f.a.push(b.attachments[g].tmpid)}else if(b instanceof l.Distance)f.t="Distance",f.a1=b.a1.tmpid,f.a2=b.a2.tmpid,b.node&&(f.n=b.node,f.o=b.offset);else if(b instanceof l.Angle)f.t="Angle",f.a1=b.a1.tmpid,f.a2=b.a2.tmpid,f.a3=b.a3.tmpid;else if(b instanceof l.Torsion)f.t="Torsion",f.a1=b.a1.tmpid,f.a2=b.a2.tmpid,f.a3=b.a3.tmpid,f.a4=b.a4.tmpid;else if(b instanceof l._Surface){f.t="Surface";f.a=[];for(let k=0,m=b.atoms.length;k<m;k++)f.a.push(b.atoms[k].tmpid);b instanceof
l.VDWSurface||(f.p=b.probeRadius);f.r=b.resolution;let g="vdw";b instanceof l.SASSurface?g="sas":l.SESSurface&&b instanceof l.SESSurface&&(g="ses");f.f=g}else b instanceof l.UnitCell&&(f.t="UnitCell",f.ls=b.lengths,f.as=b.angles,f.os=b.offset);return f};e.shapeFrom=function(b,f){if(b.t==="Line"){var g=new u.Line(new w.Point(b.x1,b.y1),new w.Point(b.x2,b.y2));g.arrowType=b.a;if(b.rs!==d){g.reactants=[];for(let t=0,v=b.rs.length;t<v;t++){var k=b.rs[t];a:for(let x=0,y=f.length;x<y;x++){var m=f[x];for(let a=
0,h=m.atoms.length;a<h;a++){var r=m.atoms[a];if(r.tmpid===k){g.reactants.push(r);break a}}}}}if(b.ps!==d){g.products=[];for(let t=0,v=b.ps.length;t<v;t++){k=b.ps[t];a:for(let x=0,y=f.length;x<y;x++){m=f[x];for(let a=0,h=m.atoms.length;a<h;a++)if(r=m.atoms[a],r.tmpid===k){g.products.push(r);break a}}}}}else if(b.t==="Pusher"){for(let t=0,v=f.length;t<v;t++){g=f[t];for(let x=0,y=g.atoms.length;x<y;x++)r=g.atoms[x],r.tmpid===b.o1?k=r:r.tmpid===b.o2&&(m=r);for(let x=0,y=g.bonds.length;x<y;x++)r=g.bonds[x],
r.tmpid===b.o1?k=r:r.tmpid===b.o2&&(m=r)}g=new u.Pusher(k,m);b.e&&(g.numElectron=b.e)}else if(b.t==="AtomMapping"){let t;for(let v=0,x=f.length;v<x;v++){g=f[v];for(let y=0,a=g.atoms.length;y<a;y++)k=g.atoms[y],k.tmpid===b.a1?r=k:k.tmpid===b.a2&&(t=k)}g=new u.AtomMapping(r,t);b.n!==d&&(g.label=b.n)}else if(b.t==="Bracket")g=new u.Bracket(new w.Point(b.x1,b.y1),new w.Point(b.x2,b.y2)),b.c!==d&&(g.charge=b.c),b.m!==d&&(g.mult=b.m),b.r!==d&&(g.repeat=b.r);else if(b.t==="RepeatUnit"||b.t==="DynamicBracket"){let t,
v;for(let x=0,y=f.length;x<y;x++){g=f[x];for(let a=0,h=g.bonds.length;a<h;a++)k=g.bonds[a],k.tmpid===b.b1?t=k:k.tmpid===b.b2&&(v=k)}g=new u.RepeatUnit(t,v);g.n1=b.n1;g.n2=b.n2;b.f&&(g.flip=!0)}else if(b.t==="VAP"){g=new u.VAP(b.x,b.y);b.o&&(g.bondType=b.o);for(let t=0,v=f.length;t<v;t++){k=f[t];for(let x=0,y=k.atoms.length;x<y;x++)if(m=k.atoms[x],m.tmpid===b.s)g.substituent=m;else for(let a=0,h=b.a.length;a<h;a++)m.tmpid===b.a[a]&&g.attachments.push(m)}}else if(b.t==="Distance"){let t,v;for(let x=
0,y=f.length;x<y;x++){g=f[x];for(let a=0,h=g.atoms.length;a<h;a++)k=g.atoms[a],k.tmpid===b.a1?t=k:k.tmpid===b.a2&&(v=k)}g=new l.Distance(t,v,b.n,b.o)}else if(b.t==="Angle"){let t,v,x;for(let y=0,a=f.length;y<a;y++){g=f[y];for(let h=0,p=g.atoms.length;h<p;h++)k=g.atoms[h],k.tmpid===b.a1?t=k:k.tmpid===b.a2?v=k:k.tmpid===b.a3&&(x=k)}g=new l.Angle(t,v,x)}else if(b.t==="Torsion"){let t,v,x,y;for(let a=0,h=f.length;a<h;a++){g=f[a];for(let p=0,z=g.atoms.length;p<z;p++)k=g.atoms[p],k.tmpid===b.a1?t=k:k.tmpid===
b.a2?v=k:k.tmpid===b.a3?x=k:k.tmpid===b.a4&&(y=k)}g=new l.Torsion(t,v,x,y)}else if(b.t==="Surface"){k=[];for(let t=0,v=f.length;t<v;t++){m=f[t];for(let x=0,y=m.atoms.length;x<y;x++){r=m.atoms[x];for(let a=0,h=b.a.length;a<h;a++)r.tmpid===b.a[a]&&k.push(r)}}f=b.p?b.p:1.4;m=b.r?b.r:30;b.f==="vdw"?g=new l.VDWSurface(k,m):b.f==="sas"?g=new l.SASSurface(k,f,m):b.f==="ses"&&(g=new l.SESSurface(k,f,m))}else b.t==="UnitCell"&&(g=new l.UnitCell(b.ls,b.as,b.os));return g};e.pdbFrom=function(b){let f=this.molFrom(b.mol);
f.findRings=!1;f.fromJSON=!0;f.chains=this.chainsFrom(b.ribbons);return f};e.chainsFrom=function(b){let f=[];for(let g=0,k=b.cs.length;g<k;g++){let m=b.cs[g],r=[];for(let t=0,v=m.length;t<v;t++){let x=m[t],y=new w.Residue;y.name=x.n;y.cp1=new w.Atom("",x.x1,x.y1,x.z1);y.cp2=new w.Atom("",x.x2,x.y2,x.z2);x.x3&&(y.cp3=new w.Atom("",x.x3,x.y3,x.z3),y.cp4=new w.Atom("",x.x4,x.y4,x.z4),y.cp5=new w.Atom("",x.x5,x.y5,x.z5));y.helix=x.h;y.sheet=x.s;y.arrow=t>0&&m[t-1].a;r.push(y)}f.push(r)}return f};let c=
new B.JSONInterpreter;q.readJSON=function(b){let f;try{f=n.parse(b)}catch(g){return d}return f?f.m||f.s?c.contentFrom(f):f.a?{molecules:[c.molFrom(f)],shapes:[]}:{molecules:[],shapes:[]}:d};q.writeJSON=function(b,f){return n.stringify(c.contentTo(b,f))}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON);
(function(q,B,w,u){B.RXNInterpreter=function(){};let l=B.RXNInterpreter.prototype=new B._Interpreter;l.read=function(d,e){e||(e=q.DEFAULT_STYLES.bondLength_2D);let c=[];if(d){var b=d.split("$MOL\n");d=b[0].split("\n")[4];var f=parseInt(d.substring(0,3)),g=parseInt(d.substring(3,6)),k=1;d=0;for(let m=0,r=f+g;m<r;m++){c[m]=q.readMOL(b[k],e);let t=c[m].getBounds();d-=t.maxX-t.minX+40;k++}for(let m=0,r=f;m<r;m++){e=c[m].getBounds();e=e.maxX-e.minX;b=c[m].getCenter();for(let t=0,v=c[m].atoms.length;t<
v;t++)k=c[m].atoms[t],k.x+=d+e/2-b.x,k.y-=b.y;d+=e+40}e=new w.d2.Line(new w.Point(d,0),new w.Point(d+40,0));d+=80;for(let m=f,r=f+g;m<r;m++){f=c[m].getBounds();f=f.maxX-f.minX;g=c[m].getCenter();for(b=0;b<c[m].atoms.length;b++)k=c[m].atoms[b],k.x+=d+f/2-g.x,k.y-=g.y;d+=f+40}}else c.push(new w.Molecule),e=new w.d2.Line(new w.Point(-20,0),new w.Point(20,0));e.arrowType=w.d2.Line.ARROW_SYNTHETIC;return{molecules:c,shapes:[e]}};l.write=function(d,e){let c=u;if(d&&e){for(let b=0,f=e.length;b<f;b++)if(e[b]instanceof
w.d2.Line){c=e[b];break}if(!c)return"";d=(new w.Reaction).resolve(c,d);e=[];e.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");e.push(this.fit(d.reactants.length.toString(),3));e.push(this.fit(d.products.length.toString(),3));e.push("\n");for(let b=0,f=d.reactants.length;b<f;b++)e.push("$MOL\n"),e.push(q.writeMOL(d.reactants[b])),e.push("\n");for(let b=0,f=d.products.length;b<f;b++)e.push("$MOL\n"),e.push(q.writeMOL(d.products[b])),e.push("\n");return e.join("")}};
let n=new B.RXNInterpreter;q.readRXN=function(d,e){return n.read(d,e)};q.writeRXN=function(d,e){return n.write(d,e)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(q,B,w,u,l,n){u.XYZInterpreter=function(){};B=u.XYZInterpreter.prototype=new u._Interpreter;B.deduceCovalentBonds=!0;B.read=function(e){let c=new l.Molecule;if(!e)return c;e=e.split("\n");let b=parseInt(e[0].trim());for(let f=0;f<b;f++){let g=e[f+2].split(/\s+/g);c.atoms[f]=new l.Atom(isNaN(g[0])?g[0]:w[parseInt(g[0])-1],parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]))}this.deduceCovalentBonds&&(new q.informatics.BondDeducer).deduceCovalentBonds(c,1);return c};let d=new u.XYZInterpreter;
q.readXYZ=function(e){return d.read(e)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures);
ChemDoodle.monitor=function(q,B,w){let u={};u.CANVAS_DRAGGING=w;u.CANVAS_OVER=w;u.ALT=!1;u.SHIFT=!1;u.META=!1;q.supports_touch()||B.addEventListener("DOMContentLoaded",function(){B.addEventListener("mousemove",function(l){u.CANVAS_DRAGGING&&u.CANVAS_DRAGGING.drag&&(u.CANVAS_DRAGGING.prehandleEvent(l),u.CANVAS_DRAGGING.drag(l))});B.addEventListener("mouseup",function(l){u.CANVAS_DRAGGING&&u.CANVAS_DRAGGING!==u.CANVAS_OVER&&u.CANVAS_DRAGGING.mouseup&&(u.CANVAS_DRAGGING.prehandleEvent(l),u.CANVAS_DRAGGING.mouseup(l));
u.CANVAS_DRAGGING=w});B.addEventListener("keydown",function(l){u.SHIFT=l.shiftKey;u.ALT=l.altKey;u.META=l.metaKey||l.ctrlKey;let n=u.CANVAS_OVER;u.CANVAS_DRAGGING&&(n=u.CANVAS_DRAGGING);n&&n.keydown&&(n.prehandleEvent(l),n.keydown(l))});B.addEventListener("keypress",function(l){let n=u.CANVAS_OVER;u.CANVAS_DRAGGING&&(n=u.CANVAS_DRAGGING);n&&n.keypress&&(n.prehandleEvent(l),n.keypress(l))});B.addEventListener("keyup",function(l){u.SHIFT=l.shiftKey;u.ALT=l.altKey;u.META=l.metaKey||l.ctrlKey;let n=u.CANVAS_OVER;
u.CANVAS_DRAGGING&&(n=u.CANVAS_DRAGGING);n&&n.keyup&&(n.prehandleEvent(l),n.keyup(l))})});return u}(ChemDoodle.featureDetection,document);
(function(q,B,w,u,l,n,d,e,c,b){q._Canvas=function(f,g,k){this.id=f;this.width=g;this.height=k;f&&this.create()};c=q._Canvas.prototype;c.molecules=b;c.shapes=b;c.emptyMessage=b;c.image=b;c.repaint=function(){if(!this.test){var f=d.getElementById(this.id);if(f.getContext){let g=f.getContext("2d");this.pixelRatio!==1&&f.width===this.width&&(f.width=this.width*this.pixelRatio,f.height=this.height*this.pixelRatio,g.scale(this.pixelRatio,this.pixelRatio));if(this.image)g.drawImage(this.image,0,0);else{let k=
this.styles.backgroundColor?this.styles.backgroundColor:"transparent";g.clearRect(0,0,this.width,this.height);this.bgCache!==k&&(f.style.backgroundColor=k,this.bgCache=f.style.backgroundColor);k!=="transparent"&&(g.fillStyle=k,g.fillRect(0,0,this.width,this.height))}if(this.innerRepaint)this.innerRepaint(g);else if(this.molecules.length!==0||this.shapes.length!==0){for(let k of this.shapes)if(k instanceof l.d2.Pusher){l.d2.Pusher.setupPushers(this.shapes,this.molecules);break}g.save();g.translate(this.width/
2,this.height/2);g.rotate(this.styles.rotateAngle);g.scale(this.styles.scale,this.styles.scale);g.translate(-this.width/2,-this.height/2);for(let k=0,m=this.molecules.length;k<m;k++)this.molecules[k].check(!0),this.molecules[k].draw(g,this.styles);this.checksOnAction&&this.checksOnAction(!0);for(let k=0,m=this.shapes.length;k<m;k++)this.shapes[k].draw(g,this.styles);g.restore()}else this.emptyMessage&&(g.fillStyle="#737683",g.textAlign="center",g.textBaseline="middle",g.font="18px Helvetica, Verdana, Arial, Sans-serif",
g.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(g,this.styles)}}};c.resize=function(f,g){let k=d.getElementById(this.id);k&&(k.setAttribute("width",f),k.setAttribute("height",g),k.style.width=f+"px",k.style.height=g+"px");this.width=f;this.height=g;if(q._Canvas3D&&this instanceof q._Canvas3D)this.pixelRatio!==1&&(f*=this.pixelRatio,g*=this.pixelRatio,this.gl.canvas.width=f,this.gl.canvas.height=g),this.gl.viewport(0,0,f,g),this.afterLoadContent();
else if(this.molecules.length>0){this.center();for(let m=0,r=this.molecules.length;m<r;m++)this.molecules[m].check()}this.repaint()};c.setBackgroundImage=function(f){this.image=new Image;let g=this;this.image.onload=function(){g.repaint()};this.image.src=f};c.loadMolecule=function(f){this.clear();this.molecules.push(f);for(let g=0;g<2;g++)this.center(),q._Canvas3D&&this instanceof q._Canvas3D||f.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()};c.loadContent=function(f,g){this.molecules=
f?f:[];this.shapes=g?g:[];for(f=0;f<2;f++){this.center();if(!(q._Canvas3D&&this instanceof q._Canvas3D))for(let k=0,m=this.molecules.length;k<m;k++)this.molecules[k].check();this.afterLoadContent&&this.afterLoadContent();this.repaint()}};c.addMolecule=function(f){this.molecules.push(f);q._Canvas3D&&this instanceof q._Canvas3D||f.check();this.repaint()};c.removeMolecule=function(f){this.molecules=this.molecules.filter(function(g){return g!==f});this.repaint()};c.getMolecule=function(){return this.molecules.length>
0?this.molecules[0]:b};c.getMolecules=function(){return this.molecules};c.addShape=function(f){this.shapes.push(f);this.repaint()};c.removeShape=function(f){this.shapes=this.shapes.filter(function(g){return g!==f});this.repaint()};c.getShapes=function(){return this.shapes};c.clear=function(){this.molecules=[];this.shapes=[];this.styles.scale=1;this.repaint()};c.center=function(){var f=this.getContentBounds(),g=new l.Point((this.width-f.minX-f.maxX)/2,(this.height-f.minY-f.maxY)/2);for(let m=0,r=this.molecules.length;m<
r;m++){var k=this.molecules[m];for(let t=0,v=k.atoms.length;t<v;t++)k.atoms[t].add(g)}for(let m=0,r=this.shapes.length;m<r;m++){k=this.shapes[m].getPoints();for(let t=0,v=k.length;t<v;t++)k[t].add(g)}this.styles.scale=1;g=f.maxX-f.minX;f=f.maxY-f.minY;if(g>this.width-20||f>this.height-20)this.styles.scale=n.min(this.width/g,this.height/f)*.85};c.bondExists=function(f,g){for(let k=0,m=this.molecules.length;k<m;k++){let r=this.molecules[k];for(let t=0,v=r.bonds.length;t<v;t++){let x=r.bonds[t];if(x.contains(f)&&
x.contains(g))return!0}}return!1};c.getBond=function(f,g){for(let k=0,m=this.molecules.length;k<m;k++){let r=this.molecules[k];for(let t=0,v=r.bonds.length;t<v;t++){let x=r.bonds[t];if(x.contains(f)&&x.contains(g))return x}}return b};c.getMoleculeByAtom=function(f){for(let g=0,k=this.molecules.length;g<k;g++){let m=this.molecules[g];if(m.atoms.indexOf(f)!==-1)return m}return e.undefined};c.getAllAtoms=function(){let f=[];for(let g=0,k=this.molecules.length;g<k;g++)f=f.concat(this.molecules[g].atoms);
return f};c.getAllBonds=function(){let f=[];for(let g=0,k=this.molecules.length;g<k;g++)f=f.concat(this.molecules[g].bonds);return f};c.getAllPoints=function(){let f=[];for(let g=0,k=this.molecules.length;g<k;g++)f=f.concat(this.molecules[g].atoms);for(let g=0,k=this.shapes.length;g<k;g++)f=f.concat(this.shapes[g].getPoints());return f};c.getContentBounds=function(){let f=new w.Bounds;for(let g=0,k=this.molecules.length;g<k;g++)f.expand(this.molecules[g].getBounds());for(let g=0,k=this.shapes.length;g<
k;g++)f.expand(this.shapes[g].getBounds());return f};c.create=function(){this.molecules=[];this.shapes=[];if(d.getElementById(this.id)){var f=d.getElementById(this.id);this.width?f.setAttribute("width",this.width):this.width=parseInt(f.getAttribute("width"));this.height?f.setAttribute("height",this.height):this.height=parseInt(f.getAttribute("height"));f.setAttribute("class","ChemDoodleWebComponent")}else d.writeln(`<canvas class="ChemDoodleWebComponent" id="${this.id}" width="${this.width}" height="${this.height}" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>`);
f=d.getElementById(this.id);f.style.width=this.width+"px";f.style.height=this.height+"px";this.pixelRatio=e.devicePixelRatio?e.devicePixelRatio:1;this.styles=new l.Styles;let g=this;B.supports_touch()?(f.addEventListener("touchstart",function(k){let m=(new Date).getTime();if(!B.supports_gesture()&&k.touches.length===2){var r=k.touches;let t=new l.Point(r[0].pageX,r[0].pageY);r=new l.Point(r[1].pageX,r[1].pageY);g.implementedGestureDist=t.distance(r);g.implementedGestureAngle=t.angle(r);g.gesturestart&&
(g.prehandleEvent(k),g.gesturestart(k))}g.lastTouch&&k.touches.length===1&&m-g.lastTouch<500?g.dbltap?(g.prehandleEvent(k),g.dbltap(k)):g.dblclick?(g.prehandleEvent(k),g.dblclick(k)):g.touchstart?(g.prehandleEvent(k),g.touchstart(k)):g.mousedown&&(g.prehandleEvent(k),g.mousedown(k)):g.touchstart?(g.prehandleEvent(k),g.touchstart(k),g.hold&&clearTimeout(g.hold),g.touchhold&&(g.hold=setTimeout(function(){g.touchhold(k)},1E3))):g.mousedown&&(g.prehandleEvent(k),g.mousedown(k));g.lastTouch=m}),f.addEventListener("touchmove",
function(k){g.hold&&(clearTimeout(g.hold),g.hold=b);if(!B.supports_gesture()&&k.touches.length===2&&g.gesturechange){var m=k.touches,r=new l.Point(m[0].pageX,m[0].pageY),t=new l.Point(m[1].pageX,m[1].pageY);m=r.distance(t);r=r.angle(t);k.scale=m/g.implementedGestureDist;k.rotation=180*(g.implementedGestureAngle-r)/n.PI;g.prehandleEvent(k);g.gesturechange(k)}if(k.touches.length>1&&g.multitouchmove){r=k.touches.length;g.prehandleEvent(k);m=new l.Point(-k.offset.left*r,-k.offset.top*r);for(t=0;t<r;t++)m.x+=
k.touches[t].pageX,m.y+=k.touches[t].pageY;m.x/=r;m.y/=r;k.p=m;g.multitouchmove(k,r)}else g.touchmove?(g.prehandleEvent(k),g.touchmove(k)):g.drag&&(g.prehandleEvent(k),g.drag(k))}),f.addEventListener("touchend",function(k){g.hold&&(clearTimeout(g.hold),g.hold=b);!B.supports_gesture()&&g.implementedGestureDist&&(g.implementedGestureDist=b,g.implementedGestureAngle=b,g.gestureend&&(g.prehandleEvent(k),g.gestureend(k)));g.touchend?(g.prehandleEvent(k),g.touchend(k)):g.mouseup&&(g.prehandleEvent(k),g.mouseup(k));
(new Date).getTime()-g.lastTouch<250&&(g.tap?(g.prehandleEvent(k),g.tap(k)):g.click&&(g.prehandleEvent(k),g.click(k)))}),f.addEventListener("gesturestart",function(k){g.gesturestart&&(g.prehandleEvent(k),g.gesturestart(k))}),f.addEventListener("gesturechange",function(k){g.gesturechange&&(g.prehandleEvent(k),g.gesturechange(k))}),f.addEventListener("gestureend",function(k){g.gestureend&&(g.prehandleEvent(k),g.gestureend(k))})):(f.addEventListener("click",function(k){switch(k.button){case 0:g.click&&
(g.prehandleEvent(k),g.click(k));break;case 1:g.middleclick&&(g.prehandleEvent(k),g.middleclick(k));break;case 2:g.rightclick&&(g.prehandleEvent(k),g.rightclick(k))}}),f.addEventListener("dblclick",function(k){g.dblclick&&(g.prehandleEvent(k),g.dblclick(k))}),f.addEventListener("mousedown",function(k){switch(k.button){case 0:u.CANVAS_DRAGGING=g;g.mousedown&&(g.prehandleEvent(k),g.mousedown(k));break;case 1:g.middlemousedown&&(g.prehandleEvent(k),g.middlemousedown(k));break;case 2:g.rightmousedown&&
(g.prehandleEvent(k),g.rightmousedown(k))}}),f.addEventListener("mousemove",function(k){!u.CANVAS_DRAGGING&&g.mousemove&&(g.prehandleEvent(k),g.mousemove(k))}),f.addEventListener("mouseout",function(k){u.CANVAS_OVER=b;g.mouseout&&(g.prehandleEvent(k),g.mouseout(k))}),f.addEventListener("mouseover",function(k){u.CANVAS_OVER=g;g.mouseover&&(g.prehandleEvent(k),g.mouseover(k))}),f.addEventListener("mouseup",function(k){switch(k.button){case 0:g.mouseup&&(g.prehandleEvent(k),g.mouseup(k));break;case 1:g.middlemouseup&&
(g.prehandleEvent(k),g.middlemouseup(k));break;case 2:g.rightmouseup&&(g.prehandleEvent(k),g.rightmouseup(k))}}),f.addEventListener("contextmenu",function(k){g.contextmenu&&(g.prehandleEvent(k),g.contextmenu(k))}),f.addEventListener("wheel",function(k){g.mousewheel&&(g.prehandleEvent(k),g.mousewheel(k,-k.deltaY))}));this.subCreate&&this.subCreate()};c.prehandleEvent=function(f){f.pageX===b&&f.changedTouches&&(f.pageX=f.changedTouches[0].pageX,f.pageY=f.changedTouches[0].pageY);let g=d.getElementById(this.id).getBoundingClientRect();
f.offset={left:g.x+e.scrollX,top:g.y+e.scrollY};f.p=new l.Point(f.pageX-f.offset.left,f.pageY-f.offset.top);this.doEventDefault||(f.preventDefault(),f.returnValue=!1)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,Math,document,window,navigator.userAgent);
(function(q,B,w){q._AnimatorCanvas=function(l,n,d){q._Canvas.call(this,l,n,d)};let u=q._AnimatorCanvas.prototype=new q._Canvas;u.timeout=33;u.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();let l=this;this.nextFrame&&(this.handle=B.requestInterval(function(){let n=(new Date).getTime();l.nextFrame(n-l.lastTime);l.repaint();l.lastTime=n},this.timeout))};u.stopAnimation=function(){this.handle&&(B.clearRequestInterval(this.handle),this.handle=w)};u.isRunning=function(){return this.handle!==
w}})(ChemDoodle,ChemDoodle.animations);
(function(q,B,w){q.FileCanvas=function(u,l,n,d){q._Canvas.call(this,u,l,n);B.writeln('\x3cbr\x3e\x3cform name\x3d"FileForm" enctype\x3d"multipart/form-data" method\x3d"POST" action\x3d"'+d+'" target\x3d"HiddenFileFrame"\x3e\x3cinput type\x3d"file" name\x3d"f" /\x3e\x3cinput type\x3d"submit" name\x3d"submitbutton" value\x3d"Show File" /\x3e\x3c/form\x3e\x3ciframe id\x3d"HFF-'+u+'" name\x3d"HiddenFileFrame" height\x3d"0" width\x3d"0" style\x3d"display:none;" onLoad\x3d"GetMolFromFrame(\'HFF-'+u+"', "+
u+')"\x3e\x3c/iframe\x3e');this.emptyMessage="Click below to load file";this.repaint()};q.FileCanvas.prototype=new q._Canvas})(ChemDoodle,document);
(function(q,B){q.HyperlinkCanvas=function(u,l,n,d,e,c){q._Canvas.call(this,u,l,n);this.urlOrFunction=d;this.color=e?e:"blue";this.size=c?c:2};let w=q.HyperlinkCanvas.prototype=new q._Canvas;w.openInNewWindow=!0;w.hoverImage=B;w.drawChildExtras=function(u){this.e&&(this.hoverImage?u.drawImage(this.hoverImage,0,0):(u.strokeStyle=this.color,u.lineWidth=this.size*2,u.strokeRect(0,0,this.width,this.height)))};w.setHoverImage=function(u){this.hoverImage=new Image;this.hoverImage.src=u};w.click=function(u){this.e=
B;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};w.mouseout=function(u){this.e=B;this.repaint()};w.mouseover=function(u){this.e=u;this.repaint()}})(ChemDoodle);
(function(q,B,w,u){q.MolGrabberCanvas=function(l,n,d){q._Canvas.call(this,l,n,d);w.getElementById(l).insertAdjacentHTML("afterend",`<br><input type="text" id="${l}_query" size="32" value="" />`+this.getInputFields());let e=this;w.getElementById(l+"_submit").addEventListener("click",function(){e.search()});w.getElementById(l+"_query").addEventListener("keypress",function(c){c.key!=="Enter"&&c.keyCode!==13||e.search()});this.emptyMessage="Enter search term below";this.repaint()};u=q.MolGrabberCanvas.prototype=
new q._Canvas;u.setSearchTerm=function(l){w.getElementById(this.id+"_query").value=l;this.search()};u.getInputFields=function(){return`
			<br>
			<nobr>
				<select id="${this.id}_select" style="user-select:none;">
					<option value="chemexper">ChemExper
					<option value="chemspider">ChemSpider
					<option value="pubchem" selected>PubChem
				</select>
				<button type="button" id="${this.id}_submit" class="reset-all-button">Show Molecule</button>
			</nobr>
		`};u.search=function(){this.emptyMessage="Searching...";this.clear();let l=this;B.getMoleculeFromDatabase(w.getElementById(this.id+"_query").value,{database:w.getElementById(this.id+"_select").value},function(n){l.loadMolecule(n)})}})(ChemDoodle,ChemDoodle.iChemLabs,document);
(function(q,B,w,u){let l=[],n=[1,0,0],d=[0,1,0],e=[0,0,1];q.RotatorCanvas=function(c,b,f,g){q._AnimatorCanvas.call(this,c,b,f);this.rotate3D=g};u=q.RotatorCanvas.prototype=new q._AnimatorCanvas;B=B.PI/15;u.xIncrement=B;u.yIncrement=B;u.zIncrement=B;u.nextFrame=function(c){if(this.molecules.length===0&&this.shapes.length===0)this.stopAnimation();else if(c/=1E3,this.rotate3D){w.identity(l);w.rotate(l,this.xIncrement*c,n);w.rotate(l,this.yIncrement*c,d);w.rotate(l,this.zIncrement*c,e);for(let g=0,k=
this.molecules.length;g<k;g++){c=this.molecules[g];for(let m=0,r=c.atoms.length;m<r;m++){var b=c.atoms[m],f=[b.x-this.width/2,b.y-this.height/2,b.z];w.multiplyVec3(l,f);b.x=f[0]+this.width/2;b.y=f[1]+this.height/2;b.z=f[2]}for(let m=0,r=c.rings.length;m<r;m++)c.rings[m].center=c.rings[m].getCenter();this.styles.atoms_display&&this.styles.atoms_circles_2D&&c.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&c.sortBondsByZ()}for(let g=0,k=this.shapes.length;g<k;g++){c=this.shapes[g].getPoints();
for(let m=0,r=c.length;m<r;m++)b=c[m],f=[b.x-this.width/2,b.y-this.height/2,0],w.multiplyVec3(l,f),b.x=f[0]+this.width/2,b.y=f[1]+this.height/2}}else this.styles.rotateAngle+=this.zIncrement*c};u.dblclick=function(c){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,ChemDoodle.lib.mat4);
(function(q,B,w,u){q.SlideshowCanvas=function(l,n,d){q._AnimatorCanvas.call(this,l,n,d)};B=q.SlideshowCanvas.prototype=new q._AnimatorCanvas;B.frames=[];B.curIndex=0;B.timeout=5E3;B.alpha=0;B.innerHandle=u;B.phase=0;B.drawChildExtras=function(l){let n=w.getRGB(this.styles.backgroundColor,255);l.fillStyle="rgba("+n[0]+", "+n[1]+", "+n[2]+", "+this.alpha+")";l.fillRect(0,0,this.width,this.height)};B.nextFrame=function(l){if(this.frames.length===0)this.stopAnimation();else{this.phase=0;var n=this,d=
1;this.innerHandle=setInterval(function(){n.alpha=d/15;n.repaint();d===15&&n.breakInnerHandle();d++},33)}};B.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=u);if(this.phase===0){this.curIndex++;this.curIndex>this.frames.length-1&&(this.curIndex=0);this.alpha=1;let l=this.frames[this.curIndex];this.loadContent(l.mols,l.shapes);this.phase=1;let n=this,d=1;this.innerHandle=setInterval(function(){n.alpha=(15-d)/15;n.repaint();d===15&&n.breakInnerHandle();
d++},33)}else this.phase===1&&(this.alpha=0,this.repaint())};B.addFrame=function(l,n){this.frames.length===0&&this.loadContent(l,n);this.frames.push({mols:l,shapes:n})}})(ChemDoodle,ChemDoodle.animations,ChemDoodle.math);
(function(q,B,w,u,l,n){q.TransformCanvas=function(e,c,b,f){q._Canvas.call(this,e,c,b);this.rotate3D=f};let d=q.TransformCanvas.prototype=new q._Canvas;d.lastPoint=n;d.rotationMultMod=1.3;d.lastPinchScale=1;d.lastGestureRotate=0;d.mousedown=function(e){this.lastPoint=e.p};d.dblclick=function(e){this.center();this.repaint()};d.drag=function(e){if(!this.lastPoint.multi){if(B.ALT){var c=new w.Point(e.p.x,e.p.y);c.sub(this.lastPoint);for(let g=0,k=this.molecules.length;g<k;g++){var b=this.molecules[g];
for(let m=0,r=b.atoms.length;m<r;m++)b.atoms[m].add(c);b.check()}for(let g=0,k=this.shapes.length;g<k;g++){b=this.shapes[g].getPoints();for(let m=0,r=b.length;m<r;m++)b[m].add(c)}this.lastPoint=e.p}else if(this.rotate3D===!0){c=u.max(this.width/4,this.height/4);b=(e.p.x-this.lastPoint.x)/c*this.rotationMultMod;var f=-(e.p.y-this.lastPoint.y)/c*this.rotationMultMod;c=[];l.identity(c);l.rotate(c,f,[1,0,0]);l.rotate(c,b,[0,1,0]);for(let g=0,k=this.molecules.length;g<k;g++){b=this.molecules[g];for(let m=
0,r=b.atoms.length;m<r;m++){f=b.atoms[m];let t=[f.x-this.width/2,f.y-this.height/2,f.z];l.multiplyVec3(c,t);f.x=t[0]+this.width/2;f.y=t[1]+this.height/2;f.z=t[2]}for(let m=0,r=b.rings.length;m<r;m++)b.rings[m].center=b.rings[m].getCenter();this.lastPoint=e.p;this.styles.atoms_display&&this.styles.atoms_circles_2D&&b.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&b.sortBondsByZ()}}else b=new w.Point(this.width/2,this.height/2),c=b.angle(this.lastPoint),b=b.angle(e.p),
this.styles.rotateAngle-=b-c,this.lastPoint=e.p;this.repaint()}};d.mousewheel=function(e,c){this.styles.scale+=c/50;this.styles.scale<.01&&(this.styles.scale=.01);this.repaint()};d.multitouchmove=function(e,c){if(c===2)if(this.lastPoint.multi){c=new w.Point(e.p.x,e.p.y);c.sub(this.lastPoint);for(let f=0,g=this.molecules.length;f<g;f++){var b=this.molecules[f];for(let k=0,m=b.atoms.length;k<m;k++)b.atoms[k].add(c);b.check()}for(let f=0,g=this.shapes.length;f<g;f++){b=this.shapes[f].getPoints();for(let k=
0,m=b.length;k<m;k++)b[k].add(c)}this.lastPoint=e.p;this.lastPoint.multi=!0;this.repaint()}else this.lastPoint=e.p,this.lastPoint.multi=!0};d.gesturechange=function(e){e.scale-this.lastPinchScale!==0&&(this.styles.scale*=e.scale/this.lastPinchScale,this.styles.scale<.01&&(this.styles.scale=.01),this.lastPinchScale=e.scale);if(this.lastGestureRotate-e.rotation!==0){let c=(this.lastGestureRotate-e.rotation)/180*u.PI,b=new w.Point(this.width/2,this.height/2);for(let f=0,g=this.molecules.length;f<g;f++){let k=
this.molecules[f];for(let m=0,r=k.atoms.length;m<r;m++){let t=k.atoms[m],v=b.distance(t),x=b.angle(t)+c;t.x=b.x+v*u.cos(x);t.y=b.y-v*u.sin(x)}k.check()}this.lastGestureRotate=e.rotation}this.repaint()};d.gestureend=function(e){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);(function(q,B){q.ViewerCanvas=function(w,u,l){q._Canvas.call(this,w,u,l)};q.ViewerCanvas.prototype=new q._Canvas})(ChemDoodle);
(function(q,B,w){q._SpectrumCanvas=function(u,l,n){q._Canvas.call(this,u,l,n)};B=q._SpectrumCanvas.prototype=new q._Canvas;B.spectrum=w;B.emptyMessage="No Spectrum Loaded or Recognized";B.loadMolecule=w;B.getMolecule=w;B.innerRepaint=function(u){this.spectrum&&this.spectrum.data.length>0?this.spectrum.draw(u,this.styles,this.width,this.height):this.emptyMessage&&(u.fillStyle="#737683",u.textAlign="center",u.textBaseline="middle",u.font="18px Helvetica, Verdana, Arial, Sans-serif",u.fillText(this.emptyMessage,
this.width/2,this.height/2))};B.loadSpectrum=function(u){this.spectrum=u;this.repaint()};B.getSpectrum=function(){return this.spectrum};B.getSpectrumCoordinates=function(u,l){return spectrum.getInternalCoordinates(u,l,this.width,this.height)}})(ChemDoodle,document);(function(q,B){q.ObserverCanvas=function(w,u,l){q._SpectrumCanvas.call(this,w,u,l)};q.ObserverCanvas.prototype=new q._SpectrumCanvas})(ChemDoodle);
(function(q,B){q.OverlayCanvas=function(w,u,l){q._SpectrumCanvas.call(this,w,u,l)};B=q.OverlayCanvas.prototype=new q._SpectrumCanvas;B.overlaySpectra=[];B.superRepaint=B.innerRepaint;B.innerRepaint=function(w){this.superRepaint(w);if(this.spectrum&&this.spectrum.data.length>0)for(let u=0,l=this.overlaySpectra.length;u<l;u++){let n=this.overlaySpectra[u];n&&n.data.length>0&&(n.minX=this.spectrum.minX,n.maxX=this.spectrum.maxX,n.drawPlot(w,this.styles,this.width,this.height,this.spectrum.memory.offsetTop,
this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}};B.addSpectrum=function(w){this.spectrum?this.overlaySpectra.push(w):this.spectrum=w}})(ChemDoodle);
(function(q,B,w,u){q.PerspectiveCanvas=function(n,d,e){q._SpectrumCanvas.call(this,n,d,e)};let l=q.PerspectiveCanvas.prototype=new q._SpectrumCanvas;l.dragRange=u;l.rescaleYAxisOnZoom=!0;l.lastPinchScale=1;l.mousedown=function(n){this.dragRange=new q.structures.Point(n.p.x,n.p.x)};l.mouseup=function(n){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(n=this.spectrum.zoom(this.dragRange.x,n.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.styles.scale=
n)),this.dragRange=u,this.repaint())};l.drag=function(n){this.dragRange&&(this.dragRange.multi?this.dragRange=u:(B.SHIFT&&(this.spectrum.translate(n.p.x-this.dragRange.x,this.width),this.dragRange.x=n.p.x),this.dragRange.y=n.p.x),this.repaint())};l.drawChildExtras=function(n){if(this.dragRange){var d=w.min(this.dragRange.x,this.dragRange.y);let e=w.max(this.dragRange.x,this.dragRange.y);n.strokeStyle="gray";n.lineStyle=1;n.beginPath();for(n.moveTo(d,this.height/2);d<=e;d++)d%10<5?n.lineTo(d,w.round(this.height/
2)):n.moveTo(d,w.round(this.height/2));n.stroke()}};l.mousewheel=function(n,d){this.styles.scale-=d/10;this.styles.scale<.01&&(this.styles.scale=.01);this.repaint()};l.dblclick=function(n){this.spectrum.setup();this.styles.scale=1;this.repaint()};l.multitouchmove=function(n,d){d===2&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(n.p.x-this.dragRange.x,this.width),this.dragRange.x=n.p.x,this.dragRange.y=n.p.x,this.repaint()):(this.dragRange=new q.structures.Point(n.p.x,n.p.x),this.dragRange.multi=
!0))};l.gesturechange=function(n){this.styles.scale*=n.scale/this.lastPinchScale;this.styles.scale<.01&&(this.styles.scale=.01);this.lastPinchScale=n.scale;this.repaint()};l.gestureend=function(n){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(q,B,w,u){q.SeekerCanvas=function(n,d,e,c){q._SpectrumCanvas.call(this,n,d,e);this.seekType=c};let l=q.SeekerCanvas.prototype=new q._SpectrumCanvas;l.superRepaint=l.innerRepaint;l.innerRepaint=function(n){this.superRepaint(n);if(this.spectrum&&this.spectrum.data.length>0&&this.p){if(this.seekType===q.SeekerCanvas.SEEK_POINTER){var d=this.p;var e=this.spectrum.getInternalCoordinates(d.x,d.y)}else if(this.seekType===q.SeekerCanvas.SEEK_PLOT||this.seekType===q.SeekerCanvas.SEEK_PEAK){e=this.seekType===
q.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!e)return;d={x:this.spectrum.getTransformedX(e.x,this.styles,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(e.y/100,this.styles,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}n.fillStyle="white";n.strokeStyle=this.styles.plots_color;n.lineWidth=this.styles.plots_width;n.beginPath();n.arc(d.x,d.y,
3,0,w.PI*2,!1);n.fill();n.stroke();n.font=B.getFontString(this.styles.text_font_size,this.styles.text_font_families);n.textAlign="left";n.textBaseline="bottom";e="x:"+e.x.toFixed(3)+", y:"+e.y.toFixed(3);let c=d.x+3,b=n.measureText(e).width;c+b>this.width-2&&(c-=6+b);d=d.y;d-this.styles.text_font_size-2<0&&(d+=this.styles.text_font_size);n.fillRect(c,d-this.styles.text_font_size,b,this.styles.text_font_size);n.fillStyle="black";n.fillText(e,c,d)}};l.mouseout=function(n){this.p=u;this.repaint()};l.mousemove=
function(n){this.p={x:n.p.x-2,y:n.p.y-3};this.repaint()};l.touchstart=function(n){this.mousemove(n)};l.touchmove=function(n){this.mousemove(n)};l.touchend=function(n){this.mouseout(n)};q.SeekerCanvas.SEEK_POINTER="pointer";q.SeekerCanvas.SEEK_PLOT="plot";q.SeekerCanvas.SEEK_PEAK="peak"})(ChemDoodle,ChemDoodle.extensions,Math);
(function(q,B,w,u,l,n,d,e,c,b,f,g,k){q._Canvas3D=function(r,t,v){q._Canvas.call(this,r,t,v)};q._Canvas3D.PRESERVE_DRAWING_BUFFER=!1;b=q._Canvas3D.prototype=new q._Canvas;let m=q._Canvas.prototype;b.rotationMatrix=k;b.contentCenter=k;b.lastPoint=k;b.emptyMessage="WebGL is Unavailable!";b.lastPinchScale=1;b.lastGestureRotate=0;b.afterLoadContent=function(){var r=new w.Bounds;for(let a=0,h=this.molecules.length;a<h;a++)r.expand(this.molecules[a].getBounds3D());var t=f.dist([r.maxX,r.maxY,r.maxZ],[r.minX,
r.minY,r.minZ])/2+1.5;t===Infinity&&(t=10);this.maxDimension=d.max(r.maxX-r.minX,r.maxY-r.minY);r=d.min(179.9,d.max(this.styles.projectionPerspectiveVerticalFieldOfView_3D,.1));var v=r/360*d.PI,x=d.tan(v)/.8;x=t/x;let y=this.width/this.height;this.camera.fieldOfView=r;this.camera.near=x-t;this.camera.far=x+t;this.camera.aspect=y;c.translate(c.identity(this.camera.viewMatrix),[0,0,-x]);v=t/d.tan(v);this.lighting.camera.fieldOfView=r;this.lighting.camera.near=v-t;this.lighting.camera.far=v+t;this.lighting.updateView();
this.setupScene()};b.renderDepthMap=function(){if(this.styles.shadow_3D&&l.DepthShader){let r=this.gl.isEnabled(this.gl.CULL_FACE);r||this.gl.enable(this.gl.CULL_FACE);this.depthShader.useShaderProgram(this.gl);let t=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0);this.lightDepthMapFramebuffer.bind(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.depthShader.setProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);
this.depthShader.enableAttribsArray(this.gl);for(let v=0,x=this.molecules.length;v<x;v++)this.molecules[v].render(this.gl,this.styles);this.gl.flush();this.depthShader.disableAttribsArray(this.gl);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(t[0],t[1],t[2],t[3]);r||this.gl.disable(this.gl.CULL_FACE)}};b.renderExtras=function(){this.phongShader.useShaderProgram(this.gl);this.phongShader.enableAttribsArray(this.gl);var r=[];for(let t=0,v=this.shapes.length;t<v;t++){let x=this.shapes[t];
x instanceof l._Surface&&(!x.styles&&this.styles.surfaces_alpha!==1||x.styles&&x.styles.surfaces_alpha!==1)?r.push(x):x.render(this.gl,this.styles)}if(r.length!==0){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);for(let t=0,v=r.length;t<v;t++)r[t].render(this.gl,this.styles);this.gl.depthMask(!0);this.gl.disable(this.gl.BLEND);this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}this.phongShader.setShadow(this.gl,
!1);this.phongShader.setFogMode(this.gl,0);this.phongShader.setFlatColor(this.gl,!1);this.styles.compass_display&&(this.phongShader.setLightDirection(this.gl,[0,0,-1]),this.compass.render(this.gl,this.styles));this.phongShader.disableAttribsArray(this.gl);this.gl.flush();this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);this.labelShader.useShaderProgram(this.gl);this.labelShader.setMatrixUniforms(this.gl,this.gl.modelViewMatrix);this.labelShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);
this.labelShader.setDimension(this.gl,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight);this.labelShader.enableAttribsArray(this.gl);this.styles.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.styles,this.getMolecules());if(this.styles.measurement_displayText_3D)for(let t=0,v=this.shapes.length;t<v;t++)r=this.shapes[t],r.renderText&&r.renderText(this.gl,this.styles);this.styles.compass_display&&this.styles.compass_displayText_3D&&this.compass.renderAxis(this.gl);this.labelShader.disableAttribsArray(this.gl);
this.gl.disable(this.gl.BLEND);this.gl.depthMask(!0);this.gl.flush();this.drawChildExtras&&this.drawChildExtras(this.gl);this.gl.flush()};b.renderColor=function(){this.phongShader.useShaderProgram(this.gl);this.gl.uniform1i(this.phongShader.shadowDepthSampleUniform,0);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.lightDepthMapTexture.texture);this.phongShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.phongShader.setShadow(this.gl,this.styles.shadow_3D);
this.phongShader.setFlatColor(this.gl,this.styles.flat_color_3D);this.phongShader.setGammaCorrection(this.gl,this.styles.gammaCorrection_3D);this.phongShader.setShadowTextureSize(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.phongShader.setShadowIntensity(this.gl,this.styles.shadow_intensity_3D);this.phongShader.setFogMode(this.gl,this.styles.fog_mode_3D);this.phongShader.setFogColor(this.gl,this.fogging.colorRGB);this.phongShader.setFogStart(this.gl,this.fogging.fogStart);this.phongShader.setFogEnd(this.gl,
this.fogging.fogEnd);this.phongShader.setFogDensity(this.gl,this.fogging.density);this.phongShader.setLightProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);this.phongShader.setLightDiffuseColor(this.gl,this.lighting.diffuseRGB);this.phongShader.setLightSpecularColor(this.gl,this.lighting.specularRGB);this.phongShader.setLightDirection(this.gl,this.lighting.direction);this.phongShader.enableAttribsArray(this.gl);for(let r=0,t=this.molecules.length;r<t;r++)this.molecules[r].render(this.gl,
this.styles);this.phongShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderPosition=function(){this.positionShader.useShaderProgram(this.gl);this.positionShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.positionShader.enableAttribsArray(this.gl);for(let r=0,t=this.molecules.length;r<t;r++)this.molecules[r].render(this.gl,this.styles);this.positionShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderNormal=function(){this.normalShader.useShaderProgram(this.gl);
this.normalShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.normalShader.enableAttribsArray(this.gl);for(let r=0,t=this.molecules.length;r<t;r++)this.molecules[r].render(this.gl,this.styles);this.normalShader.disableAttribsArray(this.gl);this.gl.flush()};b.renderSSAO=function(){this.ssaoShader.useShaderProgram(this.gl);this.ssaoShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.ssaoShader.setSampleKernel(this.gl,this.ssao.sampleKernel);this.ssaoShader.setKernelRadius(this.gl,
this.styles.ssao_kernel_radius);this.ssaoShader.setPower(this.gl,this.styles.ssao_power);this.ssaoShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoShader.positionSampleUniform,0);this.gl.uniform1i(this.ssaoShader.normalSampleUniform,1);this.gl.uniform1i(this.ssaoShader.noiseSampleUniform,2);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssao.noiseTexture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoShader.disableAttribsArray(this.gl);this.gl.flush();this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.ssaoBlurShader.useShaderProgram(this.gl);this.ssaoBlurShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoBlurShader.aoSampleUniform,0);this.gl.uniform1i(this.ssaoBlurShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoBlurShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoBlurShader.disableAttribsArray(this.gl);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.flush()};b.renderOutline=function(){this.outlineShader.useShaderProgram(this.gl);this.outlineShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.outlineShader.setNormalThreshold(this.gl,this.styles.outline_normal_threshold);this.outlineShader.setDepthThreshold(this.gl,this.styles.outline_depth_threshold);this.outlineShader.setThickness(this.gl,this.styles.outline_thickness);this.gl.uniform1i(this.outlineShader.normalSampleUniform,0);this.gl.uniform1i(this.outlineShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.outlineShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.outlineShader.disableAttribsArray(this.gl);this.gl.flush()};b.deferredRender=function(){let r=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(0,0,0,0);this.colorFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderColor();this.positionFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderPosition();this.normalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderNormal();this.styles.ssao_3D&&l.SSAOShader?
(this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.renderSSAO()):(this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));this.outlineFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clearColor(1,1,1,1);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.styles.outline_3D&&this.renderOutline();
this.gl.clearColor(r[0],r[1],r[2],r[3]);this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.lightingShader.useShaderProgram(this.gl);this.gl.uniform1i(this.lightingShader.positionSampleUniform,0);this.gl.uniform1i(this.lightingShader.colorSampleUniform,1);this.gl.uniform1i(this.lightingShader.ssaoSampleUniform,2);this.gl.uniform1i(this.lightingShader.outlineSampleUniform,3);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssaoTexture.texture);this.gl.activeTexture(this.gl.TEXTURE3);this.gl.bindTexture(this.gl.TEXTURE_2D,this.outlineTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.lightingShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,
0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.lightingShader.disableAttribsArray(this.gl);this.gl.flush();this.styles.smaa_useSMAA&&this.smaaAreaTexture&&this.smaaSearchTexture?(this.gl.clearColor(0,0,0,1),this.gl.blendFunc(this.gl.ONE,this.gl.ZERO),this.smaaEdgesFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,
this.imageTexture.texture),this.smaaEdgesShader.useShaderProgram(this.gl),this.smaaEdgesShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.smaaEdgesShader.setEdgeThreshold(this.gl,this.styles.smaa_edgeThreshold),this.smaaEdgesShader.setContrastFactor(this.gl,this.styles.smaa_contrastFactor),this.smaaEdgesShader.setBackgroundColor(this.gl,r[0],r[1],r[2]),this.smaaEdgesShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,
0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.smaaEdgesShader.disableAttribsArray(this.gl),this.smaaWeightsFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.smaaWeightsShader.useShaderProgram(this.gl),this.smaaWeightsShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.smaaWeightsShader.setSearchSteps(this.gl,
this.styles.smaa_searchSteps),this.gl.uniform1i(this.smaaWeightsShader.edgesSamplerUniform,0),this.gl.uniform1i(this.smaaWeightsShader.areaSamplerUniform,1),this.gl.uniform1i(this.smaaWeightsShader.searchSamplerUniform,2),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaEdgesTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaAreaTexture),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,
this.smaaSearchTexture),this.gl.activeTexture(this.gl.TEXTURE0),this.smaaWeightsShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.smaaWeightsShader.disableAttribsArray(this.gl),this.aaFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight),this.smaaBlendShader.useShaderProgram(this.gl),this.smaaBlendShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.smaaBlendShader.setAntialias(this.gl,this.styles.antialias_3D),this.gl.uniform1i(this.smaaBlendShader.weightsSamplerUniform,0),this.gl.uniform1i(this.smaaBlendShader.imageSamplerUniform,1),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaWeightsTexture.texture),this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.gl.activeTexture(this.gl.TEXTURE0),this.smaaBlendShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.smaaBlendShader.disableAttribsArray(this.gl),this.gl.clearColor(1,1,1,1),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)):(this.aaFramebuffer.bind(this.gl,
this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.fxaaShader.useShaderProgram(this.gl),this.fxaaShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaShader.setAntialias(this.gl,this.styles.antialias_3D),this.fxaaShader.setEdgeThreshold(this.gl,
this.styles.fxaa_edgeThreshold),this.fxaaShader.setEdgeThresholdMin(this.gl,this.styles.fxaa_edgeThresholdMin),this.fxaaShader.setSearchSteps(this.gl,this.styles.fxaa_searchSteps),this.fxaaShader.setSearchThreshold(this.gl,this.styles.fxaa_searchThreshold),this.fxaaShader.setSubpixCap(this.gl,this.styles.fxaa_subpixCap),this.fxaaShader.setSubpixTrim(this.gl,this.styles.fxaa_subpixTrim),this.fxaaShader.enableAttribsArray(this.gl),this.gl.quadBuffer.bindBuffers(this.gl),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,
0,this.gl.quadBuffer.vertexPositionBuffer.numItems),this.fxaaShader.disableAttribsArray(this.gl));this.gl.flush();this.finalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.renderExtras();this.gl.clearColor(r[0],r[1],r[2],r[3]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.bindTexture(this.gl.TEXTURE_2D,this.aaTexture.texture);
this.quadShader.useShaderProgram(this.gl);this.quadShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.quadShader.disableAttribsArray(this.gl);this.gl.flush()};b.forwardRender=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);
this.renderColor();this.renderExtras()};b.repaint=function(){this.gl&&(this.gl.lightViewMatrix=c.multiply(this.lighting.camera.viewMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,this.gl.modelViewMatrix=this.gl.lightViewMatrix,this.renderDepthMap(),this.gl.modelViewMatrix=c.multiply(this.camera.viewMatrix,this.rotationMatrix,[]),c.translate(this.gl.modelViewMatrix,this.contentCenter),this.isSupportDeferred()&&(this.styles.ssao_3D||this.styles.outline_3D)?this.deferredRender():
this.forwardRender())};b.pick=function(r,t,v,x){if(this.gl){let y=this.height-t;this.pixelRatio!==1&&(r*=this.pixelRatio,y*=this.pixelRatio);c.multiply(this.camera.viewMatrix,this.rotationMatrix,this.gl.modelViewMatrix);c.translate(this.gl.modelViewMatrix,this.contentCenter);this.gl.rotationMatrix=this.rotationMatrix;this.pickShader.useShaderProgram(this.gl);t=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0);this.pickerFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.pickShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.pickShader.enableAttribsArray(this.gl);let a=[];for(let h=0,p=this.molecules.length;h<p;h++)this.molecules[h].renderPickFrame(this.gl,this.styles,a,v,x);this.pickShader.disableAttribsArray(this.gl);this.gl.flush();v=new Uint8Array(4);this.gl.readPixels(r-2,y+2,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,v);x=k;v[3]>0&&(x=a[v[2]|v[1]<<
8|v[0]<<16]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(t[0],t[1],t[2],t[3]);return x}return k};b.center=function(){let r=new u.Atom,t=this.molecules.length;for(let v=0,x=t;v<x;v++)r.add3D(this.molecules[v].getCenter3D());r.x/=t;r.y/=t;r.z/=t;this.contentCenter=[-r.x,-r.y,-r.z]};b.isSupportDeferred=function(){return this.gl.textureFloatExt&&this.gl.depthTextureExt};b.create=function(r,t,v){m.create.call(this,r,t,v);try{let x=e.getElementById(this.id);this.gl=x.getContext("webgl",
{preserveDrawingBuffer:q._Canvas3D.PRESERVE_DRAWING_BUFFER});this.gl||(this.gl=x.getContext("experimental-webgl"))}catch(x){}this.gl?(this.pixelRatio!==1&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,
this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearDepth(1),this.shadowTextureSize=1024,this.rotationMatrix=c.identity([]),this.contentCenter=[0,0,0],this.camera=new l.Camera,this.label3D=new l.Label,this.lighting=new l.Light(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D),this.fogging=new l.Fog(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D),this.gl.depthTextureExt=
this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture"),this.gl.textureFloatExt=this.gl.getExtension("OES_texture_float")||this.gl.getExtension("WEBKIT_OES_texture_float")||this.gl.getExtension("MOZ_OES_texture_float"),this.ssao=new l.SSAO,this.pickerColorTexture=new l.Texture,this.pickerColorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.pickerDepthRenderbuffer=new l.Renderbuffer,
this.pickerDepthRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.pickerFramebuffer=new l.Framebuffer,this.pickerFramebuffer.init(this.gl),this.pickerFramebuffer.setColorTexture(this.gl,this.pickerColorTexture.texture),this.pickerFramebuffer.setDepthRenderbuffer(this.gl,this.pickerDepthRenderbuffer.renderbuffer),this.lightDepthMapTexture=new l.Texture,this.lightDepthMapRenderbuffer=new l.Renderbuffer,this.lightDepthMapFramebuffer=new l.Framebuffer,this.lightDepthMapFramebuffer.init(this.gl),
this.gl.depthTextureExt?(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.RGBA4),this.lightDepthMapFramebuffer.setColorRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer),this.lightDepthMapFramebuffer.setDepthTexture(this.gl,this.lightDepthMapTexture.texture)):(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),
this.lightDepthMapFramebuffer.setColorTexture(this.gl,this.lightDepthMapTexture.texture),this.lightDepthMapFramebuffer.setDepthRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer)),this.isSupportDeferred()&&(this.depthTexture=new l.Texture,this.depthTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.colorTexture=new l.Texture,this.colorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.positionTexture=new l.Texture,this.positionTexture.init(this.gl,this.gl.FLOAT,
this.gl.RGBA),this.normalTexture=new l.Texture,this.normalTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.ssaoTexture=new l.Texture,this.ssaoTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.outlineTexture=new l.Texture,this.outlineTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.aaTexture=new l.Texture,this.aaTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.gl.bindTexture(this.gl.TEXTURE_2D,this.aaTexture.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,
this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.smaaEdgesTexture=new l.Texture,this.smaaEdgesTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaEdgesTexture.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,
null),this.smaaWeightsTexture=new l.Texture,this.smaaWeightsTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaWeightsTexture.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.imageTexture=new l.Texture,this.imageTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),
this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.colorFramebuffer=new l.Framebuffer,this.colorFramebuffer.init(this.gl),this.colorFramebuffer.setColorTexture(this.gl,this.colorTexture.texture),this.colorFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),
this.normalFramebuffer=new l.Framebuffer,this.normalFramebuffer.init(this.gl),this.normalFramebuffer.setColorTexture(this.gl,this.normalTexture.texture),this.normalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.positionFramebuffer=new l.Framebuffer,this.positionFramebuffer.init(this.gl),this.positionFramebuffer.setColorTexture(this.gl,this.positionTexture.texture),this.positionFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.ssaoFramebuffer=new l.Framebuffer,
this.ssaoFramebuffer.init(this.gl),this.ssaoFramebuffer.setColorTexture(this.gl,this.ssaoTexture.texture),this.outlineFramebuffer=new l.Framebuffer,this.outlineFramebuffer.init(this.gl),this.outlineFramebuffer.setColorTexture(this.gl,this.outlineTexture.texture),this.aaFramebuffer=new l.Framebuffer,this.aaFramebuffer.init(this.gl),this.aaFramebuffer.setColorTexture(this.gl,this.aaTexture.texture),this.smaaEdgesFramebuffer=new l.Framebuffer,this.smaaEdgesFramebuffer.init(this.gl),this.smaaEdgesFramebuffer.setColorTexture(this.gl,
this.smaaEdgesTexture.texture),this.smaaWeightsFramebuffer=new l.Framebuffer,this.smaaWeightsFramebuffer.init(this.gl),this.smaaWeightsFramebuffer.setColorTexture(this.gl,this.smaaWeightsTexture.texture),this.quadFramebuffer=new l.Framebuffer,this.quadFramebuffer.init(this.gl),this.quadFramebuffer.setColorTexture(this.gl,this.imageTexture.texture),this.finalFramebuffer=new l.Framebuffer,this.finalFramebuffer.init(this.gl),this.finalFramebuffer.setColorTexture(this.gl,this.aaTexture.texture),this.finalFramebuffer.setDepthTexture(this.gl,
this.depthTexture.texture),this.normalShader=new l.NormalShader,this.normalShader.init(this.gl),this.positionShader=new l.PositionShader,this.positionShader.init(this.gl),l.SSAOShader&&(this.ssaoShader=new l.SSAOShader,this.ssaoShader.init(this.gl),this.ssaoBlurShader=new l.SSAOBlurShader,this.ssaoBlurShader.init(this.gl)),this.outlineShader=new l.OutlineShader,this.outlineShader.init(this.gl),this.lightingShader=new l.LightingShader,this.lightingShader.init(this.gl),this.fxaaShader=new l.FXAAShader,
this.fxaaShader.init(this.gl),this.smaaEdgesShader=new l.SMAAEdgesShader,this.smaaEdgesShader.init(this.gl),this.smaaWeightsShader=new l.SMAAWeightsShader,this.smaaWeightsShader.init(this.gl),this.smaaBlendShader=new l.SMAABlendShader,this.smaaBlendShader.init(this.gl),this.quadShader=new l.QuadShader,this.quadShader.init(this.gl)),this.labelShader=new l.LabelShader,this.labelShader.init(this.gl),this.pickShader=new l.PickShader,this.pickShader.init(this.gl),this.phongShader=new l.PhongShader,this.phongShader.init(this.gl),
l.DepthShader&&(this.depthShader=new l.DepthShader,this.depthShader.init(this.gl)),this.textTextImage=new l.TextImage,this.textTextImage.init(this.gl),this.gl.textImage=new l.TextImage,this.gl.textImage.init(this.gl),this.gl.textMesh=new l.TextMesh,this.gl.textMesh.init(this.gl),this.gl.material=new l.Material,this.setupScene()):this.displayMessage()};b.displayMessage=function(){var r=e.getElementById(this.id);r.getContext&&(r=r.getContext("2d"),this.styles.backgroundColor&&(r.fillStyle=this.styles.backgroundColor,
r.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(r.fillStyle="#737683",r.textAlign="center",r.textBaseline="middle",r.font="18px Helvetica, Verdana, Arial, Sans-serif",r.fillText(this.emptyMessage,this.width/2,this.height/2)))};b.renderText=function(r,t){let v={position:[],texCoord:[],translation:[]};this.textTextImage.pushVertexData(r,t,0,v);this.gl.textMesh.storeData(this.gl,v.position,v.texCoord,v.translation);this.textTextImage.useTexture(this.gl);this.gl.textMesh.render(this.gl)};
b.setupScene=function(){if(this.gl){var r=this.styles.backgroundColor?this.styles.backgroundColor:"transparent";e.getElementById(this.id).style.backgroundColor=r;r=r==="transparent"?[0,0,0,0]:w.getRGB(r,1);this.gl.clearColor(r[0],r[1],r[2],r.length==4?r[3]:1);this.styles.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE);this.gl.sphereBuffer=new l.Sphere(1,this.styles.atoms_resolution_3D,this.styles.atoms_resolution_3D);this.gl.starBuffer=new l.Star;this.gl.cylinderBuffer=
new l.Cylinder(1,1,this.styles.bonds_resolution_3D);this.gl.cylinderClosedBuffer=new l.Cylinder(1,1,this.styles.bonds_resolution_3D,!0);this.gl.boxBuffer=new l.Box(1,1,1);this.gl.pillBuffer=new l.Pill(this.styles.bonds_pillDiameter_3D/2,this.styles.bonds_pillHeight_3D,this.styles.bonds_pillLatitudeResolution_3D,this.styles.bonds_pillLongitudeResolution_3D);this.gl.lineBuffer=new l.Line;this.gl.lineArrowBuffer=new l.LineArrow;this.gl.arrowBuffer=new l.Arrow(.3,this.styles.compass_resolution_3D);this.gl.quadBuffer=
new l.Quad;this.gl.textImage.updateFont(this.gl,this.styles.text_font_size,this.styles.text_font_families,this.styles.text_font_bold,this.styles.text_font_italic,this.styles.text_font_stroke_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D);this.compass=new l.Compass(this.gl,
this.styles);this.lightDepthMapTexture.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.lightDepthMapRenderbuffer.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.pickerColorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.pickerDepthRenderbuffer.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);if(this.isSupportDeferred()){this.depthTexture.setParameter(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.colorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.imageTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.positionTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.normalTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.ssaoTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);
this.outlineTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.aaTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.smaaEdgesTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.smaaWeightsTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);const a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC";
a.onload=()=>{this.smaaSearchTexture=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaSearchTexture);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE);this.gl.texImage2D(this.gl.TEXTURE_2D,
0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a);this.gl.bindTexture(this.gl.TEXTURE_2D,null);this.repaint()};const h=new Image;h.src="data:image/png;base64,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";
h.onload=()=>{this.smaaAreaTexture=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,this.smaaAreaTexture);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE);this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE);this.gl.texImage2D(this.gl.TEXTURE_2D,0,
this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,h);this.gl.bindTexture(this.gl.TEXTURE_2D,null);this.repaint()};this.ssao.initSampleKernel(this.styles.ssao_kernel_samples);this.ssao.initNoiseTexture(this.gl)}this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);for(let a=0,h=this.molecules.length;a<h;a++)if(r=this.molecules[a],r.labelMesh instanceof l.TextMesh||(r.labelMesh=new l.TextMesh,r.labelMesh.init(this.gl)),r.chains){r.ribbons=[];r.cartoons=[];r.tubes=[];r.pipePlanks=[];
for(let p=0,z=r.chains.length;p<z;p++){var t=r.chains[p];for(let A=0,C=t.length-1;A<C;A++)t[A].Test=A;var v=t.length>3&&n[t[3].name]&&n[t[3].name].aminoColor==="#BEA06E";if(t.length>0&&!t[0].lineSegments){for(let A=0,C=t.length-1;A<C;A++)t[A].setup(t[A+1].cp1,v?1:this.styles.proteins_horizontalResolution);if(!v)for(let A=1,C=t.length-1;A<C;A++)B.vec3AngleFrom(t[A-1].D,t[A].D)>d.PI/2&&(t[A].guidePointsSmall.reverse(),t[A].guidePointsLarge.reverse(),f.scale(t[A].D,-1));for(let A=2,C=t.length-3;A<C;A++)t[A].computeLineSegments(t[A-
2],t[A-1],t[A+1],!v,v?this.styles.nucleics_verticalResolution:this.styles.proteins_verticalResolution);t.pop();t.pop();t.pop();t.shift();t.shift()}var x=w.hsl2rgb(z===1?.5:p/z,1,.5);x="rgb("+x[0]+","+x[1]+","+x[2]+")";t.chainColor=x;if(v)t=new l.Tube(t,this.styles.nucleics_tubeThickness,this.styles.nucleics_tubeResolution_3D),t.chainColor=x,r.tubes.push(t);else{v=new l.PipePlank(t,this.styles);r.pipePlanks.push(v);v=t.shift();var y={front:new l.Ribbon(t,this.styles.proteins_ribbonThickness,!1),back:new l.Ribbon(t,
-this.styles.proteins_ribbonThickness,!1)};y.front.chainColor=x;y.back.chainColor=x;r.ribbons.push(y);y={front:new l.Ribbon(t,this.styles.proteins_ribbonThickness,!0),back:new l.Ribbon(t,-this.styles.proteins_ribbonThickness,!0)};y.front.chainColor=x;y.back.chainColor=x;r.cartoons.push(y);t.unshift(v)}}}this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.styles);if(this instanceof q.MovieCanvas3D&&this.frames)for(let a=0,h=this.frames.length;a<h;a++){r=this.frames[a];for(let p=0,z=
r.mols.length;p<z;p++)t=r.mols[p],t.labelMesh instanceof u.d3.TextMesh||(t.labelMesh=new u.d3.TextMesh,t.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,r.mols,this.styles)}}};b.updateScene=function(){this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,
this.styles.fog_end_3D,this.styles.fog_density_3D);this.repaint()};b.mousedown=function(r){this.lastPoint=r.p};b.mouseup=function(r){this.lastPoint=k};b.rightmousedown=function(r){this.lastPoint=r.p};b.drag=function(r){if(this.lastPoint){if(q.monitor.ALT){var t=new u.Point(r.p.x,r.p.y);t.sub(this.lastPoint);var v=d.tan(this.camera.fieldOfView/360*d.PI);v=this.height/2/this.camera.zoom/v;v=this.camera.focalLength()/v;c.translate(this.camera.viewMatrix,[t.x*v,-t.y*v,0])}else v=r.p.x-this.lastPoint.x,
t=r.p.y-this.lastPoint.y,v=c.rotate(c.identity([]),v*d.PI/180,[0,1,0]),c.rotate(v,t*d.PI/180,[1,0,0]),this.rotationMatrix=c.multiply(v,this.rotationMatrix);this.lastPoint=r.p;this.repaint()}};b.mousewheel=function(r,t){t>0?this.camera.zoomIn():this.camera.zoomOut();this.updateScene()};b.multitouchmove=function(r,t){if(t===2)if(this.lastPoint&&this.lastPoint.multi){t=new u.Point(r.p.x,r.p.y);t.sub(this.lastPoint);var v=d.tan(this.camera.fieldOfView/360*d.PI);v=this.height/2/this.camera.zoom/v;v=this.camera.focalLength()/
v;c.translate(this.camera.viewMatrix,[t.x*v,-t.y*v,0]);this.lastPoint=r.p;this.repaint()}else this.lastPoint=r.p,this.lastPoint.multi=!0};b.gesturechange=function(r){if(r.scale-this.lastPinchScale!==0){let t=-(r.scale/this.lastPinchScale-1)*30;if(isNaN(t))return;t>0?this.camera.zoomOut():this.camera.zoomIn();this.updateScene();this.lastPinchScale=r.scale}this.repaint()};b.gestureend=function(r){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,
ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,window);(function(q,B,w,u){q.MolGrabberCanvas3D=function(l,n,d){q._Canvas3D.call(this,l,n,d);n=`
			<br>
			<input type="text" id="${l}_query" size="32" value="" />
			<br>
			<nobr>
				<select id="${l}_select" style="user-select:none;">
					<!--<option value="chemexper">ChemExper-->
					<!--<option value="chemspider">ChemSpider-->
					<option value="pubchem" selected>PubChem
				</select>
				<button type="button" id="${l}_submit" class="reset-all-button">Show Molecule</button>
			</nobr>
		`;w.getElementById(l).insertAdjacentHTML("afterend",n);let e=this;w.getElementById(l+"_submit").addEventListener("click",function(){e.search()});w.getElementById(l+"_query").addEventListener("keypress",function(c){c.key!=="Enter"&&c.keyCode!==13||e.search()})};u=q.MolGrabberCanvas3D.prototype=new q._Canvas3D;u.setSearchTerm=function(l){w.getElementById(this.id+"_query").value=l;this.search()};u.search=function(){let l=this;B.getMoleculeFromDatabase(w.getElementById(this.id+"_query").value,{database:w.getElementById(this.id+
"_select").value,dimension:3},function(n){l.loadMolecule(n)})}})(ChemDoodle,ChemDoodle.iChemLabs,document);
(function(q,B,w){q.MovieCanvas3D=function(u,l,n){q._Canvas3D.call(this,u,l,n);this.frames=[]};q.MovieCanvas3D.PLAY_ONCE=0;q.MovieCanvas3D.PLAY_LOOP=1;q.MovieCanvas3D.PLAY_SPRING=2;w=q.MovieCanvas3D.prototype=new q._Canvas3D;w.timeout=50;w.frameNumber=0;w.playMode=2;w.reverse=!1;w.startAnimation=q._AnimatorCanvas.prototype.startAnimation;w.stopAnimation=q._AnimatorCanvas.prototype.stopAnimation;w.isRunning=q._AnimatorCanvas.prototype.isRunning;w.dblclick=q.RotatorCanvas.prototype.dblclick;w.nextFrame=
function(u){u=this.frames[this.frameNumber];this.molecules=u.mols;this.shapes=u.shapes;this.playMode===2&&this.reverse?(this.frameNumber--,this.frameNumber<0&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(this.playMode===2?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,this.playMode===0&&this.stopAnimation())))};w.center=function(){var u=new B.Atom,l=this.frames[0];for(let n=0,d=l.mols.length;n<d;n++)u.add3D(l.mols[n].getCenter3D());u.x/=
l.mols.length;u.y/=l.mols.length;l=new B.Atom;l.sub3D(u);for(let n=0,d=this.frames.length;n<d;n++){u=this.frames[n];for(let e=0,c=u.mols.length;e<c;e++){let b=u.mols[e];for(let f=0,g=b.atoms.length;f<g;f++)b.atoms[f].add3D(l)}}};w.addFrame=function(u,l){this.frames.push({mols:u,shapes:l})}})(ChemDoodle,ChemDoodle.structures);
(function(q,B,w,u){let l=[],n=[1,0,0],d=[0,1,0],e=[0,0,1];q.RotatorCanvas3D=function(b,f,g){q._Canvas3D.call(this,b,f,g)};let c=q.RotatorCanvas3D.prototype=new q._Canvas3D;c.timeout=33;B=B.PI/15;c.xIncrement=B;c.yIncrement=B;c.zIncrement=B;c.startAnimation=q._AnimatorCanvas.prototype.startAnimation;c.stopAnimation=q._AnimatorCanvas.prototype.stopAnimation;c.isRunning=q._AnimatorCanvas.prototype.isRunning;c.dblclick=q.RotatorCanvas.prototype.dblclick;c.mousedown=u;c.rightmousedown=u;c.drag=u;c.mousewheel=
u;c.nextFrame=function(b){this.molecules.length===0&&this.shapes.length===0?this.stopAnimation():(w.identity(l),b/=1E3,w.rotate(l,this.xIncrement*b,n),w.rotate(l,this.yIncrement*b,d),w.rotate(l,this.zIncrement*b,e),w.multiply(this.rotationMatrix,l))}})(ChemDoodle,Math,ChemDoodle.lib.mat4);(function(q,B){q.TransformCanvas3D=function(w,u,l){q._Canvas3D.call(this,w,u,l)};q.TransformCanvas3D.prototype=new q._Canvas3D})(ChemDoodle);
(function(q,B){q.ViewerCanvas3D=function(u,l,n){q._Canvas3D.call(this,u,l,n)};let w=q.ViewerCanvas3D.prototype=new q._Canvas3D;w.mousedown=B;w.rightmousedown=B;w.drag=B;w.mousewheel=B})(ChemDoodle);
(function(q,B,w,u,l){function n(d,e,c,b){this.element=d;this.x=e;this.y=c;this.dimension=b;this.allowMultipleSelections=!1}q.PeriodicTableCanvas=function(d,e){this.padding=5;q._Canvas.call(this,d,e*18+this.padding*2,e*10+this.padding*2);this.cellDimension=e?e:20;this.setupTable();this.repaint()};u=q.PeriodicTableCanvas.prototype=new q._Canvas;u.loadMolecule=l;u.getMolecule=l;u.getHoveredElement=function(){return this.hovered?this.hovered.element:l};u.innerRepaint=function(d){for(let e=0,c=this.cells.length;e<
c;e++)this.drawCell(d,this.styles,this.cells[e]);this.hovered&&this.drawCell(d,this.styles,this.hovered);this.selected&&this.drawCell(d,this.styles,this.selected)};u.setupTable=function(){this.cells=[];let d=this.padding,e=this.padding;var c=0;for(let f=0,g=q.SYMBOLS.length;f<g;f++){c===18&&(c=0,e+=this.cellDimension,d=this.padding);var b=q.ELEMENT[q.SYMBOLS[f]];if(b.atomicNumber===2)d+=16*this.cellDimension,c+=16;else if(b.atomicNumber===5||b.atomicNumber===13)d+=10*this.cellDimension,c+=10;(b.atomicNumber<
58||b.atomicNumber>71&&b.atomicNumber<90||b.atomicNumber>103)&&b.atomicNumber<=118&&(this.cells.push(new n(b,d,e,this.cellDimension)),d+=this.cellDimension,c++)}e+=2*this.cellDimension;d=3*this.cellDimension+this.padding;for(c=57;c<104;c++)if(b=q.ELEMENT[q.SYMBOLS[c]],b.atomicNumber===90&&(e+=this.cellDimension,d=3*this.cellDimension+this.padding),b.atomicNumber>=58&&b.atomicNumber<=71||b.atomicNumber>=90&&b.atomicNumber<=103)this.cells.push(new n(b,d,e,this.cellDimension)),d+=this.cellDimension};
u.drawCell=function(d,e,c){let b=d.createRadialGradient(c.x+c.dimension/3,c.y+c.dimension/3,c.dimension*1.5,c.x+c.dimension/3,c.y+c.dimension/3,c.dimension/10);b.addColorStop(0,"#000000");b.addColorStop(.7,c.element.jmolColor);b.addColorStop(1,"#FFFFFF");d.fillStyle=b;B.contextRoundRect(d,c.x,c.y,c.dimension,c.dimension,c.dimension/8);if(c===this.hovered||c===this.selected||c.selected)d.lineWidth=2,d.strokeStyle="#c10000",d.stroke(),d.fillStyle="white";d.fill();d.font=B.getFontString(e.text_font_size,
e.text_font_families);d.fillStyle=e.text_color;d.textAlign="center";d.textBaseline="middle";d.fillText(c.element.symbol,c.x+c.dimension/2,c.y+c.dimension/2)};u.click=function(d){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())};u.touchstart=function(d){this.mousemove(d)};u.mousemove=function(d){let e=d.p.x;d=d.p.y;this.hovered=l;for(let c=0,b=this.cells.length;c<b;c++){let f=this.cells[c];if(w.isBetween(e,f.x,f.x+f.dimension)&&
w.isBetween(d,f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()};u.mouseout=function(d){this.hovered=l;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);
(function(q,B,w,u,l){B.png={};B.png.string=function(n){if(n instanceof q._Canvas3D&&!n.gl.getContextAttributes().preserveDrawingBuffer)throw Error("PNG data cannot be created from a Canvas3D component unless the ChemDoodle._Canvas3D.PRESERVE_DRAWING_BUFFER boolean is set to true before the Canvas3D component is initialized.");return w.getElementById(n.id).toDataURL("image/png")};B.png.download=function(n,d){d===l&&(d="unnamed");let e=w.createElement("a");e.href=this.string(n);e.download=d;e.click()};
B.png.open=function(n){let d=u.open();d.document.open();d.document.write('\x3ciframe src\x3d"'+this.string(n)+'" frameborder\x3d"0" style\x3d"border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen\x3e\x3c/iframe\x3e');d.document.close()}})(ChemDoodle,ChemDoodle.io,document,window);(function(q,B){q.file={};q.file.content=function(w,u){fetch(w).then(l=>{if(!l.ok)throw Error("Network response was not ok");return l.text()}).then(l=>{u(l)})}})(ChemDoodle.io);
(function(q,B,w,u,l,n){B.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v090000/WebHQ";B.inRelay=!1;B.INFO={userAgent:navigator.userAgent,platform:navigator.platform,v_cwc:q.getVersion()};let d=new w.JSONInterpreter,e=new u.Queue;B._contactServer=function(c,b,f,g,k){if(this.inRelay)e.enqueue({call:c,content:b,options:f,callback:g,errorback:k});else{B.inRelay=!0;let m=b instanceof FormData;f=c=JSON.stringify({call:c,content:m?{}:b,options:f,info:ChemDoodle.iChemLabs.INFO});m&&(b.append("jsonData",
JSON.stringify(c)),f=b);b={method:"POST",headers:{"Content-Type":m?"multipart/form-data":"application/json","X-Requested-With":"XMLHttpRequest"},body:f,credentials:"include"};m&&delete b.headers["Content-Type"];fetch(this.SERVER_URL,b).then(r=>{if(!r.ok)throw Error("Network response was not ok");return r.json()}).then(r=>{r.message&&alert(r.message);B.inRelay=!1;g&&r.content&&!r.stop&&g(r.content);r.stop&&k&&k();e.isEmpty()||(r=e.dequeue(),B._contactServer(r.call,r.content,r.options,r.callback,r.errorback))}).catch(r=>
{B.inRelay=!1;k&&k();e.isEmpty()||(r=e.dequeue(),B._contactServer(r.call,r.content,r.options,r.callback,r.errorback))})}};B.authenticate=function(c,b,f,g){this._contactServer("authenticate",{credential:c},b,function(k){f(k)},g)};B.balanceReaction=function(c,b,f,g){let k={};typeof c==="string"||c instanceof String?k.equation=c:k.reaction=d.contentTo(c.molecules,c.shapes);this._contactServer("balanceReaction",k,b,function(m){f(m.result,m.message)},g)};B.calculate=function(c,b,f,g){this._contactServer("calculate",
{mol:d.molTo(c)},b,function(k){f(k)},g)};B.createLewisDotStructure=function(c,b,f,g){this._contactServer("createLewisDot",{mol:d.molTo(c)},b,function(k){f(d.molFrom(k.mol))},g)};B.cir=function(c,b,f,g){this._contactServer("cir",c,b,function(k){f(d.contentFrom(k.data),k.preview)},g)};B.elementalAnalysis=function(c,b,f,g){this._contactServer("elementalAnalysis",{mol:(new ChemDoodle.io.JSONInterpreter).molTo(c)},b,function(k){f(k)},g)};B.fileToImage=function(c,b,f,g){this._contactServer("fileToImage",
c,b,function(k){f(k.imgsrc,k.width,k.height)},g)};B.generateImage=function(c,b,f,g){this._contactServer("generateImage",{mol:d.molTo(c)},b,function(k){f(k.link)},g)};B.generateIUPACName=function(c,b,f,g){this._contactServer("generateIUPACName",{mol:d.molTo(c)},b,function(k){f(k.iupac,k.attemptedPIN)},g)};B.getMoleculeFromContent=function(c,b,f,g){this._contactServer("getMoleculeFromContent",{content:c},b,function(k){let m=!1;for(let r=0,t=k.mol.a.length;r<t;r++)if(k.mol.a[r].z!==0){m=!0;break}if(m)for(let r=
0,t=k.mol.a.length;r<t;r++)k.mol.a[r].x/=20,k.mol.a[r].y/=20,k.mol.a[r].z/=20;f(d.molFrom(k.mol))},g)};B.getMoleculeFromDatabase=function(c,b,f,g){this._contactServer("getMoleculeFromDatabase",{query:c},b,function(k){if(b.dimension===3)for(let m=0,r=k.mol.a.length;m<r;m++)k.mol.a[m].x/=20,k.mol.a[m].y/=-20,k.mol.a[m].z/=20;f(d.molFrom(k.mol))},g)};B.getOptimizedPDBStructure=function(c,b,f,g){this._contactServer("getOptimizedPDBStructure",{id:c},b,function(k){let m;m=k.mol?d.molFrom(k.mol):new u.Molecule;
m.chains=d.chainsFrom(k.ribbons);for(let r=0,t=m.chains.length;r<t;r++){k=m.chains[r];for(let v=0,x=k.length-1;v<x;v++)k[v+1].arrow&&(k[v+1].arrow=!1,k[v].arrow=!0)}m.fromJSON=!0;f(m)},g)};B.getZeoliteFromIZA=function(c,b,f,g){this._contactServer("getZeoliteFromIZA",{query:c},b,function(k){f(ChemDoodle.readCIF(k.cif,b.xSuper,b.ySuper,b.zSuper))},g)};B.isGraphIsomorphism=function(c,b,f,g,k){this._contactServer("isGraphIsomorphism",{arrow:d.molTo(c),target:d.molTo(b)},f,function(m){g(m.value)},k)};
B.isSubgraphIsomorphism=function(c,b,f,g,k){this._contactServer("isSubgraphIsomorphism",{arrow:d.molTo(c),target:d.molTo(b)},f,function(m){g(m.value)},k)};B.isSupergraphIsomorphism=function(c,b,f,g,k){this._contactServer("isSupergraphIsomorphism",{arrow:d.molTo(c),target:d.molTo(b)},f,function(m){g(m.value)},k)};B.getSimilarityMeasure=function(c,b,f,g,k){this._contactServer("getSimilarityMeasure",{first:d.molTo(c),second:d.molTo(b)},f,function(m){g(m.value)},k)};B.kekulize=function(c,b,f,g){this._contactServer("kekulize",
{mol:d.molTo(c)},b,function(k){f(d.molFrom(k.mol))},g)};B.maximumCommonSubstructure=function(c,b,f,g,k){this._contactServer("maximumCommonSubstructure",{m1:d.molTo(c),m2:d.molTo(b)},f,function(m){g(m.map)},k)};B.mechanismMatch=function(c,b,f,g,k){this._contactServer("matchMechanism",{arrow:c,targets:b},f,function(m){g(m)},k)};B.optimize=function(c,b,f,g){this._contactServer("optimize",{mol:d.molTo(c)},b,function(k){k=d.molFrom(k.mol);if(b.dimension===2){for(let m=0,r=k.atoms.length;m<r;m++)c.atoms[m].x=
k.atoms[m].x,c.atoms[m].y=k.atoms[m].y;f()}else if(b.dimension===3){for(let m=0,r=k.atoms.length;m<r;m++)k.atoms[m].x/=20,k.atoms[m].y/=-20,k.atoms[m].z/=20;f(k)}},g)};B.readIUPACName=function(c,b,f,g){this._contactServer("readIUPACName",{iupac:c},b,function(k){let m=[];for(let r=0,t=k.mols.length;r<t;r++)m.push(d.molFrom(k.mols[r]));f(m,k.warning)},g)};B.readSMILES=function(c,b,f,g){this._contactServer("readSMILES",{smiles:c},b,function(k){f(d.contentFrom(k.content))},g)};B.readWLN=function(c,b,
f,g){this._contactServer("readWLN",{wln:c},b,function(k){f(d.contentFrom(k.content))},g)};B.resolveCIP=function(c,b,f,g){this._contactServer("resolveCIP",{mol:d.molTo(c)},b,function(k){f(k.atoms,k.bonds)},g)};B.saveFile=function(c,b,f,g){this._contactServer("saveFile",{mol:d.molTo(c)},b,function(k){f(k.link)},g)};B.simulate13CNMR=function(c,b,f,g){b.nucleus="C";b.isotope=13;this._contactServer("simulateNMR",{mol:d.molTo(c)},b,function(k){f(q.readJCAMP(k.jcamp))},g)};B.simulate1HNMR=function(c,b,f,
g){b.nucleus="H";b.isotope=1;this._contactServer("simulateNMR",{mol:d.molTo(c)},b,function(k){f(q.readJCAMP(k.jcamp))},g)};B.simulateMassParentPeak=function(c,b,f,g){this._contactServer("simulateMassParentPeak",{mol:d.molTo(c)},b,function(k){f(q.readJCAMP(k.jcamp))},g)};B.stoichiometry=function(c,b,f,g){let k={};typeof c==="string"||c instanceof String?k.equation=c:c.molecules!==n?k.reaction=d.contentTo(c.molecules,c.shapes):c.table!==n&&(k.table=c.table);this._contactServer("stoichiometry",k,b,function(m){f(m.table,
m.message)},g)};B.writeSMILES=function(c,b,f,g,k){this._contactServer("writeSMILES",{content:d.contentTo(c,b)},f,function(m){g(m.smiles)},k)};B.version=function(c,b,f){this._contactServer("version",{},c,function(g){b(g.value)},f)};B.checkForUpdates=function(c){this._contactServer("checkForUpdates",{value:l.href},c,function(b){},function(){})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,location);